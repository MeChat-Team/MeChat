'use strict';function _0x54a6(){const _0x33000f=['all','function','18KCtuAJ','../models/models.service','__esModule','updatePlugin','isSystemPlugin','sortOrder','length','modelsService','110068AvByfd','getOwnPropertyDescriptor','HttpException','666580MOgHar','PluginEntity','defineProperty','修改插件信息成功','create','Repository','删除插件成功','name','isEnabled','9keFibm','ASC','@nestjs/typeorm','./plugin.entity','object','Injectable','description','design:paramtypes','182WifvKd','pluginImg','32412UiArwl','__decorate','插件不存在！','删除插件失败！','BAD_REQUEST','findOne','map','parameters','getCurrentModelKeyInfo','metadata','typeorm','45JMizvM','该插件名称已存在！','PluginService','HttpStatus','33dFqZOY','InjectRepository','25148BHUJLN','deductType','141870lQZWjt','该插件不存在！','6dJWhOI','save','delPlugin','assign','__metadata','Not','DESC','7048vCChKO','decorate','ModelsService','__param','5761652RCECAe','filter','createPlugin'];_0x54a6=function(){return _0x33000f;};return _0x54a6();}const _0x228941=_0xb8a5;(function(_0x40be98,_0x1880a1){const _0x47bb46=_0xb8a5,_0x5413a5=_0x40be98();while(!![]){try{const _0x5cdb5d=-parseInt(_0x47bb46(0x191))/0x1*(-parseInt(_0x47bb46(0x169))/0x2)+parseInt(_0x47bb46(0x16d))/0x3*(-parseInt(_0x47bb46(0x185))/0x4)+parseInt(_0x47bb46(0x163))/0x5*(-parseInt(_0x47bb46(0x16b))/0x6)+-parseInt(_0x47bb46(0x199))/0x7*(parseInt(_0x47bb46(0x174))/0x8)+-parseInt(_0x47bb46(0x17d))/0x9*(parseInt(_0x47bb46(0x188))/0xa)+-parseInt(_0x47bb46(0x167))/0xb*(parseInt(_0x47bb46(0x158))/0xc)+parseInt(_0x47bb46(0x178))/0xd;if(_0x5cdb5d===_0x1880a1)break;else _0x5413a5['push'](_0x5413a5['shift']());}catch(_0x5368c5){_0x5413a5['push'](_0x5413a5['shift']());}}}(_0x54a6,0x1e52e));function _0xb8a5(_0x2f442d,_0x10dc51){const _0x54a61f=_0x54a6();return _0xb8a5=function(_0xb8a53d,_0xec876a){_0xb8a53d=_0xb8a53d-0x157;let _0x44f187=_0x54a61f[_0xb8a53d];return _0x44f187;},_0xb8a5(_0x2f442d,_0x10dc51);}var __decorate=this&&this[_0x228941(0x159)]||function(_0x4b0e62,_0x3180c3,_0xda88ab,_0x3a56df){const _0x2e7476=_0x228941;var _0x5727c2=arguments[_0x2e7476(0x183)],_0x18f3c3=_0x5727c2<0x3?_0x3180c3:_0x3a56df===null?_0x3a56df=Object[_0x2e7476(0x186)](_0x3180c3,_0xda88ab):_0x3a56df,_0x22bd6e;if(typeof Reflect===_0x2e7476(0x195)&&typeof Reflect[_0x2e7476(0x175)]===_0x2e7476(0x17c))_0x18f3c3=Reflect['decorate'](_0x4b0e62,_0x3180c3,_0xda88ab,_0x3a56df);else{for(var _0x1ff399=_0x4b0e62[_0x2e7476(0x183)]-0x1;_0x1ff399>=0x0;_0x1ff399--)if(_0x22bd6e=_0x4b0e62[_0x1ff399])_0x18f3c3=(_0x5727c2<0x3?_0x22bd6e(_0x18f3c3):_0x5727c2>0x3?_0x22bd6e(_0x3180c3,_0xda88ab,_0x18f3c3):_0x22bd6e(_0x3180c3,_0xda88ab))||_0x18f3c3;}return _0x5727c2>0x3&&_0x18f3c3&&Object['defineProperty'](_0x3180c3,_0xda88ab,_0x18f3c3),_0x18f3c3;},__metadata=this&&this[_0x228941(0x171)]||function(_0x433203,_0x319fee){const _0x55553b=_0x228941;if(typeof Reflect===_0x55553b(0x195)&&typeof Reflect[_0x55553b(0x161)]==='function')return Reflect[_0x55553b(0x161)](_0x433203,_0x319fee);},__param=this&&this[_0x228941(0x177)]||function(_0x5e37a2,_0x3ce992){return function(_0x3e654c,_0x2ed154){_0x3ce992(_0x3e654c,_0x2ed154,_0x5e37a2);};};Object[_0x228941(0x18a)](exports,_0x228941(0x17f),{'value':!![]}),exports[_0x228941(0x165)]=void 0x0;const common_1=require('@nestjs/common'),typeorm_1=require(_0x228941(0x193)),typeorm_2=require(_0x228941(0x162)),models_service_1=require(_0x228941(0x17e)),plugin_entity_1=require(_0x228941(0x194));let PluginService=class PluginService{constructor(_0x3c2751,_0x36be0d){const _0x4197d4=_0x228941;this['PluginEntity']=_0x3c2751,this[_0x4197d4(0x184)]=_0x36be0d;}async['pluginList'](_0x234f8b){const _0x480f44=_0x228941,{page:page=0x1,size:size=0x64}=_0x234f8b,_0x37a86d=await this[_0x480f44(0x189)]['find']({'order':{'sortOrder':_0x480f44(0x192),'id':_0x480f44(0x173)},'skip':(page-0x1)*size,'take':size}),_0x10d555=await Promise[_0x480f44(0x17b)](_0x37a86d[_0x480f44(0x15e)](async _0x531a76=>{const _0x1e94e7=_0x480f44;if(_0x531a76[_0x1e94e7(0x181)]===0x1)try{const _0x2cbca1=await this['modelsService'][_0x1e94e7(0x160)](_0x531a76[_0x1e94e7(0x15f)]),_0x27ca7b=_0x2cbca1[_0x1e94e7(0x16a)];return Object[_0x1e94e7(0x170)](Object[_0x1e94e7(0x170)]({},_0x531a76),{'deductType':_0x27ca7b});}catch(_0x379fe9){return Object['assign'](Object[_0x1e94e7(0x170)]({},_0x531a76),{'deductType':0x0});}else return Object['assign'](Object[_0x1e94e7(0x170)]({},_0x531a76),{'deductType':0x0});})),_0x1aacb2=_0x10d555[_0x480f44(0x179)](_0x1d05aa=>_0x1d05aa!==null);return{'rows':_0x1aacb2,'count':_0x1aacb2[_0x480f44(0x183)]};}async[_0x228941(0x17a)](_0x52581c){const _0x46af46=_0x228941,{name:_0x46fe3c,pluginImg:_0x1ef187,description:_0x519308,isEnabled:_0x5b38a6,isSystemPlugin:_0x4541e9,parameters:_0x443314,sortOrder:_0x2e9f29}=_0x52581c,_0x565b32=await this[_0x46af46(0x189)]['findOne']({'where':{'name':_0x46fe3c}});if(_0x565b32)throw new common_1[(_0x46af46(0x187))](_0x46af46(0x164),common_1[_0x46af46(0x166)]['BAD_REQUEST']);const _0x310f7f=this[_0x46af46(0x189)][_0x46af46(0x18c)]({'name':_0x46fe3c,'pluginImg':_0x1ef187,'description':_0x519308,'isEnabled':_0x5b38a6!==undefined?_0x5b38a6:0x1,'isSystemPlugin':_0x4541e9!==undefined?_0x4541e9:0x0,'parameters':_0x443314,'sortOrder':_0x2e9f29!==undefined?_0x2e9f29:0x0});return await this[_0x46af46(0x189)][_0x46af46(0x16e)](_0x310f7f);}async[_0x228941(0x180)](_0x1bb04d){const _0x4a429b=_0x228941,{id:_0x2412c9,name:_0x2be349,pluginImg:_0x18a0c2,description:_0x18a2ba,isEnabled:_0x31c0d3,isSystemPlugin:_0x5a5756,parameters:_0x56c178,sortOrder:_0x57b253}=_0x1bb04d,_0x319486=await this[_0x4a429b(0x189)][_0x4a429b(0x15d)]({'where':{'id':_0x2412c9}});if(!_0x319486)throw new common_1[(_0x4a429b(0x187))](_0x4a429b(0x15a),common_1[_0x4a429b(0x166)]['BAD_REQUEST']);const _0x369fd4=await this[_0x4a429b(0x189)][_0x4a429b(0x15d)]({'where':{'name':_0x2be349,'id':(0x0,typeorm_2[_0x4a429b(0x172)])(_0x2412c9)}});if(_0x369fd4)throw new common_1[(_0x4a429b(0x187))]('该插件名称已存在！',common_1[_0x4a429b(0x166)][_0x4a429b(0x15c)]);return _0x319486[_0x4a429b(0x18f)]=_0x2be349,_0x319486[_0x4a429b(0x157)]=_0x18a0c2,_0x319486[_0x4a429b(0x197)]=_0x18a2ba,_0x319486[_0x4a429b(0x190)]=_0x31c0d3!==undefined?_0x31c0d3:_0x319486[_0x4a429b(0x190)],_0x319486[_0x4a429b(0x181)]=_0x5a5756!==undefined?_0x5a5756:_0x319486['isSystemPlugin'],_0x319486[_0x4a429b(0x15f)]=_0x56c178,_0x319486[_0x4a429b(0x182)]=_0x57b253!==undefined?_0x57b253:_0x319486[_0x4a429b(0x182)],await this[_0x4a429b(0x189)][_0x4a429b(0x16e)](_0x319486),_0x4a429b(0x18b);}async[_0x228941(0x16f)](_0x21b60b){const _0x352f0d=_0x228941,{id:_0x4194c1}=_0x21b60b,_0xcc8150=await this[_0x352f0d(0x189)]['findOne']({'where':{'id':_0x4194c1}});if(!_0xcc8150)throw new common_1[(_0x352f0d(0x187))](_0x352f0d(0x16c),common_1[_0x352f0d(0x166)][_0x352f0d(0x15c)]);const _0x6aae0e=await this['PluginEntity']['delete'](_0x4194c1);if(_0x6aae0e['affected']>0x0)return _0x352f0d(0x18e);else throw new common_1[(_0x352f0d(0x187))](_0x352f0d(0x15b),common_1[_0x352f0d(0x166)]['BAD_REQUEST']);}};PluginService=__decorate([(0x0,common_1[_0x228941(0x196)])(),__param(0x0,(0x0,typeorm_1[_0x228941(0x168)])(plugin_entity_1[_0x228941(0x189)])),__metadata(_0x228941(0x198),[typeorm_2[_0x228941(0x18d)],models_service_1[_0x228941(0x176)]])],PluginService),exports[_0x228941(0x165)]=PluginService;