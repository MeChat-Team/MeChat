'use strict';function _0x58ee(){const _0x31a36b=['198444XwkFPK','create','./plugin.entity','deductType','sortOrder','getOwnPropertyDescriptor','32twhXfB','@nestjs/typeorm','195eppLKP','485118EyTqnX','findOne','typeorm','isEnabled','PluginEntity','delPlugin','__esModule','__param','defineProperty','23781ByrARd','modelsService','6lBJNjW','updatePlugin','length','object','pluginList','parameters','删除插件失败！','HttpStatus','isSystemPlugin','design:paramtypes','HttpException','1LHpQZW','PluginService','description','function','1683374SwUCAB','1159403WwGESa','map','decorate','BAD_REQUEST','name','metadata','__decorate','该插件名称已存在！','assign','380362CsYMtb','@nestjs/common','64ETMGlt','affected','Repository','Not','修改插件信息成功','20rjjwpQ','157105GvTbpL','ASC','getCurrentModelKeyInfo','createPlugin','save'];_0x58ee=function(){return _0x31a36b;};return _0x58ee();}const _0x385dcd=_0x3d3e;function _0x3d3e(_0x5bdbbf,_0x3f75c3){const _0x58eed3=_0x58ee();return _0x3d3e=function(_0x3d3e22,_0x341275){_0x3d3e22=_0x3d3e22-0xf5;let _0xfafaa4=_0x58eed3[_0x3d3e22];return _0xfafaa4;},_0x3d3e(_0x5bdbbf,_0x3f75c3);}(function(_0x361581,_0x32bc92){const _0x335c22=_0x3d3e,_0x4120f2=_0x361581();while(!![]){try{const _0x5e3a74=parseInt(_0x335c22(0x11a))/0x1*(parseInt(_0x335c22(0x128))/0x2)+parseInt(_0x335c22(0x10d))/0x3*(parseInt(_0x335c22(0x12a))/0x4)+parseInt(_0x335c22(0xf6))/0x5+-parseInt(_0x335c22(0x10f))/0x6*(-parseInt(_0x335c22(0x11f))/0x7)+parseInt(_0x335c22(0x101))/0x8*(-parseInt(_0x335c22(0x104))/0x9)+parseInt(_0x335c22(0xf5))/0xa*(-parseInt(_0x335c22(0x11e))/0xb)+parseInt(_0x335c22(0xfb))/0xc*(parseInt(_0x335c22(0x103))/0xd);if(_0x5e3a74===_0x32bc92)break;else _0x4120f2['push'](_0x4120f2['shift']());}catch(_0x26db6d){_0x4120f2['push'](_0x4120f2['shift']());}}}(_0x58ee,0x3ab3a));var __decorate=this&&this[_0x385dcd(0x125)]||function(_0x4f89e2,_0xba9f6a,_0x1a99e3,_0x3511ae){const _0x8cf8a3=_0x385dcd;var _0xf2cc8f=arguments['length'],_0x45e45d=_0xf2cc8f<0x3?_0xba9f6a:_0x3511ae===null?_0x3511ae=Object[_0x8cf8a3(0x100)](_0xba9f6a,_0x1a99e3):_0x3511ae,_0x145a50;if(typeof Reflect===_0x8cf8a3(0x112)&&typeof Reflect[_0x8cf8a3(0x121)]===_0x8cf8a3(0x11d))_0x45e45d=Reflect[_0x8cf8a3(0x121)](_0x4f89e2,_0xba9f6a,_0x1a99e3,_0x3511ae);else{for(var _0x4adc46=_0x4f89e2[_0x8cf8a3(0x111)]-0x1;_0x4adc46>=0x0;_0x4adc46--)if(_0x145a50=_0x4f89e2[_0x4adc46])_0x45e45d=(_0xf2cc8f<0x3?_0x145a50(_0x45e45d):_0xf2cc8f>0x3?_0x145a50(_0xba9f6a,_0x1a99e3,_0x45e45d):_0x145a50(_0xba9f6a,_0x1a99e3))||_0x45e45d;}return _0xf2cc8f>0x3&&_0x45e45d&&Object[_0x8cf8a3(0x10c)](_0xba9f6a,_0x1a99e3,_0x45e45d),_0x45e45d;},__metadata=this&&this['__metadata']||function(_0x32be32,_0x58e7d3){const _0x5cd4f9=_0x385dcd;if(typeof Reflect===_0x5cd4f9(0x112)&&typeof Reflect[_0x5cd4f9(0x124)]===_0x5cd4f9(0x11d))return Reflect[_0x5cd4f9(0x124)](_0x32be32,_0x58e7d3);},__param=this&&this[_0x385dcd(0x10b)]||function(_0x5c8fd1,_0x5bda05){return function(_0x42b113,_0x42a799){_0x5bda05(_0x42b113,_0x42a799,_0x5c8fd1);};};Object[_0x385dcd(0x10c)](exports,_0x385dcd(0x10a),{'value':!![]}),exports[_0x385dcd(0x11b)]=void 0x0;const common_1=require(_0x385dcd(0x129)),typeorm_1=require(_0x385dcd(0x102)),typeorm_2=require(_0x385dcd(0x106)),models_service_1=require('../models/models.service'),plugin_entity_1=require(_0x385dcd(0xfd));let PluginService=class PluginService{constructor(_0x1c0a16,_0x3fd61e){const _0x59ba45=_0x385dcd;this[_0x59ba45(0x108)]=_0x1c0a16,this[_0x59ba45(0x10e)]=_0x3fd61e;}async[_0x385dcd(0x113)](_0x92cfe4){const _0x21425f=_0x385dcd,{page:page=0x1,size:size=0x64}=_0x92cfe4,_0x4358c6=await this[_0x21425f(0x108)]['find']({'order':{'sortOrder':_0x21425f(0xf7),'id':'DESC'},'skip':(page-0x1)*size,'take':size}),_0xc4db93=await Promise['all'](_0x4358c6[_0x21425f(0x120)](async _0x3e5bb1=>{const _0x28a561=_0x21425f;if(_0x3e5bb1[_0x28a561(0x117)]===0x1)try{const _0x2a5ab9=await this[_0x28a561(0x10e)][_0x28a561(0xf8)](_0x3e5bb1['parameters']),_0x5f39bc=_0x2a5ab9[_0x28a561(0xfe)];return Object[_0x28a561(0x127)](Object[_0x28a561(0x127)]({},_0x3e5bb1),{'deductType':_0x5f39bc});}catch(_0x4ca31d){return Object['assign'](Object[_0x28a561(0x127)]({},_0x3e5bb1),{'deductType':0x0});}else return Object['assign'](Object[_0x28a561(0x127)]({},_0x3e5bb1),{'deductType':0x0});})),_0x11656c=_0xc4db93['filter'](_0x55b91e=>_0x55b91e!==null);return{'rows':_0x11656c,'count':_0x11656c[_0x21425f(0x111)]};}async[_0x385dcd(0xf9)](_0x129d52){const _0x32ae4b=_0x385dcd,{name:_0x2d24f8,pluginImg:_0x53bef1,description:_0x4b3f91,isEnabled:_0x2dee35,isSystemPlugin:_0x43d1ef,parameters:_0x79d7f7,sortOrder:_0x2dc6f7}=_0x129d52,_0x56c21b=await this[_0x32ae4b(0x108)]['findOne']({'where':{'name':_0x2d24f8}});if(_0x56c21b)throw new common_1[(_0x32ae4b(0x119))](_0x32ae4b(0x126),common_1['HttpStatus'][_0x32ae4b(0x122)]);const _0x12a2f2=this[_0x32ae4b(0x108)][_0x32ae4b(0xfc)]({'name':_0x2d24f8,'pluginImg':_0x53bef1,'description':_0x4b3f91,'isEnabled':_0x2dee35!==undefined?_0x2dee35:0x1,'isSystemPlugin':_0x43d1ef!==undefined?_0x43d1ef:0x0,'parameters':_0x79d7f7,'sortOrder':_0x2dc6f7!==undefined?_0x2dc6f7:0x0});return await this[_0x32ae4b(0x108)][_0x32ae4b(0xfa)](_0x12a2f2);}async[_0x385dcd(0x110)](_0x5f2622){const _0x4a7523=_0x385dcd,{id:_0xefe695,name:_0x270ee9,pluginImg:_0x53dc4f,description:_0xd4b2bd,isEnabled:_0x4ebf26,isSystemPlugin:_0x111ebf,parameters:_0x1d7f8e,sortOrder:_0x45a4f1}=_0x5f2622,_0x2ae2f5=await this[_0x4a7523(0x108)]['findOne']({'where':{'id':_0xefe695}});if(!_0x2ae2f5)throw new common_1['HttpException']('插件不存在！',common_1[_0x4a7523(0x116)][_0x4a7523(0x122)]);const _0x31d1b6=await this[_0x4a7523(0x108)][_0x4a7523(0x105)]({'where':{'name':_0x270ee9,'id':(0x0,typeorm_2[_0x4a7523(0x12d)])(_0xefe695)}});if(_0x31d1b6)throw new common_1[(_0x4a7523(0x119))]('该插件名称已存在！',common_1[_0x4a7523(0x116)][_0x4a7523(0x122)]);return _0x2ae2f5[_0x4a7523(0x123)]=_0x270ee9,_0x2ae2f5['pluginImg']=_0x53dc4f,_0x2ae2f5[_0x4a7523(0x11c)]=_0xd4b2bd,_0x2ae2f5['isEnabled']=_0x4ebf26!==undefined?_0x4ebf26:_0x2ae2f5[_0x4a7523(0x107)],_0x2ae2f5['isSystemPlugin']=_0x111ebf!==undefined?_0x111ebf:_0x2ae2f5['isSystemPlugin'],_0x2ae2f5[_0x4a7523(0x114)]=_0x1d7f8e,_0x2ae2f5[_0x4a7523(0xff)]=_0x45a4f1!==undefined?_0x45a4f1:_0x2ae2f5[_0x4a7523(0xff)],await this[_0x4a7523(0x108)][_0x4a7523(0xfa)](_0x2ae2f5),_0x4a7523(0x12e);}async[_0x385dcd(0x109)](_0x263e01){const _0x24366d=_0x385dcd,{id:_0x15792c}=_0x263e01,_0xe8686c=await this[_0x24366d(0x108)][_0x24366d(0x105)]({'where':{'id':_0x15792c}});if(!_0xe8686c)throw new common_1[(_0x24366d(0x119))]('该插件不存在！',common_1[_0x24366d(0x116)][_0x24366d(0x122)]);const _0x2b53f4=await this['PluginEntity']['delete'](_0x15792c);if(_0x2b53f4[_0x24366d(0x12b)]>0x0)return'删除插件成功';else throw new common_1[(_0x24366d(0x119))](_0x24366d(0x115),common_1[_0x24366d(0x116)][_0x24366d(0x122)]);}};PluginService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_1['InjectRepository'])(plugin_entity_1['PluginEntity'])),__metadata(_0x385dcd(0x118),[typeorm_2[_0x385dcd(0x12c)],models_service_1['ModelsService']])],PluginService),exports[_0x385dcd(0x11b)]=PluginService;