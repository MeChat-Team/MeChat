'use strict';const _0x2dc91d=_0x50af;(function(_0x4d42bc,_0x1e8399){const _0x18945b=_0x50af,_0x41da8a=_0x4d42bc();while(!![]){try{const _0x4a2d3d=parseInt(_0x18945b(0x121))/0x1*(parseInt(_0x18945b(0x125))/0x2)+-parseInt(_0x18945b(0x133))/0x3*(parseInt(_0x18945b(0x116))/0x4)+parseInt(_0x18945b(0x10f))/0x5+-parseInt(_0x18945b(0x135))/0x6*(parseInt(_0x18945b(0x11d))/0x7)+-parseInt(_0x18945b(0x11e))/0x8+-parseInt(_0x18945b(0x11a))/0x9+-parseInt(_0x18945b(0x132))/0xa*(-parseInt(_0x18945b(0x109))/0xb);if(_0x4a2d3d===_0x1e8399)break;else _0x41da8a['push'](_0x41da8a['shift']());}catch(_0x19444b){_0x41da8a['push'](_0x41da8a['shift']());}}}(_0x1ff1,0xe5879));var __decorate=this&&this[_0x2dc91d(0x127)]||function(_0x193f0e,_0x34d6f3,_0x4fa184,_0x5ac28d){const _0x293680=_0x2dc91d;var _0x5a1cff=arguments[_0x293680(0x110)],_0x2c2a59=_0x5a1cff<0x3?_0x34d6f3:_0x5ac28d===null?_0x5ac28d=Object[_0x293680(0x11c)](_0x34d6f3,_0x4fa184):_0x5ac28d,_0x2e0a2f;if(typeof Reflect===_0x293680(0x118)&&typeof Reflect[_0x293680(0x13d)]===_0x293680(0x106))_0x2c2a59=Reflect[_0x293680(0x13d)](_0x193f0e,_0x34d6f3,_0x4fa184,_0x5ac28d);else{for(var _0x8a42de=_0x193f0e[_0x293680(0x110)]-0x1;_0x8a42de>=0x0;_0x8a42de--)if(_0x2e0a2f=_0x193f0e[_0x8a42de])_0x2c2a59=(_0x5a1cff<0x3?_0x2e0a2f(_0x2c2a59):_0x5a1cff>0x3?_0x2e0a2f(_0x34d6f3,_0x4fa184,_0x2c2a59):_0x2e0a2f(_0x34d6f3,_0x4fa184))||_0x2c2a59;}return _0x5a1cff>0x3&&_0x2c2a59&&Object['defineProperty'](_0x34d6f3,_0x4fa184,_0x2c2a59),_0x2c2a59;},__metadata=this&&this[_0x2dc91d(0x12f)]||function(_0x1d91e4,_0x5a662a){const _0x56787e=_0x2dc91d;if(typeof Reflect===_0x56787e(0x118)&&typeof Reflect['metadata']===_0x56787e(0x106))return Reflect['metadata'](_0x1d91e4,_0x5a662a);},__param=this&&this['__param']||function(_0x5993ef,_0x21ea9e){return function(_0x33159e,_0x564050){_0x21ea9e(_0x33159e,_0x564050,_0x5993ef);};};function _0x50af(_0x313a38,_0x1f99fb){const _0x1ff1cc=_0x1ff1();return _0x50af=function(_0x50aff3,_0x47cbf7){_0x50aff3=_0x50aff3-0x104;let _0x2eb6d4=_0x1ff1cc[_0x50aff3];return _0x2eb6d4;},_0x50af(_0x313a38,_0x1f99fb);}function _0x1ff1(){const _0x1f4546=['HttpStatus','createPlugin','303855JEoIXn','length','getCurrentModelKeyInfo','InjectRepository','isEnabled','DESC','design:paramtypes','2908XaEGAy','pluginImg','object','Injectable','3099717vIKltp','description','getOwnPropertyDescriptor','1444366uxUaop','1069624DrEyUw','@nestjs/common','assign','2exdWSJ','affected','Not','deductType','1192172AHcyiH','BAD_REQUEST','__decorate','modelsService','该插件不存在！','HttpException','__esModule','findOne','find','parameters','__metadata','修改插件信息成功','该插件名称已存在！','2222930MnPAjk','4431GbTMMv','ModelsService','48lXRztd','name','map','./plugin.entity','PluginService','isSystemPlugin','Repository','@nestjs/typeorm','decorate','sortOrder','delPlugin','function','pluginList','filter','143QkLuwp','updatePlugin','save','PluginEntity'];_0x1ff1=function(){return _0x1f4546;};return _0x1ff1();}Object['defineProperty'](exports,_0x2dc91d(0x12b),{'value':!![]}),exports[_0x2dc91d(0x139)]=void 0x0;const common_1=require(_0x2dc91d(0x11f)),typeorm_1=require(_0x2dc91d(0x13c)),typeorm_2=require('typeorm'),models_service_1=require('../models/models.service'),plugin_entity_1=require(_0x2dc91d(0x138));let PluginService=class PluginService{constructor(_0x114e24,_0x476f4d){const _0x2ca6a5=_0x2dc91d;this[_0x2ca6a5(0x10c)]=_0x114e24,this[_0x2ca6a5(0x128)]=_0x476f4d;}async[_0x2dc91d(0x107)](_0x4b25b4){const _0x47dc1d=_0x2dc91d,{page:page=0x1,size:size=0x64}=_0x4b25b4,_0x3cd6f5=await this[_0x47dc1d(0x10c)][_0x47dc1d(0x12d)]({'order':{'sortOrder':'ASC','id':_0x47dc1d(0x114)},'skip':(page-0x1)*size,'take':size}),_0x2ea6be=await Promise['all'](_0x3cd6f5[_0x47dc1d(0x137)](async _0x5436c0=>{const _0x3cdb01=_0x47dc1d;if(_0x5436c0[_0x3cdb01(0x13a)]===0x1)try{const _0x7d75a8=await this[_0x3cdb01(0x128)][_0x3cdb01(0x111)](_0x5436c0[_0x3cdb01(0x12e)]),_0x124da1=_0x7d75a8[_0x3cdb01(0x124)];return Object[_0x3cdb01(0x120)](Object[_0x3cdb01(0x120)]({},_0x5436c0),{'deductType':_0x124da1});}catch(_0x4eb9b6){return Object[_0x3cdb01(0x120)](Object[_0x3cdb01(0x120)]({},_0x5436c0),{'deductType':0x0});}else return Object[_0x3cdb01(0x120)](Object[_0x3cdb01(0x120)]({},_0x5436c0),{'deductType':0x0});})),_0x408864=_0x2ea6be[_0x47dc1d(0x108)](_0x5c5237=>_0x5c5237!==null);return{'rows':_0x408864,'count':_0x408864[_0x47dc1d(0x110)]};}async[_0x2dc91d(0x10e)](_0x579142){const _0x2e42ca=_0x2dc91d,{name:_0xef52af,pluginImg:_0x1af0d9,description:_0x5652ef,isEnabled:_0x444cb8,isSystemPlugin:_0x469276,parameters:_0x1d67e0,sortOrder:_0x4c9aa4}=_0x579142,_0xc72fdf=await this[_0x2e42ca(0x10c)][_0x2e42ca(0x12c)]({'where':{'name':_0xef52af}});if(_0xc72fdf)throw new common_1[(_0x2e42ca(0x12a))](_0x2e42ca(0x131),common_1[_0x2e42ca(0x10d)][_0x2e42ca(0x126)]);const _0x29f2a7=this['PluginEntity']['create']({'name':_0xef52af,'pluginImg':_0x1af0d9,'description':_0x5652ef,'isEnabled':_0x444cb8!==undefined?_0x444cb8:0x1,'isSystemPlugin':_0x469276!==undefined?_0x469276:0x0,'parameters':_0x1d67e0,'sortOrder':_0x4c9aa4!==undefined?_0x4c9aa4:0x0});return await this['PluginEntity'][_0x2e42ca(0x10b)](_0x29f2a7);}async[_0x2dc91d(0x10a)](_0x3966e8){const _0x544b49=_0x2dc91d,{id:_0x18d67,name:_0x2d5362,pluginImg:_0xdff389,description:_0x2acb55,isEnabled:_0x256a20,isSystemPlugin:_0x295c9b,parameters:_0x1562fb,sortOrder:_0x4c1019}=_0x3966e8,_0x39ef67=await this[_0x544b49(0x10c)]['findOne']({'where':{'id':_0x18d67}});if(!_0x39ef67)throw new common_1[(_0x544b49(0x12a))]('插件不存在！',common_1[_0x544b49(0x10d)][_0x544b49(0x126)]);const _0x2513ec=await this['PluginEntity'][_0x544b49(0x12c)]({'where':{'name':_0x2d5362,'id':(0x0,typeorm_2[_0x544b49(0x123)])(_0x18d67)}});if(_0x2513ec)throw new common_1[(_0x544b49(0x12a))](_0x544b49(0x131),common_1['HttpStatus']['BAD_REQUEST']);return _0x39ef67[_0x544b49(0x136)]=_0x2d5362,_0x39ef67[_0x544b49(0x117)]=_0xdff389,_0x39ef67[_0x544b49(0x11b)]=_0x2acb55,_0x39ef67[_0x544b49(0x113)]=_0x256a20!==undefined?_0x256a20:_0x39ef67[_0x544b49(0x113)],_0x39ef67[_0x544b49(0x13a)]=_0x295c9b!==undefined?_0x295c9b:_0x39ef67[_0x544b49(0x13a)],_0x39ef67['parameters']=_0x1562fb,_0x39ef67[_0x544b49(0x104)]=_0x4c1019!==undefined?_0x4c1019:_0x39ef67[_0x544b49(0x104)],await this['PluginEntity'][_0x544b49(0x10b)](_0x39ef67),_0x544b49(0x130);}async[_0x2dc91d(0x105)](_0x2bf89e){const _0x37c70f=_0x2dc91d,{id:_0x2b7b65}=_0x2bf89e,_0xfd95aa=await this[_0x37c70f(0x10c)]['findOne']({'where':{'id':_0x2b7b65}});if(!_0xfd95aa)throw new common_1[(_0x37c70f(0x12a))](_0x37c70f(0x129),common_1[_0x37c70f(0x10d)][_0x37c70f(0x126)]);const _0x1ae0c9=await this['PluginEntity']['delete'](_0x2b7b65);if(_0x1ae0c9[_0x37c70f(0x122)]>0x0)return'删除插件成功';else throw new common_1['HttpException']('删除插件失败！',common_1[_0x37c70f(0x10d)][_0x37c70f(0x126)]);}};PluginService=__decorate([(0x0,common_1[_0x2dc91d(0x119)])(),__param(0x0,(0x0,typeorm_1[_0x2dc91d(0x112)])(plugin_entity_1[_0x2dc91d(0x10c)])),__metadata(_0x2dc91d(0x115),[typeorm_2[_0x2dc91d(0x13b)],models_service_1[_0x2dc91d(0x134)]])],PluginService),exports[_0x2dc91d(0x139)]=PluginService;