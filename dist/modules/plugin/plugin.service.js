'use strict';const _0x10f296=_0x2b11;function _0x1257(){const _0x7af2bd=['getCurrentModelKeyInfo','modelsService','InjectRepository','536529zTeiyT','ModelsService','436SXGbJz','708cAHCSC','DESC','831pXHmqq','affected','1460950PYmluo','object','__esModule','assign','__param','filter','../models/models.service','getOwnPropertyDescriptor','Repository','Not','该插件名称已存在！','delPlugin','@nestjs/typeorm','HttpException','function','createPlugin','parameters','412326sSgBxQ','decorate','defineProperty','name','ASC','delete','BAD_REQUEST','updatePlugin','pluginImg','5GDyKFx','插件不存在！','56wEMAgR','./plugin.entity','deductType','__decorate','isSystemPlugin','5544UDRRWs','length','HttpStatus','删除插件成功','144JXwMSi','PluginEntity','删除插件失败！','712YzXRVp','1873194kcjicm','sortOrder','design:paramtypes','save','isEnabled','__metadata','findOne'];_0x1257=function(){return _0x7af2bd;};return _0x1257();}(function(_0x505a8b,_0x2cbbca){const _0x370970=_0x2b11,_0x14ca18=_0x505a8b();while(!![]){try{const _0x4bfbc3=parseInt(_0x370970(0x128))/0x1*(parseInt(_0x370970(0x135))/0x2)+-parseInt(_0x370970(0x138))/0x3*(parseInt(_0x370970(0x125))/0x4)+-parseInt(_0x370970(0x11a))/0x5*(-parseInt(_0x370970(0x129))/0x6)+-parseInt(_0x370970(0x133))/0x7+-parseInt(_0x370970(0x11c))/0x8*(parseInt(_0x370970(0x111))/0x9)+parseInt(_0x370970(0x13a))/0xa+parseInt(_0x370970(0x121))/0xb*(-parseInt(_0x370970(0x136))/0xc);if(_0x4bfbc3===_0x2cbbca)break;else _0x14ca18['push'](_0x14ca18['shift']());}catch(_0x33ccd6){_0x14ca18['push'](_0x14ca18['shift']());}}}(_0x1257,0x2b149));var __decorate=this&&this[_0x10f296(0x11f)]||function(_0x34acb6,_0x2ac3f8,_0x3f7777,_0x5e3f3b){const _0x5ccd70=_0x10f296;var _0x3b2bc=arguments[_0x5ccd70(0x122)],_0x356fe8=_0x3b2bc<0x3?_0x2ac3f8:_0x5e3f3b===null?_0x5e3f3b=Object[_0x5ccd70(0x141)](_0x2ac3f8,_0x3f7777):_0x5e3f3b,_0x75d15c;if(typeof Reflect===_0x5ccd70(0x13b)&&typeof Reflect[_0x5ccd70(0x112)]===_0x5ccd70(0x148))_0x356fe8=Reflect[_0x5ccd70(0x112)](_0x34acb6,_0x2ac3f8,_0x3f7777,_0x5e3f3b);else{for(var _0xfd1094=_0x34acb6['length']-0x1;_0xfd1094>=0x0;_0xfd1094--)if(_0x75d15c=_0x34acb6[_0xfd1094])_0x356fe8=(_0x3b2bc<0x3?_0x75d15c(_0x356fe8):_0x3b2bc>0x3?_0x75d15c(_0x2ac3f8,_0x3f7777,_0x356fe8):_0x75d15c(_0x2ac3f8,_0x3f7777))||_0x356fe8;}return _0x3b2bc>0x3&&_0x356fe8&&Object[_0x5ccd70(0x113)](_0x2ac3f8,_0x3f7777,_0x356fe8),_0x356fe8;},__metadata=this&&this[_0x10f296(0x12e)]||function(_0x23d793,_0x49b693){const _0x58cc27=_0x10f296;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x58cc27(0x148))return Reflect['metadata'](_0x23d793,_0x49b693);},__param=this&&this[_0x10f296(0x13e)]||function(_0x639eb9,_0x280cf1){return function(_0x489854,_0x59e694){_0x280cf1(_0x489854,_0x59e694,_0x639eb9);};};function _0x2b11(_0x46011b,_0x88d2b2){const _0x1257e2=_0x1257();return _0x2b11=function(_0x2b11ae,_0x5c22ad){_0x2b11ae=_0x2b11ae-0x111;let _0x157f43=_0x1257e2[_0x2b11ae];return _0x157f43;},_0x2b11(_0x46011b,_0x88d2b2);}Object[_0x10f296(0x113)](exports,_0x10f296(0x13c),{'value':!![]}),exports['PluginService']=void 0x0;const common_1=require('@nestjs/common'),typeorm_1=require(_0x10f296(0x146)),typeorm_2=require('typeorm'),models_service_1=require(_0x10f296(0x140)),plugin_entity_1=require(_0x10f296(0x11d));let PluginService=class PluginService{constructor(_0x5f84de,_0x2186be){const _0x155c2b=_0x10f296;this[_0x155c2b(0x126)]=_0x5f84de,this[_0x155c2b(0x131)]=_0x2186be;}async['pluginList'](_0x14adca){const _0x285581=_0x10f296,{page:page=0x1,size:size=0x64}=_0x14adca,_0x376287=await this[_0x285581(0x126)]['find']({'order':{'sortOrder':_0x285581(0x115),'id':_0x285581(0x137)},'skip':(page-0x1)*size,'take':size}),_0x39917c=await Promise['all'](_0x376287['map'](async _0x182a4b=>{const _0x30852c=_0x285581;if(_0x182a4b['isSystemPlugin']===0x1)try{const _0xe3dabd=await this[_0x30852c(0x131)][_0x30852c(0x130)](_0x182a4b[_0x30852c(0x14a)]),_0x1fe45a=_0xe3dabd[_0x30852c(0x11e)];return Object['assign'](Object[_0x30852c(0x13d)]({},_0x182a4b),{'deductType':_0x1fe45a});}catch(_0x4826f3){return Object['assign'](Object[_0x30852c(0x13d)]({},_0x182a4b),{'deductType':0x0});}else return Object['assign'](Object[_0x30852c(0x13d)]({},_0x182a4b),{'deductType':0x0});})),_0x144fa1=_0x39917c[_0x285581(0x13f)](_0x1073f1=>_0x1073f1!==null);return{'rows':_0x144fa1,'count':_0x144fa1[_0x285581(0x122)]};}async[_0x10f296(0x149)](_0x293218){const _0x4abfb3=_0x10f296,{name:_0x1bc4ab,pluginImg:_0xef296e,description:_0x116c4d,isEnabled:_0x15c696,isSystemPlugin:_0xd15943,parameters:_0x448692,sortOrder:_0xc692ea}=_0x293218,_0x5727bf=await this['PluginEntity'][_0x4abfb3(0x12f)]({'where':{'name':_0x1bc4ab}});if(_0x5727bf)throw new common_1['HttpException'](_0x4abfb3(0x144),common_1[_0x4abfb3(0x123)][_0x4abfb3(0x117)]);const _0x29c727=this[_0x4abfb3(0x126)]['create']({'name':_0x1bc4ab,'pluginImg':_0xef296e,'description':_0x116c4d,'isEnabled':_0x15c696!==undefined?_0x15c696:0x1,'isSystemPlugin':_0xd15943!==undefined?_0xd15943:0x0,'parameters':_0x448692,'sortOrder':_0xc692ea!==undefined?_0xc692ea:0x0});return await this[_0x4abfb3(0x126)]['save'](_0x29c727);}async[_0x10f296(0x118)](_0x427ac8){const _0xa39d0=_0x10f296,{id:_0x2bea0b,name:_0x42cbf8,pluginImg:_0x596786,description:_0x2673a3,isEnabled:_0x4a2a46,isSystemPlugin:_0x26a4d4,parameters:_0x51fd0f,sortOrder:_0x56c5e4}=_0x427ac8,_0x4f8a7c=await this[_0xa39d0(0x126)][_0xa39d0(0x12f)]({'where':{'id':_0x2bea0b}});if(!_0x4f8a7c)throw new common_1[(_0xa39d0(0x147))](_0xa39d0(0x11b),common_1[_0xa39d0(0x123)]['BAD_REQUEST']);const _0x336144=await this[_0xa39d0(0x126)][_0xa39d0(0x12f)]({'where':{'name':_0x42cbf8,'id':(0x0,typeorm_2[_0xa39d0(0x143)])(_0x2bea0b)}});if(_0x336144)throw new common_1[(_0xa39d0(0x147))](_0xa39d0(0x144),common_1[_0xa39d0(0x123)][_0xa39d0(0x117)]);return _0x4f8a7c[_0xa39d0(0x114)]=_0x42cbf8,_0x4f8a7c[_0xa39d0(0x119)]=_0x596786,_0x4f8a7c['description']=_0x2673a3,_0x4f8a7c['isEnabled']=_0x4a2a46!==undefined?_0x4a2a46:_0x4f8a7c[_0xa39d0(0x12d)],_0x4f8a7c[_0xa39d0(0x120)]=_0x26a4d4!==undefined?_0x26a4d4:_0x4f8a7c['isSystemPlugin'],_0x4f8a7c['parameters']=_0x51fd0f,_0x4f8a7c[_0xa39d0(0x12a)]=_0x56c5e4!==undefined?_0x56c5e4:_0x4f8a7c[_0xa39d0(0x12a)],await this[_0xa39d0(0x126)][_0xa39d0(0x12c)](_0x4f8a7c),'修改插件信息成功';}async[_0x10f296(0x145)](_0x270bd5){const _0xe3ca64=_0x10f296,{id:_0x7dbbc}=_0x270bd5,_0x4a3f4c=await this[_0xe3ca64(0x126)]['findOne']({'where':{'id':_0x7dbbc}});if(!_0x4a3f4c)throw new common_1[(_0xe3ca64(0x147))]('该插件不存在！',common_1[_0xe3ca64(0x123)][_0xe3ca64(0x117)]);const _0x226a88=await this[_0xe3ca64(0x126)][_0xe3ca64(0x116)](_0x7dbbc);if(_0x226a88[_0xe3ca64(0x139)]>0x0)return _0xe3ca64(0x124);else throw new common_1[(_0xe3ca64(0x147))](_0xe3ca64(0x127),common_1[_0xe3ca64(0x123)][_0xe3ca64(0x117)]);}};PluginService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_1[_0x10f296(0x132)])(plugin_entity_1[_0x10f296(0x126)])),__metadata(_0x10f296(0x12b),[typeorm_2[_0x10f296(0x142)],models_service_1[_0x10f296(0x134)]])],PluginService),exports['PluginService']=PluginService;