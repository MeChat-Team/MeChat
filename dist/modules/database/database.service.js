'use strict';const _0x9a898d=_0x1a1d;(function(_0xd4b773,_0x2801da){const _0x2af4bf=_0x1a1d,_0x51a3d4=_0xd4b773();while(!![]){try{const _0x3c180a=-parseInt(_0x2af4bf(0x1c6))/0x1*(-parseInt(_0x2af4bf(0x1ee))/0x2)+-parseInt(_0x2af4bf(0x1df))/0x3+-parseInt(_0x2af4bf(0x1b2))/0x4+parseInt(_0x2af4bf(0x205))/0x5+parseInt(_0x2af4bf(0x1f8))/0x6+parseInt(_0x2af4bf(0x1d2))/0x7*(parseInt(_0x2af4bf(0x1c1))/0x8)+-parseInt(_0x2af4bf(0x199))/0x9;if(_0x3c180a===_0x2801da)break;else _0x51a3d4['push'](_0x51a3d4['shift']());}catch(_0x4290ad){_0x51a3d4['push'](_0x51a3d4['shift']());}}}(_0x5393,0xda770));function _0x1a1d(_0xab73e8,_0xae4b18){const _0x539374=_0x5393();return _0x1a1d=function(_0x1a1d96,_0x2f2fe1){_0x1a1d96=_0x1a1d96-0x194;let _0x37ad7a=_0x539374[_0x1a1d96];return _0x37ad7a;},_0x1a1d(_0xab73e8,_0xae4b18);}var __decorate=this&&this[_0x9a898d(0x1c9)]||function(_0x3ecfc3,_0x27d2e3,_0x374d90,_0x3b51f4){const _0x6d6652=_0x9a898d;var _0x23bb35=arguments[_0x6d6652(0x1b8)],_0x365c9c=_0x23bb35<0x3?_0x27d2e3:_0x3b51f4===null?_0x3b51f4=Object['getOwnPropertyDescriptor'](_0x27d2e3,_0x374d90):_0x3b51f4,_0x34fa04;if(typeof Reflect===_0x6d6652(0x1dc)&&typeof Reflect[_0x6d6652(0x1c7)]===_0x6d6652(0x19e))_0x365c9c=Reflect['decorate'](_0x3ecfc3,_0x27d2e3,_0x374d90,_0x3b51f4);else{for(var _0x576048=_0x3ecfc3[_0x6d6652(0x1b8)]-0x1;_0x576048>=0x0;_0x576048--)if(_0x34fa04=_0x3ecfc3[_0x576048])_0x365c9c=(_0x23bb35<0x3?_0x34fa04(_0x365c9c):_0x23bb35>0x3?_0x34fa04(_0x27d2e3,_0x374d90,_0x365c9c):_0x34fa04(_0x27d2e3,_0x374d90))||_0x365c9c;}return _0x23bb35>0x3&&_0x365c9c&&Object['defineProperty'](_0x27d2e3,_0x374d90,_0x365c9c),_0x365c9c;},__metadata=this&&this[_0x9a898d(0x1a5)]||function(_0x2eef0c,_0x54c862){const _0x27dfee=_0x9a898d;if(typeof Reflect===_0x27dfee(0x1dc)&&typeof Reflect[_0x27dfee(0x206)]==='function')return Reflect['metadata'](_0x2eef0c,_0x54c862);};Object[_0x9a898d(0x213)](exports,_0x9a898d(0x1d1),{'value':!![]}),exports['DatabaseService']=void 0x0;const common_1=require('@nestjs/common'),bcrypt=require(_0x9a898d(0x1b1)),typeorm_1=require(_0x9a898d(0x1e5));let DatabaseService=class DatabaseService{constructor(_0x5e5a37){const _0x5cd1b5=_0x9a898d;this[_0x5cd1b5(0x1bf)]=_0x5e5a37;}async[_0x9a898d(0x1b0)](){const _0x31c821=_0x9a898d;await this[_0x31c821(0x1be)](),await this['checkSiteBaseConfig'](),await this[_0x31c821(0x1de)](),await this[_0x31c821(0x1d6)]();}async['checkSuperAdmin'](){const _0x8fa2ec=_0x9a898d,_0x422c69=await this[_0x8fa2ec(0x1bf)][_0x8fa2ec(0x1b4)](_0x8fa2ec(0x1ae));if(!_0x422c69||_0x422c69[_0x8fa2ec(0x1b8)]===0x0){const _0x3343ac=bcrypt['hashSync'](_0x8fa2ec(0x1ed),0xa),_0x151cff=bcrypt[_0x8fa2ec(0x208)](_0x8fa2ec(0x1ed),0xa),_0x5ae4b9=_0x8fa2ec(0x1d7),_0x9306dd=_0x8fa2ec(0x194),_0x1e3b06={'username':_0x8fa2ec(0x1d7),'password':_0x3343ac,'status':0x1,'email':_0x5ae4b9,'sex':0x1,'role':_0x8fa2ec(0x1d7)},_0x339529={'username':'admin','password':_0x151cff,'status':0x0,'email':_0x9306dd,'sex':0x1,'role':_0x8fa2ec(0x194)};await this[_0x8fa2ec(0x1a4)](_0x1e3b06),await this[_0x8fa2ec(0x1a4)](_0x339529);}}async[_0x9a898d(0x1a4)](_0x59e7ac){const _0x22f8a2=_0x9a898d;try{const {username:_0x23488b,password:_0x4b0f52,status:_0x1190a4,email:_0x38fdf0,role:_0x666e9a}=_0x59e7ac,_0x458439=await this[_0x22f8a2(0x1bf)][_0x22f8a2(0x1b4)](_0x22f8a2(0x1a9)+_0x23488b+'\x27,\x20\x27'+_0x4b0f52+_0x22f8a2(0x1ba)+_0x1190a4+'\x27,\x20\x27'+_0x38fdf0+_0x22f8a2(0x1ba)+_0x666e9a+'\x27)'),_0x1534d2=_0x458439[_0x22f8a2(0x1c5)];await this[_0x22f8a2(0x1bf)][_0x22f8a2(0x1b4)](_0x22f8a2(0x1f5)+_0x1534d2+_0x22f8a2(0x211)),common_1[_0x22f8a2(0x20c)][_0x22f8a2(0x1b9)](_0x22f8a2(0x196)+_0x666e9a+'用户成功、用户名为['+_0x23488b+_0x22f8a2(0x1cb)+(_0x23488b==='super'?_0x22f8a2(0x1d7):_0x22f8a2(0x1ed))+_0x22f8a2(0x1db),_0x22f8a2(0x19c));}catch(_0x4fc158){console['log'](_0x22f8a2(0x1dd),_0x4fc158);throw new common_1[(_0x22f8a2(0x21b))](_0x22f8a2(0x1ea),common_1[_0x22f8a2(0x1ce)]['INTERNAL_SERVER_ERROR']);}}async[_0x9a898d(0x1d5)](){const _0xf7adb8=_0x9a898d,_0x27e0f0=[_0xf7adb8(0x20b),_0xf7adb8(0x1c4)],_0x33d776=await this[_0xf7adb8(0x1bf)][_0xf7adb8(0x1b4)]('\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20('+_0x27e0f0[_0xf7adb8(0x203)](_0x2f129b=>'\x27'+_0x2f129b+'\x27')[_0xf7adb8(0x1f6)](',')+')\x0a'),_0x4ce3a2=parseInt(_0x33d776[0x0][_0xf7adb8(0x197)]);_0x4ce3a2===0x0&&await this[_0xf7adb8(0x1ca)]();}async[_0x9a898d(0x1ca)](){const _0x29f9a3=_0x9a898d;try{const _0x3fe42c='',_0x31e659=_0x29f9a3(0x1d4),_0x64006d=[{'configKey':_0x29f9a3(0x20b),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1c4),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1cc),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x29f9a3(0x201),'configVal':_0x3fe42c,'public':0x1,'encry':0x0},{'configKey':'baiduSiteId','configVal':'','public':0x0,'encry':0x0},{'configKey':_0x29f9a3(0x207),'configVal':'','public':0x0,'encry':0x0},{'configKey':'buyCramiAddress','configVal':'','public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1b5),'configVal':'https://api.lightai.io','public':0x0,'encry':0x0},{'configKey':_0x29f9a3(0x20f),'configVal':_0x29f9a3(0x1e9),'public':0x0,'encry':0x0},{'configKey':'openaiBaseKey','configVal':_0x29f9a3(0x19d),'public':0x0,'encry':0x0},{'configKey':_0x29f9a3(0x1bd),'configVal':_0x29f9a3(0x1e6),'public':0x0,'encry':0x0},{'configKey':_0x29f9a3(0x1c3),'configVal':_0x31e659,'public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1ad),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1eb),'configVal':'30','public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x214),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1b3),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1d0),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1f7),'configVal':_0x29f9a3(0x1a2),'public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1e1),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1e8),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x212),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1e0),'configVal':'1','public':0x1,'encry':0x0},{'configKey':'model3Name','configVal':_0x29f9a3(0x202),'public':0x1,'encry':0x0},{'configKey':'model4Name','configVal':_0x29f9a3(0x1af),'public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1b7),'configVal':_0x29f9a3(0x1f0),'public':0x1,'encry':0x0},{'configKey':_0x29f9a3(0x1b6),'configVal':_0x29f9a3(0x216),'public':0x1,'encry':0x0}],_0x1d85f6=await this[_0x29f9a3(0x1bf)]['query']('INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20'+_0x64006d['map'](_0x4972cb=>'(\x27'+_0x4972cb[_0x29f9a3(0x1e2)]+'\x27,\x20\x27'+_0x4972cb[_0x29f9a3(0x1fe)][_0x29f9a3(0x1da)](/'/g,'\x5c\x27')+'\x27,\x20\x27'+_0x4972cb[_0x29f9a3(0x20a)]+_0x29f9a3(0x1ba)+_0x4972cb[_0x29f9a3(0x1cd)]+'\x27)')[_0x29f9a3(0x1f6)](',\x20'));common_1[_0x29f9a3(0x20c)][_0x29f9a3(0x1b9)](_0x29f9a3(0x215),_0x29f9a3(0x19c));}catch(_0x8c0d3b){console[_0x29f9a3(0x1b9)](_0x29f9a3(0x1dd),_0x8c0d3b);throw new common_1[(_0x29f9a3(0x21b))](_0x29f9a3(0x1bc),common_1[_0x29f9a3(0x1ce)]['INTERNAL_SERVER_ERROR']);}}async[_0x9a898d(0x1de)](){const _0x21d033=_0x9a898d,_0x26fbbe=await this[_0x21d033(0x1bf)][_0x21d033(0x1b4)]('SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20menu'),_0x534fce=parseInt(_0x26fbbe[0x0][_0x21d033(0x197)]);_0x534fce===0x0&&await this[_0x21d033(0x1e3)]();}async[_0x9a898d(0x1e3)](){const _0x5124dc=_0x9a898d;try{const _0x29a80e=[{'menuTipText':'对话聊天','menuIcon':'ri:message-3-line','menuName':_0x5124dc(0x1ec),'menuPath':'/chat','menuType':0x0,'menuPlatform':0x1,'order':0x64,'isShow':!![]},{'menuTipText':'应用广场','menuIcon':_0x5124dc(0x1f3),'menuName':_0x5124dc(0x1fd),'menuPath':_0x5124dc(0x1fa),'menuType':0x0,'menuPlatform':0x1,'order':0xc8,'isShow':!![]},{'menuTipText':_0x5124dc(0x1d3),'menuIcon':_0x5124dc(0x218),'menuName':_0x5124dc(0x1e4),'menuPath':_0x5124dc(0x19f),'menuType':0x0,'menuPlatform':0x1,'order':0x12c,'isShow':!![]},{'menuTipText':_0x5124dc(0x1d8),'menuIcon':_0x5124dc(0x20e),'menuName':_0x5124dc(0x1a6),'menuPath':_0x5124dc(0x1cf),'menuType':0x0,'menuPlatform':0x1,'order':0x190,'isShow':!![]},{'menuTipText':_0x5124dc(0x1c8),'menuIcon':_0x5124dc(0x1a7),'menuName':_0x5124dc(0x1aa),'menuPath':_0x5124dc(0x217),'menuType':0x0,'menuPlatform':0x1,'order':0x1f4,'isShow':!![]},{'menuTipText':'思维导图','menuIcon':'icon-park-outline:mindmap-map','menuName':_0x5124dc(0x19a),'menuPath':_0x5124dc(0x1ac),'menuType':0x0,'menuPlatform':0x1,'order':0x258,'isShow':!![]},{'menuTipText':'会员中心','menuIcon':_0x5124dc(0x1c2),'menuName':_0x5124dc(0x200),'menuPath':_0x5124dc(0x1fc),'menuType':0x0,'menuPlatform':0x1,'order':0x2bc,'isShow':!![]},{'menuTipText':'推广计划','menuIcon':_0x5124dc(0x210),'menuName':_0x5124dc(0x1e7),'menuPath':_0x5124dc(0x1a3),'menuType':0x0,'menuPlatform':0x1,'order':0x320,'isShow':!![]}],_0x3533c0=[{'menuTipText':_0x5124dc(0x20d),'menuIcon':_0x5124dc(0x1ef),'menuName':'Chat','menuPath':_0x5124dc(0x195),'menuType':0x0,'menuPlatform':0x0,'order':0x64,'isShow':!![]},{'menuTipText':'应用广场','menuIcon':_0x5124dc(0x1f3),'menuName':'AppStore','menuPath':_0x5124dc(0x1fa),'menuType':0x0,'menuPlatform':0x0,'order':0xc8,'isShow':!![]},{'menuTipText':_0x5124dc(0x1d3),'menuIcon':_0x5124dc(0x218),'menuName':_0x5124dc(0x1e4),'menuPath':_0x5124dc(0x19f),'menuType':0x0,'menuPlatform':0x0,'order':0x12c,'isShow':!![]},{'menuTipText':_0x5124dc(0x1f2),'menuIcon':_0x5124dc(0x1a1),'menuName':_0x5124dc(0x19a),'menuPath':_0x5124dc(0x1ac),'menuType':0x0,'menuPlatform':0x0,'order':0x190,'isShow':!![]},{'menuTipText':_0x5124dc(0x1a8),'menuIcon':_0x5124dc(0x21a),'menuName':_0x5124dc(0x19b),'menuPath':_0x5124dc(0x219),'menuType':0x0,'menuPlatform':0x0,'order':0x1f4,'isShow':!![]}],_0x2ae4a5=[..._0x29a80e,..._0x3533c0];for(const _0x4f7f1c of _0x2ae4a5){await this['connection'][_0x5124dc(0x1b4)](_0x5124dc(0x1f9),[_0x4f7f1c[_0x5124dc(0x1d9)],_0x4f7f1c[_0x5124dc(0x1bb)],_0x4f7f1c[_0x5124dc(0x1c0)],_0x4f7f1c['menuTipText'],_0x4f7f1c[_0x5124dc(0x1ab)],_0x4f7f1c[_0x5124dc(0x1fb)],null,_0x4f7f1c[_0x5124dc(0x1f1)],_0x4f7f1c[_0x5124dc(0x1f4)],![],![]]);}common_1['Logger'][_0x5124dc(0x1b9)](_0x5124dc(0x1ff),_0x5124dc(0x19c));}catch(_0xcf36c8){console[_0x5124dc(0x1b9)](_0x5124dc(0x1dd),_0xcf36c8);throw new common_1[(_0x5124dc(0x21b))](_0x5124dc(0x1a0),common_1[_0x5124dc(0x1ce)][_0x5124dc(0x198)]);}}async[_0x9a898d(0x1d6)](){}};DatabaseService=__decorate([(0x0,common_1[_0x9a898d(0x204)])(),__metadata('design:paramtypes',[typeorm_1[_0x9a898d(0x209)]])],DatabaseService),exports[_0x9a898d(0x19c)]=DatabaseService;function _0x5393(){const _0x136ccb=['Translate\x20any\x20given\x20phrase\x20from\x20any\x20language\x20into\x20English.\x20For\x20instance,\x20when\x20I\x20input\x20\x27{可爱的熊猫}\x27,\x20you\x20should\x20output\x20\x27{cute\x20panda}\x27,\x20with\x20no\x20period\x20at\x20the\x20end.','Share','firstRregisterSendModel4Count','300','创建默认超级管理员失败！','registerSendModel3Count','Chat','123456','214tfwLXW','ri:message-3-line','绘画积分','order','思维导图','ant-design:appstore-outlined','isShow','INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27','join','firstRegisterSendRank','6799680PXHguI','INSERT\x20INTO\x20menu\x20(menuName,\x20menuPath,\x20menuIcon,\x20menuTipText,\x20menuType,\x20menuPlatform,\x20menuIframeUrl,\x20`order`,\x20isShow,\x20isJump,\x20isNeedAuth,\x20createdAt,\x20updatedAt,\x20deletedAt)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20NOW(),\x20NOW(),\x20NULL)','/app-store','menuPlatform','/pay','AppStore','configVal','初始化菜单配置成功','Pay','baiduCode','普通积分','map','Injectable','111125xtOWXg','metadata','baiduToken','hashSync','Connection','public','siteName','Logger','对话聊天','solar:album-line-duotone','openaiTimeout','uiw:share','\x27,\x200,\x201000,\x20100)','firstRregisterSendDrawMjCount','defineProperty','registerSendModel4Count','初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅','油画风格,像素风格,赛博朋克,动漫,日系,超现实主义,油画,卡通,插画,海报,写实,扁平,中国风,水墨画,唯美二次元,印象派,炫彩插画,像素艺术,艺术创想,色彩主义,数字艺术','/draw','ri:landscape-line','/user-center','ri:account-pin-box-line','HttpException','admin','/chat','初始化创建','count','INTERNAL_SERVER_ERROR','2655819SUVZSu','Mind','UserCenter','DatabaseService','sk-','function','/midjourney','创建基础菜单配置失败！','icon-park-outline:mindmap-map','500','/share','createDefaultUser','__metadata','Market','fluent:draw-image-24-regular','个人中心','INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27','Draw','menuType','/mind','registerSendStatus','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27','高级积分','onModuleInit','bcryptjs','5404892RjXrvM','registerSendDrawMjCount','query','openaiBaseUrl','drawingStyles','drawMjName','length','log','\x27,\x20\x27','menuPath','创建默认网站配置失败！','mjTranslatePrompt','checkSuperAdmin','connection','menuIcon','2717632wwTAfm','icon-park-outline:shopping','noticeInfo','robotAvatar','insertId','12973TDOwMA','decorate','基础绘画','__decorate','createBaseSiteConfig',']、初始密码为[','userDefautlAvatar','encry','HttpStatus','/market','firstRegisterSendStatus','__esModule','21shjnuC','专业绘画','\x0a####\x20AIWeb\x20欢迎您\x0a\x20-\x20欢迎使用\x20AIWeb\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a','checkSiteBaseConfig','checkGalleryConfig','super','绘画广场','menuName','replace',']\x20==============>\x20请注意查阅','object','error:\x20','checkMenuConfig','3064746uCBmDX','isVerifyEmail','firstRregisterSendModel3Count','configKey','createBaseMenuConfig','Midjourney','typeorm'];_0x5393=function(){return _0x136ccb;};return _0x5393();}