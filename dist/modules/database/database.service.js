'use strict';const _0x508a0e=_0x1107;(function(_0x463588,_0x18c86c){const _0x50933a=_0x1107,_0x50c6e3=_0x463588();while(!![]){try{const _0x5361f2=-parseInt(_0x50933a(0x138))/0x1*(parseInt(_0x50933a(0x15a))/0x2)+parseInt(_0x50933a(0x160))/0x3*(parseInt(_0x50933a(0xff))/0x4)+-parseInt(_0x50933a(0x125))/0x5+parseInt(_0x50933a(0x110))/0x6*(parseInt(_0x50933a(0x148))/0x7)+-parseInt(_0x50933a(0x14a))/0x8*(-parseInt(_0x50933a(0xf7))/0x9)+-parseInt(_0x50933a(0x156))/0xa*(-parseInt(_0x50933a(0x107))/0xb)+parseInt(_0x50933a(0x123))/0xc;if(_0x5361f2===_0x18c86c)break;else _0x50c6e3['push'](_0x50c6e3['shift']());}catch(_0x112c65){_0x50c6e3['push'](_0x50c6e3['shift']());}}}(_0x116c,0x31d01));function _0x1107(_0xa7480a,_0x5c9e69){const _0x116c26=_0x116c();return _0x1107=function(_0x11074c,_0x4c32c5){_0x11074c=_0x11074c-0xf7;let _0x481ad6=_0x116c26[_0x11074c];return _0x481ad6;},_0x1107(_0xa7480a,_0x5c9e69);}var __decorate=this&&this['__decorate']||function(_0x3c829c,_0x14bb43,_0x5efb8f,_0x22cd1f){const _0x31c1e9=_0x1107;var _0x46c09c=arguments['length'],_0x509a92=_0x46c09c<0x3?_0x14bb43:_0x22cd1f===null?_0x22cd1f=Object['getOwnPropertyDescriptor'](_0x14bb43,_0x5efb8f):_0x22cd1f,_0x1a5be3;if(typeof Reflect===_0x31c1e9(0x13c)&&typeof Reflect['decorate']===_0x31c1e9(0x166))_0x509a92=Reflect[_0x31c1e9(0x100)](_0x3c829c,_0x14bb43,_0x5efb8f,_0x22cd1f);else{for(var _0x8d9f31=_0x3c829c[_0x31c1e9(0x11b)]-0x1;_0x8d9f31>=0x0;_0x8d9f31--)if(_0x1a5be3=_0x3c829c[_0x8d9f31])_0x509a92=(_0x46c09c<0x3?_0x1a5be3(_0x509a92):_0x46c09c>0x3?_0x1a5be3(_0x14bb43,_0x5efb8f,_0x509a92):_0x1a5be3(_0x14bb43,_0x5efb8f))||_0x509a92;}return _0x46c09c>0x3&&_0x509a92&&Object[_0x31c1e9(0xfa)](_0x14bb43,_0x5efb8f,_0x509a92),_0x509a92;},__metadata=this&&this[_0x508a0e(0x128)]||function(_0x384519,_0x5c199d){const _0x5bcc1d=_0x508a0e;if(typeof Reflect===_0x5bcc1d(0x13c)&&typeof Reflect[_0x5bcc1d(0x161)]===_0x5bcc1d(0x166))return Reflect['metadata'](_0x384519,_0x5c199d);};Object[_0x508a0e(0xfa)](exports,'__esModule',{'value':!![]}),exports[_0x508a0e(0x10d)]=void 0x0;const common_1=require(_0x508a0e(0x129)),bcrypt=require(_0x508a0e(0x146)),typeorm_1=require('typeorm');function _0x116c(){const _0x48a173=['join','Translate\x20any\x20given\x20phrase\x20from\x20any\x20language\x20into\x20English.\x20For\x20instance,\x20when\x20I\x20input\x20\x27{可爱的熊猫}\x27,\x20you\x20should\x20output\x20\x27{cute\x20panda}\x27,\x20with\x20no\x20period\x20at\x20the\x20end.','油画风格,像素风格,赛博朋克,动漫,日系,超现实主义,油画,卡通,插画,海报,写实,扁平,中国风,水墨画,唯美二次元,印象派,炫彩插画,像素艺术,艺术创想,色彩主义,数字艺术','应用广场','DatabaseService','registerSendDrawMjCount','https://api.lightai.io','4566qPpWBK','HttpStatus','createBaseSiteConfig','/pay','firstRegisterSendStatus','count','hashSync','UserCenter','/midjourney','/share','registerSendModel4Count','length','error:\x20','INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27','Logger','firstRregisterSendDrawMjCount','replace','robotAvatar','public','5002584hAUyLz','baiduSiteId','1910740AgvWYm',']\x20==============>\x20请注意查阅','初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅','__metadata','@nestjs/common','createDefaultUser','openaiTimeout','HttpException','Midjourney','Share','checkGalleryConfig','初始化菜单配置成功','创建基础菜单配置失败！','log','对话聊天','初始化创建','userDefautlAvatar','firstRegisterSendRank','/chat','5211ZDfYQG','order',']、初始密码为[','baiduCode','object','500','推广计划','AppStore','创建默认网站配置失败！','/mind','drawMjName','icon-park-outline:mindmap-map','buyCramiAddress','Mind','bcryptjs','baiduToken','1757ouIXzj','configVal','8xscESo','INTERNAL_SERVER_ERROR','ant-design:appstore-outlined','map','Chat','menuPlatform','model4Name','checkMenuConfig','createBaseMenuConfig','Draw','ri:message-3-line','\x0a####\x20AIWeb\x20欢迎您\x0a\x20-\x20欢迎使用\x20AIWeb\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a','990sgspNx','menuIcon','noticeInfo','123456','154hquSKd','/draw','Injectable','个人中心','siteName','高级积分','29163rfNdnr','metadata','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27','query','menuName','\x27,\x20\x27','function','design:paramtypes','fluent:draw-image-24-regular','绘画广场','sk-','\x27,\x200,\x201000,\x20100)','isVerifyEmail','super','普通积分','registerSendStatus','300','/app-store','987669ZhJUGK','ri:landscape-line','基础绘画','defineProperty','INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27','firstRregisterSendModel4Count','registerSendModel3Count','思维导图','4RQSmbj','decorate','ri:account-pin-box-line','connection','drawingStyles','checkSiteBaseConfig','admin','/user-center','28897iARGDR','专业绘画'];_0x116c=function(){return _0x48a173;};return _0x116c();}let DatabaseService=class DatabaseService{constructor(_0x33157e){this['connection']=_0x33157e;}async['onModuleInit'](){const _0x550cab=_0x508a0e;await this['checkSuperAdmin'](),await this['checkSiteBaseConfig'](),await this[_0x550cab(0x151)](),await this[_0x550cab(0x12f)]();}async['checkSuperAdmin'](){const _0x58c443=_0x508a0e,_0x15f523=await this[_0x58c443(0x102)][_0x58c443(0x163)](_0x58c443(0x162));if(!_0x15f523||_0x15f523[_0x58c443(0x11b)]===0x0){const _0x3b9109=bcrypt[_0x58c443(0x116)](_0x58c443(0x159),0xa),_0x21f146=bcrypt[_0x58c443(0x116)](_0x58c443(0x159),0xa),_0x3b480c=_0x58c443(0x16d),_0x2eaea2=_0x58c443(0x105),_0x523d07={'username':_0x58c443(0x16d),'password':_0x3b9109,'status':0x1,'email':_0x3b480c,'sex':0x1,'role':_0x58c443(0x16d)},_0x13690a={'username':_0x58c443(0x105),'password':_0x21f146,'status':0x0,'email':_0x2eaea2,'sex':0x1,'role':'admin'};await this[_0x58c443(0x12a)](_0x523d07),await this[_0x58c443(0x12a)](_0x13690a);}}async[_0x508a0e(0x12a)](_0x5d63de){const _0x2671c5=_0x508a0e;try{const {username:_0x2c98bf,password:_0x1e13bb,status:_0x48bfbc,email:_0x106e29,role:_0x10509d}=_0x5d63de,_0x27675a=await this[_0x2671c5(0x102)][_0x2671c5(0x163)](_0x2671c5(0x11d)+_0x2c98bf+_0x2671c5(0x165)+_0x1e13bb+'\x27,\x20\x27'+_0x48bfbc+_0x2671c5(0x165)+_0x106e29+_0x2671c5(0x165)+_0x10509d+'\x27)'),_0x67a727=_0x27675a['insertId'];await this[_0x2671c5(0x102)]['query'](_0x2671c5(0xfb)+_0x67a727+_0x2671c5(0x16b)),common_1[_0x2671c5(0x11e)][_0x2671c5(0x132)](_0x2671c5(0x134)+_0x10509d+'用户成功、用户名为['+_0x2c98bf+_0x2671c5(0x13a)+(_0x2c98bf===_0x2671c5(0x16d)?_0x2671c5(0x16d):_0x2671c5(0x159))+_0x2671c5(0x126),_0x2671c5(0x10d));}catch(_0x377ed1){console['log'](_0x2671c5(0x11c),_0x377ed1);throw new common_1['HttpException']('创建默认超级管理员失败！',common_1['HttpStatus'][_0x2671c5(0x14b)]);}}async[_0x508a0e(0x104)](){const _0x2dddfd=_0x508a0e,_0x90cafb=[_0x2dddfd(0x15e),_0x2dddfd(0x121)],_0x969465=await this[_0x2dddfd(0x102)][_0x2dddfd(0x163)]('\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20('+_0x90cafb[_0x2dddfd(0x14d)](_0x27d38c=>'\x27'+_0x27d38c+'\x27')['join'](',')+')\x0a'),_0x1d09be=parseInt(_0x969465[0x0][_0x2dddfd(0x115)]);_0x1d09be===0x0&&await this[_0x2dddfd(0x112)]();}async[_0x508a0e(0x112)](){const _0x33d890=_0x508a0e;try{const _0x32ac80='',_0xe3fe10=_0x33d890(0x155),_0x10923f=[{'configKey':_0x33d890(0x15e),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x33d890(0x121),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x33d890(0x135),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x33d890(0x13b),'configVal':_0x32ac80,'public':0x1,'encry':0x0},{'configKey':_0x33d890(0x124),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x33d890(0x147),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x33d890(0x144),'configVal':'','public':0x1,'encry':0x0},{'configKey':'openaiBaseUrl','configVal':_0x33d890(0x10f),'public':0x0,'encry':0x0},{'configKey':_0x33d890(0x12b),'configVal':_0x33d890(0x170),'public':0x0,'encry':0x0},{'configKey':'openaiBaseKey','configVal':_0x33d890(0x16a),'public':0x0,'encry':0x0},{'configKey':'mjTranslatePrompt','configVal':_0x33d890(0x10a),'public':0x0,'encry':0x0},{'configKey':_0x33d890(0x158),'configVal':_0xe3fe10,'public':0x1,'encry':0x0},{'configKey':_0x33d890(0x16f),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x33d890(0xfd),'configVal':'30','public':0x1,'encry':0x0},{'configKey':_0x33d890(0x11a),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x33d890(0x10e),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x33d890(0x114),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x33d890(0x136),'configVal':_0x33d890(0x13d),'public':0x1,'encry':0x0},{'configKey':'firstRregisterSendModel3Count','configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x33d890(0xfc),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x33d890(0x11f),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x33d890(0x16c),'configVal':'1','public':0x1,'encry':0x0},{'configKey':'model3Name','configVal':_0x33d890(0x16e),'public':0x1,'encry':0x0},{'configKey':_0x33d890(0x150),'configVal':_0x33d890(0x15f),'public':0x1,'encry':0x0},{'configKey':_0x33d890(0x142),'configVal':'绘画积分','public':0x1,'encry':0x0},{'configKey':_0x33d890(0x103),'configVal':_0x33d890(0x10b),'public':0x1,'encry':0x0}],_0x2b1b61=await this[_0x33d890(0x102)][_0x33d890(0x163)]('INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20'+_0x10923f['map'](_0x51d1d4=>'(\x27'+_0x51d1d4['configKey']+_0x33d890(0x165)+_0x51d1d4[_0x33d890(0x149)][_0x33d890(0x120)](/'/g,'\x5c\x27')+'\x27,\x20\x27'+_0x51d1d4[_0x33d890(0x122)]+_0x33d890(0x165)+_0x51d1d4['encry']+'\x27)')[_0x33d890(0x109)](',\x20'));common_1[_0x33d890(0x11e)][_0x33d890(0x132)](_0x33d890(0x127),_0x33d890(0x10d));}catch(_0x32ec96){console['log'](_0x33d890(0x11c),_0x32ec96);throw new common_1['HttpException'](_0x33d890(0x140),common_1[_0x33d890(0x111)][_0x33d890(0x14b)]);}}async['checkMenuConfig'](){const _0x2b2c94=_0x508a0e,_0x313c05=await this['connection'][_0x2b2c94(0x163)]('SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20menu'),_0xce94f4=parseInt(_0x313c05[0x0][_0x2b2c94(0x115)]);_0xce94f4===0x0&&await this[_0x2b2c94(0x152)]();}async[_0x508a0e(0x152)](){const _0x43d3fa=_0x508a0e;try{const _0x284f9d=[{'menuTipText':_0x43d3fa(0x133),'menuIcon':_0x43d3fa(0x154),'menuName':_0x43d3fa(0x14e),'menuPath':_0x43d3fa(0x137),'menuType':0x0,'menuPlatform':0x1,'order':0x64,'isShow':!![]},{'menuTipText':_0x43d3fa(0x10c),'menuIcon':_0x43d3fa(0x14c),'menuName':'AppStore','menuPath':'/app-store','menuType':0x0,'menuPlatform':0x1,'order':0xc8,'isShow':!![]},{'menuTipText':_0x43d3fa(0x108),'menuIcon':_0x43d3fa(0xf8),'menuName':'Midjourney','menuPath':_0x43d3fa(0x118),'menuType':0x0,'menuPlatform':0x1,'order':0x12c,'isShow':!![]},{'menuTipText':_0x43d3fa(0x169),'menuIcon':'solar:album-line-duotone','menuName':'Market','menuPath':'/market','menuType':0x0,'menuPlatform':0x1,'order':0x190,'isShow':!![]},{'menuTipText':_0x43d3fa(0xf9),'menuIcon':_0x43d3fa(0x168),'menuName':_0x43d3fa(0x153),'menuPath':_0x43d3fa(0x15b),'menuType':0x0,'menuPlatform':0x1,'order':0x1f4,'isShow':!![]},{'menuTipText':_0x43d3fa(0xfe),'menuIcon':_0x43d3fa(0x143),'menuName':'Mind','menuPath':_0x43d3fa(0x141),'menuType':0x0,'menuPlatform':0x1,'order':0x258,'isShow':!![]},{'menuTipText':'会员中心','menuIcon':'icon-park-outline:shopping','menuName':'Pay','menuPath':_0x43d3fa(0x113),'menuType':0x0,'menuPlatform':0x1,'order':0x2bc,'isShow':!![]},{'menuTipText':_0x43d3fa(0x13e),'menuIcon':'uiw:share','menuName':_0x43d3fa(0x12e),'menuPath':_0x43d3fa(0x119),'menuType':0x0,'menuPlatform':0x1,'order':0x320,'isShow':!![]}],_0x1627b6=[{'menuTipText':_0x43d3fa(0x133),'menuIcon':_0x43d3fa(0x154),'menuName':_0x43d3fa(0x14e),'menuPath':_0x43d3fa(0x137),'menuType':0x0,'menuPlatform':0x0,'order':0x64,'isShow':!![]},{'menuTipText':'应用广场','menuIcon':_0x43d3fa(0x14c),'menuName':_0x43d3fa(0x13f),'menuPath':_0x43d3fa(0x171),'menuType':0x0,'menuPlatform':0x0,'order':0xc8,'isShow':!![]},{'menuTipText':_0x43d3fa(0x108),'menuIcon':_0x43d3fa(0xf8),'menuName':_0x43d3fa(0x12d),'menuPath':_0x43d3fa(0x118),'menuType':0x0,'menuPlatform':0x0,'order':0x12c,'isShow':!![]},{'menuTipText':_0x43d3fa(0xfe),'menuIcon':_0x43d3fa(0x143),'menuName':_0x43d3fa(0x145),'menuPath':_0x43d3fa(0x141),'menuType':0x0,'menuPlatform':0x0,'order':0x190,'isShow':!![]},{'menuTipText':_0x43d3fa(0x15d),'menuIcon':_0x43d3fa(0x101),'menuName':_0x43d3fa(0x117),'menuPath':_0x43d3fa(0x106),'menuType':0x0,'menuPlatform':0x0,'order':0x1f4,'isShow':!![]}],_0x550726=[..._0x284f9d,..._0x1627b6];for(const _0x54fd6d of _0x550726){await this[_0x43d3fa(0x102)][_0x43d3fa(0x163)]('INSERT\x20INTO\x20menu\x20(menuName,\x20menuPath,\x20menuIcon,\x20menuTipText,\x20menuType,\x20menuPlatform,\x20menuIframeUrl,\x20`order`,\x20isShow,\x20isJump,\x20isNeedAuth,\x20createdAt,\x20updatedAt,\x20deletedAt)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20NOW(),\x20NOW(),\x20NULL)',[_0x54fd6d[_0x43d3fa(0x164)],_0x54fd6d['menuPath'],_0x54fd6d[_0x43d3fa(0x157)],_0x54fd6d['menuTipText'],_0x54fd6d['menuType'],_0x54fd6d[_0x43d3fa(0x14f)],null,_0x54fd6d[_0x43d3fa(0x139)],_0x54fd6d['isShow'],![],![]]);}common_1[_0x43d3fa(0x11e)][_0x43d3fa(0x132)](_0x43d3fa(0x130),'DatabaseService');}catch(_0x1d3bc7){console['log'](_0x43d3fa(0x11c),_0x1d3bc7);throw new common_1[(_0x43d3fa(0x12c))](_0x43d3fa(0x131),common_1['HttpStatus'][_0x43d3fa(0x14b)]);}}async[_0x508a0e(0x12f)](){}};DatabaseService=__decorate([(0x0,common_1[_0x508a0e(0x15c)])(),__metadata(_0x508a0e(0x167),[typeorm_1['Connection']])],DatabaseService),exports['DatabaseService']=DatabaseService;