'use strict';const _0x37ed04=_0x3349;(function(_0x2c8be0,_0x554bf8){const _0x4cc74d=_0x3349,_0x4fa58a=_0x2c8be0();while(!![]){try{const _0x4e7466=parseInt(_0x4cc74d(0x1de))/0x1*(parseInt(_0x4cc74d(0x218))/0x2)+-parseInt(_0x4cc74d(0x1e9))/0x3+parseInt(_0x4cc74d(0x224))/0x4*(-parseInt(_0x4cc74d(0x1cb))/0x5)+-parseInt(_0x4cc74d(0x22d))/0x6*(parseInt(_0x4cc74d(0x246))/0x7)+-parseInt(_0x4cc74d(0x242))/0x8+-parseInt(_0x4cc74d(0x1f5))/0x9*(-parseInt(_0x4cc74d(0x240))/0xa)+parseInt(_0x4cc74d(0x21e))/0xb*(parseInt(_0x4cc74d(0x209))/0xc);if(_0x4e7466===_0x554bf8)break;else _0x4fa58a['push'](_0x4fa58a['shift']());}catch(_0x2953a9){_0x4fa58a['push'](_0x4fa58a['shift']());}}}(_0x10f3,0x91ab3));function _0x3349(_0x2812cc,_0x5b9a1f){const _0x10f318=_0x10f3();return _0x3349=function(_0x334986,_0x4ac13b){_0x334986=_0x334986-0x1c8;let _0x43fdb5=_0x10f318[_0x334986];return _0x43fdb5;},_0x3349(_0x2812cc,_0x5b9a1f);}function _0x10f3(){const _0x2cdaa6=['高级积分','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27','solar:album-line-duotone','onModuleInit','ri:message-3-line','checkSiteBaseConfig','log','connection','noticeInfo','registerSendModel4Count','1765707KNFDjn','error:\x20','Logger','sk-','isShow','123456','DatabaseService','Mind','https://api.lightai.io','/mind','推广计划','__metadata','13140PaxHmU','绘画积分','__esModule','decorate','思维导图','SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20menu','siteName','Draw','object','ant-design:appstore-outlined','order','isVerifyEmail','Market','openaiTimeout','configVal','icon-park-outline:shopping','个人中心','checkMenuConfig','INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27','firstRegisterSendRank','72CnJOfc','HttpStatus','应用广场','Midjourney','/midjourney','join','menuPlatform','baiduSiteId','INSERT\x20INTO\x20menu\x20(menuName,\x20menuPath,\x20menuIcon,\x20menuTipText,\x20menuType,\x20menuPlatform,\x20menuIframeUrl,\x20`order`,\x20isShow,\x20isJump,\x20isNeedAuth,\x20createdAt,\x20updatedAt,\x20deletedAt)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20NOW(),\x20NOW(),\x20NULL)','menuName','油画风格,像素风格,赛博朋克,动漫,日系,超现实主义,油画,卡通,插画,海报,写实,扁平,中国风,水墨画,唯美二次元,印象派,炫彩插画,像素艺术,艺术创想,色彩主义,数字艺术','Injectable','menuIcon','menuPath','length','4PzsXKk','500','uiw:share','drawMjName','会员中心','/market','3634433IOgUho','AppStore','基础绘画','configKey','Chat','普通积分','1267248rrTEZt','mjTranslatePrompt','HttpException','count','replace','icon-park-outline:mindmap-map','map','/share','insertId','186762DecSeU','menuTipText','super','model4Name','admin','encry','createDefaultUser','registerSendModel3Count','checkGalleryConfig','ri:landscape-line','对话聊天','firstRregisterSendModel3Count','openaiBaseUrl','初始化菜单配置成功','初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅','robotAvatar','baiduToken','model3Name','design:paramtypes','5410gJwavP','firstRregisterSendDrawMjCount','2063544bURVzz','query','hashSync','UserCenter','147MbyQto','function','INTERNAL_SERVER_ERROR','checkSuperAdmin','@nestjs/common','Translate\x20any\x20given\x20phrase\x20from\x20any\x20language\x20into\x20English.\x20For\x20instance,\x20when\x20I\x20input\x20\x27{可爱的熊猫}\x27,\x20you\x20should\x20output\x20\x27{cute\x20panda}\x27,\x20with\x20no\x20period\x20at\x20the\x20end.','创建默认网站配置失败！','menuType','/draw','buyCramiAddress','__decorate','userDefautlAvatar','INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20','15QHoCQa','metadata','\x27,\x20\x27','registerSendStatus','Connection','创建默认超级管理员失败！','drawingStyles','用户成功、用户名为[',']\x20==============>\x20请注意查阅','初始化创建',']、初始密码为[','Share','createBaseMenuConfig','/app-store','/chat','专业绘画','firstRregisterSendModel4Count','baiduCode','\x27,\x200,\x201000,\x20100)','137498qKufMj'];_0x10f3=function(){return _0x2cdaa6;};return _0x10f3();}var __decorate=this&&this[_0x37ed04(0x1c8)]||function(_0x3eab61,_0x419864,_0x5520f3,_0x427868){const _0x29df48=_0x37ed04;var _0x5d19b8=arguments['length'],_0x2d7ce9=_0x5d19b8<0x3?_0x419864:_0x427868===null?_0x427868=Object['getOwnPropertyDescriptor'](_0x419864,_0x5520f3):_0x427868,_0x306895;if(typeof Reflect===_0x29df48(0x1fd)&&typeof Reflect[_0x29df48(0x1f8)]===_0x29df48(0x247))_0x2d7ce9=Reflect[_0x29df48(0x1f8)](_0x3eab61,_0x419864,_0x5520f3,_0x427868);else{for(var _0x4d5b4f=_0x3eab61[_0x29df48(0x217)]-0x1;_0x4d5b4f>=0x0;_0x4d5b4f--)if(_0x306895=_0x3eab61[_0x4d5b4f])_0x2d7ce9=(_0x5d19b8<0x3?_0x306895(_0x2d7ce9):_0x5d19b8>0x3?_0x306895(_0x419864,_0x5520f3,_0x2d7ce9):_0x306895(_0x419864,_0x5520f3))||_0x2d7ce9;}return _0x5d19b8>0x3&&_0x2d7ce9&&Object['defineProperty'](_0x419864,_0x5520f3,_0x2d7ce9),_0x2d7ce9;},__metadata=this&&this[_0x37ed04(0x1f4)]||function(_0x59911e,_0x1bb9b5){const _0x4dedfc=_0x37ed04;if(typeof Reflect===_0x4dedfc(0x1fd)&&typeof Reflect['metadata']===_0x4dedfc(0x247))return Reflect[_0x4dedfc(0x1cc)](_0x59911e,_0x1bb9b5);};Object['defineProperty'](exports,_0x37ed04(0x1f7),{'value':!![]}),exports['DatabaseService']=void 0x0;const common_1=require(_0x37ed04(0x24a)),bcrypt=require('bcryptjs'),typeorm_1=require('typeorm');let DatabaseService=class DatabaseService{constructor(_0x5928ff){const _0x31af5c=_0x37ed04;this[_0x31af5c(0x1e6)]=_0x5928ff;}async[_0x37ed04(0x1e2)](){const _0x479c8c=_0x37ed04;await this[_0x479c8c(0x249)](),await this[_0x479c8c(0x1e4)](),await this[_0x479c8c(0x206)](),await this[_0x479c8c(0x235)]();}async[_0x37ed04(0x249)](){const _0x3e0a28=_0x37ed04,_0x348c24=await this['connection'][_0x3e0a28(0x243)](_0x3e0a28(0x1e0));if(!_0x348c24||_0x348c24[_0x3e0a28(0x217)]===0x0){const _0x54563c=bcrypt['hashSync'](_0x3e0a28(0x1ee),0xa),_0x5e3ced=bcrypt[_0x3e0a28(0x244)](_0x3e0a28(0x1ee),0xa),_0x19f8df='super',_0x55a1b3=_0x3e0a28(0x231),_0x5eb567={'username':_0x3e0a28(0x22f),'password':_0x54563c,'status':0x1,'email':_0x19f8df,'sex':0x1,'role':_0x3e0a28(0x22f)},_0x5456dd={'username':'admin','password':_0x5e3ced,'status':0x0,'email':_0x55a1b3,'sex':0x1,'role':'admin'};await this['createDefaultUser'](_0x5eb567),await this['createDefaultUser'](_0x5456dd);}}async[_0x37ed04(0x233)](_0x130af6){const _0x33d5c2=_0x37ed04;try{const {username:_0x1f219b,password:_0x19f217,status:_0x2b39e2,email:_0x1f4b06,role:_0x4a4ec4}=_0x130af6,_0x2c64f1=await this['connection']['query']('INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27'+_0x1f219b+_0x33d5c2(0x1cd)+_0x19f217+_0x33d5c2(0x1cd)+_0x2b39e2+_0x33d5c2(0x1cd)+_0x1f4b06+'\x27,\x20\x27'+_0x4a4ec4+'\x27)'),_0x56b2cc=_0x2c64f1[_0x33d5c2(0x22c)];await this[_0x33d5c2(0x1e6)]['query'](_0x33d5c2(0x207)+_0x56b2cc+_0x33d5c2(0x1dd)),common_1['Logger']['log'](_0x33d5c2(0x1d4)+_0x4a4ec4+_0x33d5c2(0x1d2)+_0x1f219b+_0x33d5c2(0x1d5)+(_0x1f219b===_0x33d5c2(0x22f)?_0x33d5c2(0x22f):'123456')+_0x33d5c2(0x1d3),_0x33d5c2(0x1ef));}catch(_0x44b48c){console['log'](_0x33d5c2(0x1ea),_0x44b48c);throw new common_1[(_0x33d5c2(0x226))](_0x33d5c2(0x1d0),common_1[_0x33d5c2(0x20a)][_0x33d5c2(0x248)]);}}async[_0x37ed04(0x1e4)](){const _0x4d30ca=_0x37ed04,_0x3ce18f=[_0x4d30ca(0x1fb),_0x4d30ca(0x23c)],_0x1315ca=await this[_0x4d30ca(0x1e6)][_0x4d30ca(0x243)]('\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20('+_0x3ce18f[_0x4d30ca(0x22a)](_0x52ca81=>'\x27'+_0x52ca81+'\x27')[_0x4d30ca(0x20e)](',')+')\x0a'),_0x236cc7=parseInt(_0x1315ca[0x0][_0x4d30ca(0x227)]);_0x236cc7===0x0&&await this['createBaseSiteConfig']();}async['createBaseSiteConfig'](){const _0x383412=_0x37ed04;try{const _0x188cb2='',_0x49d62f='\x0a####\x20AIWeb\x20欢迎您\x0a\x20-\x20欢迎使用\x20AIWeb\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a',_0x32723f=[{'configKey':'siteName','configVal':'','public':0x1,'encry':0x0},{'configKey':_0x383412(0x23c),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x383412(0x1c9),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x383412(0x1dc),'configVal':_0x188cb2,'public':0x1,'encry':0x0},{'configKey':_0x383412(0x210),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x383412(0x23d),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x383412(0x24f),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x383412(0x239),'configVal':_0x383412(0x1f1),'public':0x0,'encry':0x0},{'configKey':_0x383412(0x202),'configVal':'300','public':0x0,'encry':0x0},{'configKey':'openaiBaseKey','configVal':_0x383412(0x1ec),'public':0x0,'encry':0x0},{'configKey':_0x383412(0x225),'configVal':_0x383412(0x24b),'public':0x0,'encry':0x0},{'configKey':_0x383412(0x1e7),'configVal':_0x49d62f,'public':0x1,'encry':0x0},{'configKey':_0x383412(0x1ce),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x383412(0x234),'configVal':'30','public':0x1,'encry':0x0},{'configKey':_0x383412(0x1e8),'configVal':'3','public':0x1,'encry':0x0},{'configKey':'registerSendDrawMjCount','configVal':'3','public':0x1,'encry':0x0},{'configKey':'firstRegisterSendStatus','configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x383412(0x208),'configVal':_0x383412(0x219),'public':0x1,'encry':0x0},{'configKey':_0x383412(0x238),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x383412(0x1db),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x383412(0x241),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x383412(0x200),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x383412(0x23e),'configVal':_0x383412(0x223),'public':0x1,'encry':0x0},{'configKey':_0x383412(0x230),'configVal':_0x383412(0x1df),'public':0x1,'encry':0x0},{'configKey':_0x383412(0x21b),'configVal':_0x383412(0x1f6),'public':0x1,'encry':0x0},{'configKey':_0x383412(0x1d1),'configVal':_0x383412(0x213),'public':0x1,'encry':0x0}],_0x12336c=await this[_0x383412(0x1e6)]['query'](_0x383412(0x1ca)+_0x32723f[_0x383412(0x22a)](_0x3a2721=>'(\x27'+_0x3a2721[_0x383412(0x221)]+'\x27,\x20\x27'+_0x3a2721[_0x383412(0x203)][_0x383412(0x228)](/'/g,'\x5c\x27')+_0x383412(0x1cd)+_0x3a2721['public']+'\x27,\x20\x27'+_0x3a2721[_0x383412(0x232)]+'\x27)')['join'](',\x20'));common_1['Logger'][_0x383412(0x1e5)](_0x383412(0x23b),'DatabaseService');}catch(_0x246102){console['log']('error:\x20',_0x246102);throw new common_1[(_0x383412(0x226))](_0x383412(0x24c),common_1['HttpStatus']['INTERNAL_SERVER_ERROR']);}}async[_0x37ed04(0x206)](){const _0x1c4de9=_0x37ed04,_0x5038cc=await this[_0x1c4de9(0x1e6)][_0x1c4de9(0x243)](_0x1c4de9(0x1fa)),_0x1c3df8=parseInt(_0x5038cc[0x0][_0x1c4de9(0x227)]);_0x1c3df8===0x0&&await this[_0x1c4de9(0x1d7)]();}async[_0x37ed04(0x1d7)](){const _0x1cad4b=_0x37ed04;try{const _0x5589a4=[{'menuTipText':_0x1cad4b(0x237),'menuIcon':_0x1cad4b(0x1e3),'menuName':_0x1cad4b(0x222),'menuPath':'/chat','menuType':0x0,'menuPlatform':0x1,'order':0x64,'isShow':!![]},{'menuTipText':_0x1cad4b(0x20b),'menuIcon':_0x1cad4b(0x1fe),'menuName':_0x1cad4b(0x21f),'menuPath':_0x1cad4b(0x1d8),'menuType':0x0,'menuPlatform':0x1,'order':0xc8,'isShow':!![]},{'menuTipText':_0x1cad4b(0x1da),'menuIcon':_0x1cad4b(0x236),'menuName':_0x1cad4b(0x20c),'menuPath':'/midjourney','menuType':0x0,'menuPlatform':0x1,'order':0x12c,'isShow':!![]},{'menuTipText':'绘画广场','menuIcon':_0x1cad4b(0x1e1),'menuName':_0x1cad4b(0x201),'menuPath':_0x1cad4b(0x21d),'menuType':0x0,'menuPlatform':0x1,'order':0x190,'isShow':!![]},{'menuTipText':_0x1cad4b(0x220),'menuIcon':'fluent:draw-image-24-regular','menuName':_0x1cad4b(0x1fc),'menuPath':_0x1cad4b(0x24e),'menuType':0x0,'menuPlatform':0x1,'order':0x1f4,'isShow':!![]},{'menuTipText':_0x1cad4b(0x1f9),'menuIcon':_0x1cad4b(0x229),'menuName':_0x1cad4b(0x1f0),'menuPath':_0x1cad4b(0x1f2),'menuType':0x0,'menuPlatform':0x1,'order':0x258,'isShow':!![]},{'menuTipText':_0x1cad4b(0x21c),'menuIcon':_0x1cad4b(0x204),'menuName':'Pay','menuPath':'/pay','menuType':0x0,'menuPlatform':0x1,'order':0x2bc,'isShow':!![]},{'menuTipText':_0x1cad4b(0x1f3),'menuIcon':_0x1cad4b(0x21a),'menuName':_0x1cad4b(0x1d6),'menuPath':_0x1cad4b(0x22b),'menuType':0x0,'menuPlatform':0x1,'order':0x320,'isShow':!![]}],_0xb41cd7=[{'menuTipText':_0x1cad4b(0x237),'menuIcon':'ri:message-3-line','menuName':_0x1cad4b(0x222),'menuPath':_0x1cad4b(0x1d9),'menuType':0x0,'menuPlatform':0x0,'order':0x64,'isShow':!![]},{'menuTipText':_0x1cad4b(0x20b),'menuIcon':_0x1cad4b(0x1fe),'menuName':_0x1cad4b(0x21f),'menuPath':_0x1cad4b(0x1d8),'menuType':0x0,'menuPlatform':0x0,'order':0xc8,'isShow':!![]},{'menuTipText':'专业绘画','menuIcon':_0x1cad4b(0x236),'menuName':'Midjourney','menuPath':_0x1cad4b(0x20d),'menuType':0x0,'menuPlatform':0x0,'order':0x12c,'isShow':!![]},{'menuTipText':_0x1cad4b(0x1f9),'menuIcon':_0x1cad4b(0x229),'menuName':'Mind','menuPath':_0x1cad4b(0x1f2),'menuType':0x0,'menuPlatform':0x0,'order':0x190,'isShow':!![]},{'menuTipText':_0x1cad4b(0x205),'menuIcon':'ri:account-pin-box-line','menuName':_0x1cad4b(0x245),'menuPath':'/user-center','menuType':0x0,'menuPlatform':0x0,'order':0x1f4,'isShow':!![]}],_0x11ec60=[..._0x5589a4,..._0xb41cd7];for(const _0x150b40 of _0x11ec60){await this[_0x1cad4b(0x1e6)][_0x1cad4b(0x243)](_0x1cad4b(0x211),[_0x150b40[_0x1cad4b(0x212)],_0x150b40[_0x1cad4b(0x216)],_0x150b40[_0x1cad4b(0x215)],_0x150b40[_0x1cad4b(0x22e)],_0x150b40[_0x1cad4b(0x24d)],_0x150b40[_0x1cad4b(0x20f)],null,_0x150b40[_0x1cad4b(0x1ff)],_0x150b40[_0x1cad4b(0x1ed)],![],![]]);}common_1[_0x1cad4b(0x1eb)]['log'](_0x1cad4b(0x23a),_0x1cad4b(0x1ef));}catch(_0x1a782d){console[_0x1cad4b(0x1e5)](_0x1cad4b(0x1ea),_0x1a782d);throw new common_1[(_0x1cad4b(0x226))]('创建基础菜单配置失败！',common_1[_0x1cad4b(0x20a)][_0x1cad4b(0x248)]);}}async['checkGalleryConfig'](){}};DatabaseService=__decorate([(0x0,common_1[_0x37ed04(0x214)])(),__metadata(_0x37ed04(0x23f),[typeorm_1[_0x37ed04(0x1cf)]])],DatabaseService),exports[_0x37ed04(0x1ef)]=DatabaseService;