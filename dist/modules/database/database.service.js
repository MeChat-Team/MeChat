'use strict';function _0x1bcf(_0x20979c,_0x482288){const _0x2dd728=_0x2dd7();return _0x1bcf=function(_0x1bcf73,_0x3c9896){_0x1bcf73=_0x1bcf73-0x1bb;let _0x6b660=_0x2dd728[_0x1bcf73];return _0x6b660;},_0x1bcf(_0x20979c,_0x482288);}function _0x2dd7(){const _0x40cbc8=['menuTipText','baiduSiteId','createBaseSiteConfig','getOwnPropertyDescriptor','/mind','buyCramiAddress','初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅','Share','openaiBaseUrl','高级积分','drawMjName','order','icon-park-outline:mindmap-map','checkMenuConfig','\x0a####\x20AIWeb\x20欢迎您\x0a\x20-\x20欢迎使用\x20AIWeb\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a','HttpStatus','SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20menu','Mind','ri:account-pin-box-line','metadata','firstRregisterSendModel4Count','query','21VPkTbS','500','INSERT\x20INTO\x20menu\x20(menuName,\x20menuPath,\x20menuIcon,\x20menuTipText,\x20menuType,\x20menuPlatform,\x20menuIframeUrl,\x20`order`,\x20isShow,\x20isJump,\x20isNeedAuth,\x20createdAt,\x20updatedAt,\x20deletedAt)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20NOW(),\x20NOW(),\x20NULL)','function','userDefautlAvatar','public','uiw:share','registerSendDrawMjCount','connection','2439bhIltI','普通积分','用户成功、用户名为[','drawingStyles','/app-store','menuIcon','油画风格,像素风格,赛博朋克,动漫,日系,超现实主义,油画,卡通,插画,海报,写实,扁平,中国风,水墨画,唯美二次元,印象派,炫彩插画,像素艺术,艺术创想,色彩主义,数字艺术','Injectable','onModuleInit','728QpNvOa','1353014JMITUp','DatabaseService','checkSiteBaseConfig','Midjourney','log','1847328kLmGun','专业绘画',']\x20==============>\x20请注意查阅','HttpException','createBaseMenuConfig','@nestjs/common','INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27','typeorm','fluent:draw-image-24-regular','创建默认网站配置失败！','\x27,\x200,\x201000,\x20100)','Logger','robotAvatar','firstRegisterSendRank','对话聊天','思维导图','isShow','123456','hashSync','46390ofRHMX','configVal','baiduCode','ri:message-3-line','map','admin','ant-design:appstore-outlined','count','configKey','INTERNAL_SERVER_ERROR','Market','\x27,\x20\x27','\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20(','应用广场','length','28420NNgngo','noticeInfo','super','2hTjVlf','model3Name','menuPlatform','decorate','insertId','基础绘画','replace','/chat','个人中心','join','openaiTimeout','初始化菜单配置成功','openaiBaseKey','registerSendStatus','/midjourney','/market','4584084YGqVaz','firstRregisterSendDrawMjCount','/user-center','/share','Pay','isVerifyEmail','绘画广场','checkSuperAdmin','defineProperty','createDefaultUser','firstRegisterSendStatus','model4Name','encry','icon-park-outline:shopping','ri:landscape-line','menuPath','registerSendModel3Count','593720dtpCpC','47289407vrJKvi','AppStore','Draw','Translate\x20any\x20given\x20phrase\x20from\x20any\x20language\x20into\x20English.\x20For\x20instance,\x20when\x20I\x20input\x20\x27{可爱的熊猫}\x27,\x20you\x20should\x20output\x20\x27{cute\x20panda}\x27,\x20with\x20no\x20period\x20at\x20the\x20end.','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27','siteName','300','初始化创建','Connection','推广计划','/pay','bcryptjs','error:\x20','创建默认超级管理员失败！'];_0x2dd7=function(){return _0x40cbc8;};return _0x2dd7();}const _0x33ce96=_0x1bcf;(function(_0x201eab,_0x37d668){const _0x516c73=_0x1bcf,_0x9988bc=_0x201eab();while(!![]){try{const _0x2be48c=parseInt(_0x516c73(0x1db))/0x1*(-parseInt(_0x516c73(0x234))/0x2)+-parseInt(_0x516c73(0x239))/0x3+parseInt(_0x516c73(0x233))/0x4*(-parseInt(_0x516c73(0x1c9))/0x5)+-parseInt(_0x516c73(0x1eb))/0x6+-parseInt(_0x516c73(0x221))/0x7*(-parseInt(_0x516c73(0x1fc))/0x8)+parseInt(_0x516c73(0x22a))/0x9*(parseInt(_0x516c73(0x1d8))/0xa)+parseInt(_0x516c73(0x1fd))/0xb;if(_0x2be48c===_0x37d668)break;else _0x9988bc['push'](_0x9988bc['shift']());}catch(_0x1f4d75){_0x9988bc['push'](_0x9988bc['shift']());}}}(_0x2dd7,0xd4840));var __decorate=this&&this['__decorate']||function(_0x83ba2b,_0x5d9f9c,_0x1c513d,_0x34d05d){const _0x39b906=_0x1bcf;var _0x2958b1=arguments[_0x39b906(0x1d7)],_0x5db86e=_0x2958b1<0x3?_0x5d9f9c:_0x34d05d===null?_0x34d05d=Object[_0x39b906(0x20e)](_0x5d9f9c,_0x1c513d):_0x34d05d,_0x253c70;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x39b906(0x224))_0x5db86e=Reflect[_0x39b906(0x1de)](_0x83ba2b,_0x5d9f9c,_0x1c513d,_0x34d05d);else{for(var _0x5f48d2=_0x83ba2b[_0x39b906(0x1d7)]-0x1;_0x5f48d2>=0x0;_0x5f48d2--)if(_0x253c70=_0x83ba2b[_0x5f48d2])_0x5db86e=(_0x2958b1<0x3?_0x253c70(_0x5db86e):_0x2958b1>0x3?_0x253c70(_0x5d9f9c,_0x1c513d,_0x5db86e):_0x253c70(_0x5d9f9c,_0x1c513d))||_0x5db86e;}return _0x2958b1>0x3&&_0x5db86e&&Object['defineProperty'](_0x5d9f9c,_0x1c513d,_0x5db86e),_0x5db86e;},__metadata=this&&this['__metadata']||function(_0x57eb07,_0x3ebac8){const _0x166da6=_0x1bcf;if(typeof Reflect==='object'&&typeof Reflect[_0x166da6(0x21e)]===_0x166da6(0x224))return Reflect[_0x166da6(0x21e)](_0x57eb07,_0x3ebac8);};Object[_0x33ce96(0x1f3)](exports,'__esModule',{'value':!![]}),exports[_0x33ce96(0x235)]=void 0x0;const common_1=require(_0x33ce96(0x1bb)),bcrypt=require(_0x33ce96(0x208)),typeorm_1=require(_0x33ce96(0x1bd));let DatabaseService=class DatabaseService{constructor(_0xf2084d){const _0x3a5983=_0x33ce96;this[_0x3a5983(0x229)]=_0xf2084d;}async[_0x33ce96(0x232)](){const _0x5c280d=_0x33ce96;await this[_0x5c280d(0x1f2)](),await this['checkSiteBaseConfig'](),await this[_0x5c280d(0x218)](),await this['checkGalleryConfig']();}async[_0x33ce96(0x1f2)](){const _0x1f4f24=_0x33ce96,_0x44430b=await this['connection'][_0x1f4f24(0x220)](_0x1f4f24(0x201));if(!_0x44430b||_0x44430b['length']===0x0){const _0x3125b9=bcrypt[_0x1f4f24(0x1c8)](_0x1f4f24(0x1c7),0xa),_0x43807e=bcrypt[_0x1f4f24(0x1c8)](_0x1f4f24(0x1c7),0xa),_0x13563e='super',_0x2f7213=_0x1f4f24(0x1ce),_0x3ce52a={'username':_0x1f4f24(0x1da),'password':_0x3125b9,'status':0x1,'email':_0x13563e,'sex':0x1,'role':_0x1f4f24(0x1da)},_0x29df68={'username':_0x1f4f24(0x1ce),'password':_0x43807e,'status':0x0,'email':_0x2f7213,'sex':0x1,'role':'admin'};await this[_0x1f4f24(0x1f4)](_0x3ce52a),await this[_0x1f4f24(0x1f4)](_0x29df68);}}async[_0x33ce96(0x1f4)](_0x448258){const _0x4f386d=_0x33ce96;try{const {username:_0x151e25,password:_0x280309,status:_0x1af64d,email:_0x5cd85c,role:_0x221aad}=_0x448258,_0x39f40b=await this['connection'][_0x4f386d(0x220)]('INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27'+_0x151e25+_0x4f386d(0x1d4)+_0x280309+'\x27,\x20\x27'+_0x1af64d+'\x27,\x20\x27'+_0x5cd85c+'\x27,\x20\x27'+_0x221aad+'\x27)'),_0x3aaac3=_0x39f40b[_0x4f386d(0x1df)];await this[_0x4f386d(0x229)][_0x4f386d(0x220)](_0x4f386d(0x1bc)+_0x3aaac3+_0x4f386d(0x1c0)),common_1[_0x4f386d(0x1c1)][_0x4f386d(0x238)](_0x4f386d(0x204)+_0x221aad+_0x4f386d(0x22c)+_0x151e25+']、初始密码为['+(_0x151e25===_0x4f386d(0x1da)?_0x4f386d(0x1da):_0x4f386d(0x1c7))+_0x4f386d(0x23b),_0x4f386d(0x235));}catch(_0xa593f5){console[_0x4f386d(0x238)](_0x4f386d(0x209),_0xa593f5);throw new common_1['HttpException'](_0x4f386d(0x20a),common_1[_0x4f386d(0x21a)][_0x4f386d(0x1d2)]);}}async[_0x33ce96(0x236)](){const _0x2d8b98=_0x33ce96,_0x477dc0=[_0x2d8b98(0x202),_0x2d8b98(0x1c2)],_0x1b729f=await this[_0x2d8b98(0x229)][_0x2d8b98(0x220)](_0x2d8b98(0x1d5)+_0x477dc0['map'](_0x6e224a=>'\x27'+_0x6e224a+'\x27')[_0x2d8b98(0x1e4)](',')+')\x0a'),_0x52bbda=parseInt(_0x1b729f[0x0]['count']);_0x52bbda===0x0&&await this[_0x2d8b98(0x20d)]();}async[_0x33ce96(0x20d)](){const _0x3737d0=_0x33ce96;try{const _0x3dfb6c='',_0x4acfc0=_0x3737d0(0x219),_0x271225=[{'configKey':_0x3737d0(0x202),'configVal':'','public':0x1,'encry':0x0},{'configKey':'robotAvatar','configVal':'','public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x225),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x3737d0(0x1cb),'configVal':_0x3dfb6c,'public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x20c),'configVal':'','public':0x0,'encry':0x0},{'configKey':'baiduToken','configVal':'','public':0x0,'encry':0x0},{'configKey':_0x3737d0(0x210),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x213),'configVal':'https://api.lightai.io','public':0x0,'encry':0x0},{'configKey':_0x3737d0(0x1e5),'configVal':_0x3737d0(0x203),'public':0x0,'encry':0x0},{'configKey':_0x3737d0(0x1e7),'configVal':'sk-','public':0x0,'encry':0x0},{'configKey':'mjTranslatePrompt','configVal':_0x3737d0(0x200),'public':0x0,'encry':0x0},{'configKey':_0x3737d0(0x1d9),'configVal':_0x4acfc0,'public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x1e8),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x1fb),'configVal':'30','public':0x1,'encry':0x0},{'configKey':'registerSendModel4Count','configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x228),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x1f5),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x1c3),'configVal':_0x3737d0(0x222),'public':0x1,'encry':0x0},{'configKey':'firstRregisterSendModel3Count','configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x21f),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x1ec),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x1f0),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x1dc),'configVal':_0x3737d0(0x22b),'public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x1f6),'configVal':_0x3737d0(0x214),'public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x215),'configVal':'绘画积分','public':0x1,'encry':0x0},{'configKey':_0x3737d0(0x22d),'configVal':_0x3737d0(0x230),'public':0x1,'encry':0x0}],_0x43090e=await this[_0x3737d0(0x229)][_0x3737d0(0x220)]('INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20'+_0x271225[_0x3737d0(0x1cd)](_0x22bf07=>'(\x27'+_0x22bf07[_0x3737d0(0x1d1)]+_0x3737d0(0x1d4)+_0x22bf07[_0x3737d0(0x1ca)][_0x3737d0(0x1e1)](/'/g,'\x5c\x27')+'\x27,\x20\x27'+_0x22bf07[_0x3737d0(0x226)]+_0x3737d0(0x1d4)+_0x22bf07[_0x3737d0(0x1f7)]+'\x27)')[_0x3737d0(0x1e4)](',\x20'));common_1['Logger'][_0x3737d0(0x238)](_0x3737d0(0x211),_0x3737d0(0x235));}catch(_0x46ee6d){console[_0x3737d0(0x238)](_0x3737d0(0x209),_0x46ee6d);throw new common_1[(_0x3737d0(0x23c))](_0x3737d0(0x1bf),common_1['HttpStatus'][_0x3737d0(0x1d2)]);}}async['checkMenuConfig'](){const _0x4d2442=_0x33ce96,_0x4965fe=await this[_0x4d2442(0x229)][_0x4d2442(0x220)](_0x4d2442(0x21b)),_0x576c5b=parseInt(_0x4965fe[0x0][_0x4d2442(0x1d0)]);_0x576c5b===0x0&&await this[_0x4d2442(0x23d)]();}async[_0x33ce96(0x23d)](){const _0x45e2aa=_0x33ce96;try{const _0x316096=[{'menuTipText':'对话聊天','menuIcon':_0x45e2aa(0x1cc),'menuName':'Chat','menuPath':_0x45e2aa(0x1e2),'menuType':0x0,'menuPlatform':0x1,'order':0x64,'isShow':!![]},{'menuTipText':_0x45e2aa(0x1d6),'menuIcon':_0x45e2aa(0x1cf),'menuName':_0x45e2aa(0x1fe),'menuPath':_0x45e2aa(0x22e),'menuType':0x0,'menuPlatform':0x1,'order':0xc8,'isShow':!![]},{'menuTipText':_0x45e2aa(0x23a),'menuIcon':_0x45e2aa(0x1f9),'menuName':_0x45e2aa(0x237),'menuPath':_0x45e2aa(0x1e9),'menuType':0x0,'menuPlatform':0x1,'order':0x12c,'isShow':!![]},{'menuTipText':_0x45e2aa(0x1f1),'menuIcon':'solar:album-line-duotone','menuName':_0x45e2aa(0x1d3),'menuPath':_0x45e2aa(0x1ea),'menuType':0x0,'menuPlatform':0x1,'order':0x190,'isShow':!![]},{'menuTipText':_0x45e2aa(0x1e0),'menuIcon':_0x45e2aa(0x1be),'menuName':_0x45e2aa(0x1ff),'menuPath':'/draw','menuType':0x0,'menuPlatform':0x1,'order':0x1f4,'isShow':!![]},{'menuTipText':'思维导图','menuIcon':_0x45e2aa(0x217),'menuName':_0x45e2aa(0x21c),'menuPath':_0x45e2aa(0x20f),'menuType':0x0,'menuPlatform':0x1,'order':0x258,'isShow':!![]},{'menuTipText':'会员中心','menuIcon':_0x45e2aa(0x1f8),'menuName':_0x45e2aa(0x1ef),'menuPath':_0x45e2aa(0x207),'menuType':0x0,'menuPlatform':0x1,'order':0x2bc,'isShow':!![]},{'menuTipText':_0x45e2aa(0x206),'menuIcon':_0x45e2aa(0x227),'menuName':_0x45e2aa(0x212),'menuPath':_0x45e2aa(0x1ee),'menuType':0x0,'menuPlatform':0x1,'order':0x320,'isShow':!![]}],_0x25d411=[{'menuTipText':_0x45e2aa(0x1c4),'menuIcon':_0x45e2aa(0x1cc),'menuName':'Chat','menuPath':_0x45e2aa(0x1e2),'menuType':0x0,'menuPlatform':0x0,'order':0x64,'isShow':!![]},{'menuTipText':'应用广场','menuIcon':_0x45e2aa(0x1cf),'menuName':_0x45e2aa(0x1fe),'menuPath':_0x45e2aa(0x22e),'menuType':0x0,'menuPlatform':0x0,'order':0xc8,'isShow':!![]},{'menuTipText':_0x45e2aa(0x23a),'menuIcon':_0x45e2aa(0x1f9),'menuName':_0x45e2aa(0x237),'menuPath':'/midjourney','menuType':0x0,'menuPlatform':0x0,'order':0x12c,'isShow':!![]},{'menuTipText':_0x45e2aa(0x1c5),'menuIcon':'icon-park-outline:mindmap-map','menuName':_0x45e2aa(0x21c),'menuPath':'/mind','menuType':0x0,'menuPlatform':0x0,'order':0x190,'isShow':!![]},{'menuTipText':_0x45e2aa(0x1e3),'menuIcon':_0x45e2aa(0x21d),'menuName':'UserCenter','menuPath':_0x45e2aa(0x1ed),'menuType':0x0,'menuPlatform':0x0,'order':0x1f4,'isShow':!![]}],_0x16b6e5=[..._0x316096,..._0x25d411];for(const _0x8b37d5 of _0x16b6e5){await this[_0x45e2aa(0x229)]['query'](_0x45e2aa(0x223),[_0x8b37d5['menuName'],_0x8b37d5[_0x45e2aa(0x1fa)],_0x8b37d5[_0x45e2aa(0x22f)],_0x8b37d5[_0x45e2aa(0x20b)],_0x8b37d5['menuType'],_0x8b37d5[_0x45e2aa(0x1dd)],null,_0x8b37d5[_0x45e2aa(0x216)],_0x8b37d5[_0x45e2aa(0x1c6)],![],![]]);}common_1[_0x45e2aa(0x1c1)]['log'](_0x45e2aa(0x1e6),'DatabaseService');}catch(_0x2f87ac){console[_0x45e2aa(0x238)](_0x45e2aa(0x209),_0x2f87ac);throw new common_1[(_0x45e2aa(0x23c))]('创建基础菜单配置失败！',common_1[_0x45e2aa(0x21a)][_0x45e2aa(0x1d2)]);}}async['checkGalleryConfig'](){}};DatabaseService=__decorate([(0x0,common_1[_0x33ce96(0x231)])(),__metadata('design:paramtypes',[typeorm_1[_0x33ce96(0x205)]])],DatabaseService),exports[_0x33ce96(0x235)]=DatabaseService;