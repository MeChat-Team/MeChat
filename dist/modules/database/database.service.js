'use strict';function _0x13ab(_0x338911,_0xd74a6d){const _0x51be3b=_0x51be();return _0x13ab=function(_0x13abe2,_0x234516){_0x13abe2=_0x13abe2-0xa0;let _0x4bd234=_0x51be3b[_0x13abe2];return _0x4bd234;},_0x13ab(_0x338911,_0xd74a6d);}const _0x1bdae6=_0x13ab;(function(_0x540805,_0x5b872b){const _0x74fa42=_0x13ab,_0x4a6bf8=_0x540805();while(!![]){try{const _0x314cab=parseInt(_0x74fa42(0xf8))/0x1+parseInt(_0x74fa42(0x10a))/0x2*(parseInt(_0x74fa42(0xf9))/0x3)+-parseInt(_0x74fa42(0xdf))/0x4+-parseInt(_0x74fa42(0xa5))/0x5+-parseInt(_0x74fa42(0xa9))/0x6*(parseInt(_0x74fa42(0xae))/0x7)+-parseInt(_0x74fa42(0xe9))/0x8*(parseInt(_0x74fa42(0xd9))/0x9)+parseInt(_0x74fa42(0xb1))/0xa;if(_0x314cab===_0x5b872b)break;else _0x4a6bf8['push'](_0x4a6bf8['shift']());}catch(_0x222b3d){_0x4a6bf8['push'](_0x4a6bf8['shift']());}}}(_0x51be,0x3c7a0));var __decorate=this&&this[_0x1bdae6(0xc7)]||function(_0x4e46f1,_0x2fbab7,_0x42efd3,_0x504cc5){const _0x450772=_0x1bdae6;var _0xb771c1=arguments[_0x450772(0xe6)],_0x3b6c2c=_0xb771c1<0x3?_0x2fbab7:_0x504cc5===null?_0x504cc5=Object[_0x450772(0x104)](_0x2fbab7,_0x42efd3):_0x504cc5,_0x46e8ac;if(typeof Reflect===_0x450772(0x118)&&typeof Reflect[_0x450772(0x107)]===_0x450772(0xf3))_0x3b6c2c=Reflect['decorate'](_0x4e46f1,_0x2fbab7,_0x42efd3,_0x504cc5);else{for(var _0x72fe76=_0x4e46f1['length']-0x1;_0x72fe76>=0x0;_0x72fe76--)if(_0x46e8ac=_0x4e46f1[_0x72fe76])_0x3b6c2c=(_0xb771c1<0x3?_0x46e8ac(_0x3b6c2c):_0xb771c1>0x3?_0x46e8ac(_0x2fbab7,_0x42efd3,_0x3b6c2c):_0x46e8ac(_0x2fbab7,_0x42efd3))||_0x3b6c2c;}return _0xb771c1>0x3&&_0x3b6c2c&&Object[_0x450772(0x115)](_0x2fbab7,_0x42efd3,_0x3b6c2c),_0x3b6c2c;},__metadata=this&&this[_0x1bdae6(0xf5)]||function(_0x25fb5c,_0xa29fa1){const _0x1d9cf6=_0x1bdae6;if(typeof Reflect===_0x1d9cf6(0x118)&&typeof Reflect[_0x1d9cf6(0xb9)]===_0x1d9cf6(0xf3))return Reflect[_0x1d9cf6(0xb9)](_0x25fb5c,_0xa29fa1);};Object[_0x1bdae6(0x115)](exports,'__esModule',{'value':!![]}),exports['DatabaseService']=void 0x0;function _0x51be(){const _0x8f6dac=['\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20(','error:\x20','8kzNrWo','order','Market','应用广场','join','Mind','encry','checkMenuConfig','icon-park-outline:mindmap-map','createDefaultUser','function','专业绘画','__metadata','bcryptjs','insertId','400938WnEQSh','1605ykxoKZ','INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27','connection','solar:album-line-duotone','用户成功、用户名为[','robotAvatar','createBaseSiteConfig','HttpStatus','baiduToken','123456','log','getOwnPropertyDescriptor','onModuleInit','INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27','decorate','query','public','330PxRCPr','super','\x27,\x200,\x201000,\x20100)','初始化创建','https://api.lightai.io','count','uiw:share','icon-park-outline:shopping','对话聊天','menuPath','SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20menu','defineProperty','INTERNAL_SERVER_ERROR','menuPlatform','object','isShow','/midjourney','siteName','Translate\x20any\x20given\x20phrase\x20from\x20any\x20language\x20into\x20English.\x20For\x20instance,\x20when\x20I\x20input\x20\x27{可爱的熊猫}\x27,\x20you\x20should\x20output\x20\x27{cute\x20panda}\x27,\x20with\x20no\x20period\x20at\x20the\x20end.','createBaseMenuConfig','思维导图','drawingStyles',']、初始密码为[','baiduSiteId','836540KSUbdG','个人中心','sk-','userDefautlAvatar','12FixbUg','Chat','\x27,\x20\x27','ri:message-3-line','hashSync','935347dnBWOP','HttpException','checkSiteBaseConfig','5286280kJiaRA','design:paramtypes','INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20','/mind','Draw','初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅','model4Name','/app-store','metadata','drawMjName','ri:account-pin-box-line','firstRegisterSendStatus','创建基础菜单配置失败！','ant-design:appstore-outlined','基础绘画','admin','/market','checkSuperAdmin','Midjourney','DatabaseService','menuIcon','noticeInfo','__decorate','checkGalleryConfig','@nestjs/common','map','创建默认超级管理员失败！','高级积分','Logger','configKey','model3Name','fluent:draw-image-24-regular','初始化菜单配置成功','openaiBaseUrl','绘画广场','/pay','replace','300','registerSendModel4Count','menuName','2156463uqQtFn','menuTipText',']\x20==============>\x20请注意查阅','isVerifyEmail','registerSendModel3Count','Share','383888uXMjGN','buyCramiAddress','UserCenter','油画风格,像素风格,赛博朋克,动漫,日系,超现实主义,油画,卡通,插画,海报,写实,扁平,中国风,水墨画,唯美二次元,印象派,炫彩插画,像素艺术,艺术创想,色彩主义,数字艺术','AppStore','\x0a####\x20AIWeb\x20欢迎您\x0a\x20-\x20欢迎使用\x20AIWeb\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a','registerSendDrawMjCount','length'];_0x51be=function(){return _0x8f6dac;};return _0x51be();}const common_1=require(_0x1bdae6(0xc9)),bcrypt=require(_0x1bdae6(0xf6)),typeorm_1=require('typeorm');let DatabaseService=class DatabaseService{constructor(_0x1f1524){const _0x452fb6=_0x1bdae6;this[_0x452fb6(0xfb)]=_0x1f1524;}async[_0x1bdae6(0x105)](){const _0x2b60b6=_0x1bdae6;await this['checkSuperAdmin'](),await this[_0x2b60b6(0xb0)](),await this[_0x2b60b6(0xf0)](),await this[_0x2b60b6(0xc8)]();}async[_0x1bdae6(0xc2)](){const _0x497bd7=_0x1bdae6,_0x2e224c=await this[_0x497bd7(0xfb)]['query']('SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27');if(!_0x2e224c||_0x2e224c[_0x497bd7(0xe6)]===0x0){const _0x12a600=bcrypt[_0x497bd7(0xad)](_0x497bd7(0x102),0xa),_0x343ba2=bcrypt[_0x497bd7(0xad)](_0x497bd7(0x102),0xa),_0x78401='super',_0x35cd9e=_0x497bd7(0xc0),_0x25e545={'username':_0x497bd7(0x10b),'password':_0x12a600,'status':0x1,'email':_0x78401,'sex':0x1,'role':_0x497bd7(0x10b)},_0x495fda={'username':_0x497bd7(0xc0),'password':_0x343ba2,'status':0x0,'email':_0x35cd9e,'sex':0x1,'role':_0x497bd7(0xc0)};await this[_0x497bd7(0xf2)](_0x25e545),await this[_0x497bd7(0xf2)](_0x495fda);}}async[_0x1bdae6(0xf2)](_0x1ce695){const _0x382169=_0x1bdae6;try{const {username:_0x4cc8b5,password:_0x36b02b,status:_0x25e996,email:_0x206e81,role:_0x4cc2cd}=_0x1ce695,_0x378e95=await this[_0x382169(0xfb)]['query'](_0x382169(0x106)+_0x4cc8b5+'\x27,\x20\x27'+_0x36b02b+_0x382169(0xab)+_0x25e996+_0x382169(0xab)+_0x206e81+_0x382169(0xab)+_0x4cc2cd+'\x27)'),_0x3c6b6e=_0x378e95[_0x382169(0xf7)];await this[_0x382169(0xfb)]['query'](_0x382169(0xfa)+_0x3c6b6e+_0x382169(0x10c)),common_1[_0x382169(0xcd)][_0x382169(0x103)](_0x382169(0x10d)+_0x4cc2cd+_0x382169(0xfd)+_0x4cc8b5+_0x382169(0xa3)+(_0x4cc8b5==='super'?'super':_0x382169(0x102))+_0x382169(0xdb),_0x382169(0xc4));}catch(_0x280db3){console['log'](_0x382169(0xe8),_0x280db3);throw new common_1['HttpException'](_0x382169(0xcb),common_1['HttpStatus'][_0x382169(0x116)]);}}async['checkSiteBaseConfig'](){const _0x2515a5=_0x1bdae6,_0x54df55=['siteName',_0x2515a5(0xfe)],_0x648cbd=await this[_0x2515a5(0xfb)][_0x2515a5(0x108)](_0x2515a5(0xe7)+_0x54df55['map'](_0xdf916e=>'\x27'+_0xdf916e+'\x27')[_0x2515a5(0xed)](',')+')\x0a'),_0x1e6774=parseInt(_0x648cbd[0x0]['count']);_0x1e6774===0x0&&await this['createBaseSiteConfig']();}async[_0x1bdae6(0xff)](){const _0xfb06d7=_0x1bdae6;try{const _0x28807d='',_0x9d30cb=_0xfb06d7(0xe4),_0x14f5d7=[{'configKey':_0xfb06d7(0x11b),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xfe),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xa8),'configVal':'','public':0x0,'encry':0x0},{'configKey':'baiduCode','configVal':_0x28807d,'public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xa4),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0xfb06d7(0x101),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0xfb06d7(0xe0),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xd2),'configVal':_0xfb06d7(0x10e),'public':0x0,'encry':0x0},{'configKey':'openaiTimeout','configVal':_0xfb06d7(0xd6),'public':0x0,'encry':0x0},{'configKey':'openaiBaseKey','configVal':_0xfb06d7(0xa7),'public':0x0,'encry':0x0},{'configKey':'mjTranslatePrompt','configVal':_0xfb06d7(0x11c),'public':0x0,'encry':0x0},{'configKey':_0xfb06d7(0xc6),'configVal':_0x9d30cb,'public':0x1,'encry':0x0},{'configKey':'registerSendStatus','configVal':'1','public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xdd),'configVal':'30','public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xd7),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xe5),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xbc),'configVal':'1','public':0x1,'encry':0x0},{'configKey':'firstRegisterSendRank','configVal':'500','public':0x1,'encry':0x0},{'configKey':'firstRregisterSendModel3Count','configVal':'10','public':0x1,'encry':0x0},{'configKey':'firstRregisterSendModel4Count','configVal':'10','public':0x1,'encry':0x0},{'configKey':'firstRregisterSendDrawMjCount','configVal':'10','public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xdc),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xcf),'configVal':'普通积分','public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xb7),'configVal':_0xfb06d7(0xcc),'public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xba),'configVal':'绘画积分','public':0x1,'encry':0x0},{'configKey':_0xfb06d7(0xa2),'configVal':_0xfb06d7(0xe2),'public':0x1,'encry':0x0}],_0x479f87=await this[_0xfb06d7(0xfb)]['query'](_0xfb06d7(0xb3)+_0x14f5d7[_0xfb06d7(0xca)](_0x445f90=>'(\x27'+_0x445f90[_0xfb06d7(0xce)]+'\x27,\x20\x27'+_0x445f90['configVal'][_0xfb06d7(0xd5)](/'/g,'\x5c\x27')+_0xfb06d7(0xab)+_0x445f90[_0xfb06d7(0x109)]+_0xfb06d7(0xab)+_0x445f90[_0xfb06d7(0xef)]+'\x27)')[_0xfb06d7(0xed)](',\x20'));common_1[_0xfb06d7(0xcd)][_0xfb06d7(0x103)](_0xfb06d7(0xb6),_0xfb06d7(0xc4));}catch(_0x3106d5){console['log']('error:\x20',_0x3106d5);throw new common_1[(_0xfb06d7(0xaf))]('创建默认网站配置失败！',common_1[_0xfb06d7(0x100)][_0xfb06d7(0x116)]);}}async[_0x1bdae6(0xf0)](){const _0x5cb9cf=_0x1bdae6,_0x335740=await this[_0x5cb9cf(0xfb)][_0x5cb9cf(0x108)](_0x5cb9cf(0x114)),_0x4994ac=parseInt(_0x335740[0x0][_0x5cb9cf(0x10f)]);_0x4994ac===0x0&&await this[_0x5cb9cf(0xa0)]();}async[_0x1bdae6(0xa0)](){const _0x3bb4ae=_0x1bdae6;try{const _0xe0193a=[{'menuTipText':_0x3bb4ae(0x112),'menuIcon':_0x3bb4ae(0xac),'menuName':_0x3bb4ae(0xaa),'menuPath':'/chat','menuType':0x0,'menuPlatform':0x1,'order':0x64,'isShow':!![]},{'menuTipText':_0x3bb4ae(0xec),'menuIcon':_0x3bb4ae(0xbe),'menuName':'AppStore','menuPath':_0x3bb4ae(0xb8),'menuType':0x0,'menuPlatform':0x1,'order':0xc8,'isShow':!![]},{'menuTipText':_0x3bb4ae(0xf4),'menuIcon':'ri:landscape-line','menuName':'Midjourney','menuPath':_0x3bb4ae(0x11a),'menuType':0x0,'menuPlatform':0x1,'order':0x12c,'isShow':!![]},{'menuTipText':_0x3bb4ae(0xd3),'menuIcon':_0x3bb4ae(0xfc),'menuName':_0x3bb4ae(0xeb),'menuPath':_0x3bb4ae(0xc1),'menuType':0x0,'menuPlatform':0x1,'order':0x190,'isShow':!![]},{'menuTipText':_0x3bb4ae(0xbf),'menuIcon':_0x3bb4ae(0xd0),'menuName':_0x3bb4ae(0xb5),'menuPath':'/draw','menuType':0x0,'menuPlatform':0x1,'order':0x1f4,'isShow':!![]},{'menuTipText':_0x3bb4ae(0xa1),'menuIcon':_0x3bb4ae(0xf1),'menuName':_0x3bb4ae(0xee),'menuPath':_0x3bb4ae(0xb4),'menuType':0x0,'menuPlatform':0x1,'order':0x258,'isShow':!![]},{'menuTipText':'会员中心','menuIcon':_0x3bb4ae(0x111),'menuName':'Pay','menuPath':_0x3bb4ae(0xd4),'menuType':0x0,'menuPlatform':0x1,'order':0x2bc,'isShow':!![]},{'menuTipText':'推广计划','menuIcon':_0x3bb4ae(0x110),'menuName':_0x3bb4ae(0xde),'menuPath':'/share','menuType':0x0,'menuPlatform':0x1,'order':0x320,'isShow':!![]}],_0x5bee3a=[{'menuTipText':_0x3bb4ae(0x112),'menuIcon':_0x3bb4ae(0xac),'menuName':_0x3bb4ae(0xaa),'menuPath':'/chat','menuType':0x0,'menuPlatform':0x0,'order':0x64,'isShow':!![]},{'menuTipText':_0x3bb4ae(0xec),'menuIcon':_0x3bb4ae(0xbe),'menuName':_0x3bb4ae(0xe3),'menuPath':'/app-store','menuType':0x0,'menuPlatform':0x0,'order':0xc8,'isShow':!![]},{'menuTipText':_0x3bb4ae(0xf4),'menuIcon':'ri:landscape-line','menuName':_0x3bb4ae(0xc3),'menuPath':_0x3bb4ae(0x11a),'menuType':0x0,'menuPlatform':0x0,'order':0x12c,'isShow':!![]},{'menuTipText':_0x3bb4ae(0xa1),'menuIcon':_0x3bb4ae(0xf1),'menuName':_0x3bb4ae(0xee),'menuPath':_0x3bb4ae(0xb4),'menuType':0x0,'menuPlatform':0x0,'order':0x190,'isShow':!![]},{'menuTipText':_0x3bb4ae(0xa6),'menuIcon':_0x3bb4ae(0xbb),'menuName':_0x3bb4ae(0xe1),'menuPath':'/user-center','menuType':0x0,'menuPlatform':0x0,'order':0x1f4,'isShow':!![]}],_0x2853ce=[..._0xe0193a,..._0x5bee3a];for(const _0xef1782 of _0x2853ce){await this[_0x3bb4ae(0xfb)][_0x3bb4ae(0x108)]('INSERT\x20INTO\x20menu\x20(menuName,\x20menuPath,\x20menuIcon,\x20menuTipText,\x20menuType,\x20menuPlatform,\x20menuIframeUrl,\x20`order`,\x20isShow,\x20isJump,\x20isNeedAuth,\x20createdAt,\x20updatedAt,\x20deletedAt)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20NOW(),\x20NOW(),\x20NULL)',[_0xef1782[_0x3bb4ae(0xd8)],_0xef1782[_0x3bb4ae(0x113)],_0xef1782[_0x3bb4ae(0xc5)],_0xef1782[_0x3bb4ae(0xda)],_0xef1782['menuType'],_0xef1782[_0x3bb4ae(0x117)],null,_0xef1782[_0x3bb4ae(0xea)],_0xef1782[_0x3bb4ae(0x119)],![],![]]);}common_1[_0x3bb4ae(0xcd)]['log'](_0x3bb4ae(0xd1),'DatabaseService');}catch(_0x92c0e0){console[_0x3bb4ae(0x103)](_0x3bb4ae(0xe8),_0x92c0e0);throw new common_1['HttpException'](_0x3bb4ae(0xbd),common_1[_0x3bb4ae(0x100)][_0x3bb4ae(0x116)]);}}async[_0x1bdae6(0xc8)](){}};DatabaseService=__decorate([(0x0,common_1['Injectable'])(),__metadata(_0x1bdae6(0xb2),[typeorm_1['Connection']])],DatabaseService),exports['DatabaseService']=DatabaseService;