'use strict';const _0x16aa0b=_0x4c69;(function(_0x9e9f16,_0x2883b5){const _0x46e0f9=_0x4c69,_0x257258=_0x9e9f16();while(!![]){try{const _0xea8acb=parseInt(_0x46e0f9(0xe8))/0x1*(parseInt(_0x46e0f9(0x108))/0x2)+parseInt(_0x46e0f9(0xfc))/0x3*(parseInt(_0x46e0f9(0x12a))/0x4)+parseInt(_0x46e0f9(0x107))/0x5*(-parseInt(_0x46e0f9(0xf8))/0x6)+parseInt(_0x46e0f9(0xff))/0x7+parseInt(_0x46e0f9(0x119))/0x8*(-parseInt(_0x46e0f9(0x12d))/0x9)+-parseInt(_0x46e0f9(0xf6))/0xa+parseInt(_0x46e0f9(0x118))/0xb;if(_0xea8acb===_0x2883b5)break;else _0x257258['push'](_0x257258['shift']());}catch(_0x5a89b8){_0x257258['push'](_0x257258['shift']());}}}(_0x1700,0xb0544));var __decorate=this&&this['__decorate']||function(_0x593cf2,_0x3a7d3b,_0x4bf33a,_0x1becf8){const _0x556b43=_0x4c69;var _0x1c0347=arguments[_0x556b43(0xe3)],_0x30328b=_0x1c0347<0x3?_0x3a7d3b:_0x1becf8===null?_0x1becf8=Object['getOwnPropertyDescriptor'](_0x3a7d3b,_0x4bf33a):_0x1becf8,_0x43ff00;if(typeof Reflect===_0x556b43(0xd9)&&typeof Reflect[_0x556b43(0x130)]===_0x556b43(0x125))_0x30328b=Reflect[_0x556b43(0x130)](_0x593cf2,_0x3a7d3b,_0x4bf33a,_0x1becf8);else{for(var _0x403de1=_0x593cf2[_0x556b43(0xe3)]-0x1;_0x403de1>=0x0;_0x403de1--)if(_0x43ff00=_0x593cf2[_0x403de1])_0x30328b=(_0x1c0347<0x3?_0x43ff00(_0x30328b):_0x1c0347>0x3?_0x43ff00(_0x3a7d3b,_0x4bf33a,_0x30328b):_0x43ff00(_0x3a7d3b,_0x4bf33a))||_0x30328b;}return _0x1c0347>0x3&&_0x30328b&&Object[_0x556b43(0xfa)](_0x3a7d3b,_0x4bf33a,_0x30328b),_0x30328b;},__metadata=this&&this[_0x16aa0b(0xec)]||function(_0x2f6f39,_0x5b08f3){const _0x5c9799=_0x16aa0b;if(typeof Reflect===_0x5c9799(0xd9)&&typeof Reflect[_0x5c9799(0x112)]===_0x5c9799(0x125))return Reflect[_0x5c9799(0x112)](_0x2f6f39,_0x5b08f3);};function _0x4c69(_0x4fc1af,_0x521dbd){const _0x17002b=_0x1700();return _0x4c69=function(_0x4c698e,_0x579ac9){_0x4c698e=_0x4c698e-0xc9;let _0x36ab08=_0x17002b[_0x4c698e];return _0x36ab08;},_0x4c69(_0x4fc1af,_0x521dbd);}Object[_0x16aa0b(0xfa)](exports,_0x16aa0b(0x137),{'value':!![]}),exports[_0x16aa0b(0xef)]=void 0x0;const common_1=require(_0x16aa0b(0x10d)),bcrypt=require(_0x16aa0b(0x120)),typeorm_1=require(_0x16aa0b(0x139));let DatabaseService=class DatabaseService{constructor(_0x97280f){this['connection']=_0x97280f;}async['onModuleInit'](){const _0x505461=_0x16aa0b;await this[_0x505461(0x132)](),await this[_0x505461(0x103)](),await this[_0x505461(0xce)](),await this[_0x505461(0x101)]();}async['checkSuperAdmin'](){const _0x32e2c2=_0x16aa0b,_0xad793d=await this[_0x32e2c2(0xdf)][_0x32e2c2(0xe6)]('SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27');if(!_0xad793d||_0xad793d[_0x32e2c2(0xe3)]===0x0){const _0x26dc53=bcrypt[_0x32e2c2(0x12e)](_0x32e2c2(0x135),0xa),_0x996c96=bcrypt[_0x32e2c2(0x12e)](_0x32e2c2(0x135),0xa),_0x3b7836='super',_0x16cdf3='admin',_0x469531={'username':_0x32e2c2(0xd6),'password':_0x26dc53,'status':0x1,'email':_0x3b7836,'sex':0x1,'role':'super'},_0x5de243={'username':_0x32e2c2(0xfe),'password':_0x996c96,'status':0x0,'email':_0x16cdf3,'sex':0x1,'role':'admin'};await this[_0x32e2c2(0x113)](_0x469531),await this[_0x32e2c2(0x113)](_0x5de243);}}async['createDefaultUser'](_0x2d5641){const _0x53feee=_0x16aa0b;try{const {username:_0x3c532f,password:_0xb19192,status:_0x12fdfc,email:_0x395f2d,role:_0x40e508}=_0x2d5641,_0x1f84d5=await this[_0x53feee(0xdf)][_0x53feee(0xe6)](_0x53feee(0xea)+_0x3c532f+_0x53feee(0x128)+_0xb19192+'\x27,\x20\x27'+_0x12fdfc+_0x53feee(0x128)+_0x395f2d+_0x53feee(0x128)+_0x40e508+'\x27)'),_0x388794=_0x1f84d5['insertId'];await this[_0x53feee(0xdf)][_0x53feee(0xe6)](_0x53feee(0xdd)+_0x388794+_0x53feee(0xee)),common_1[_0x53feee(0x12b)][_0x53feee(0xe5)](_0x53feee(0x10f)+_0x40e508+_0x53feee(0x124)+_0x3c532f+_0x53feee(0xd0)+(_0x3c532f===_0x53feee(0xd6)?'super':_0x53feee(0x135))+_0x53feee(0x117),_0x53feee(0xef));}catch(_0x56abae){console[_0x53feee(0xe5)](_0x53feee(0x115),_0x56abae);throw new common_1[(_0x53feee(0xcb))](_0x53feee(0xcd),common_1[_0x53feee(0x114)]['INTERNAL_SERVER_ERROR']);}}async[_0x16aa0b(0x103)](){const _0x5ab77e=_0x16aa0b,_0x25b927=[_0x5ab77e(0x11c),_0x5ab77e(0xfd)],_0x3237ca=await this[_0x5ab77e(0xdf)][_0x5ab77e(0xe6)](_0x5ab77e(0xed)+_0x25b927['map'](_0x3b160b=>'\x27'+_0x3b160b+'\x27')[_0x5ab77e(0xd8)](',')+')\x0a'),_0x53034f=parseInt(_0x3237ca[0x0][_0x5ab77e(0x13b)]);_0x53034f===0x0&&await this['createBaseSiteConfig']();}async[_0x16aa0b(0x136)](){const _0x60ae72=_0x16aa0b;try{const _0x32f340='',_0x28165e=_0x60ae72(0xe7),_0x2a4d1f=[{'configKey':_0x60ae72(0x11c),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x60ae72(0xfd),'configVal':'','public':0x1,'encry':0x0},{'configKey':'userDefautlAvatar','configVal':'','public':0x0,'encry':0x0},{'configKey':_0x60ae72(0xd3),'configVal':_0x32f340,'public':0x1,'encry':0x0},{'configKey':_0x60ae72(0x138),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x60ae72(0xf2),'configVal':'','public':0x0,'encry':0x0},{'configKey':'buyCramiAddress','configVal':'','public':0x1,'encry':0x0},{'configKey':_0x60ae72(0x133),'configVal':_0x60ae72(0x110),'public':0x0,'encry':0x0},{'configKey':_0x60ae72(0xd1),'configVal':_0x60ae72(0x121),'public':0x0,'encry':0x0},{'configKey':'openaiBaseKey','configVal':_0x60ae72(0x13a),'public':0x0,'encry':0x0},{'configKey':'mjTranslatePrompt','configVal':_0x60ae72(0x109),'public':0x0,'encry':0x0},{'configKey':'noticeInfo','configVal':_0x28165e,'public':0x1,'encry':0x0},{'configKey':'registerSendStatus','configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x60ae72(0xe2),'configVal':'30','public':0x1,'encry':0x0},{'configKey':_0x60ae72(0xe0),'configVal':'3','public':0x1,'encry':0x0},{'configKey':'registerSendDrawMjCount','configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x60ae72(0x12f),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x60ae72(0x129),'configVal':'500','public':0x1,'encry':0x0},{'configKey':_0x60ae72(0x134),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x60ae72(0xfb),'configVal':'10','public':0x1,'encry':0x0},{'configKey':'firstRregisterSendDrawMjCount','configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x60ae72(0x13d),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x60ae72(0x105),'configVal':_0x60ae72(0xe4),'public':0x1,'encry':0x0},{'configKey':_0x60ae72(0xf4),'configVal':'高级积分','public':0x1,'encry':0x0},{'configKey':_0x60ae72(0x11b),'configVal':'绘画积分','public':0x1,'encry':0x0},{'configKey':'drawingStyles','configVal':_0x60ae72(0xeb),'public':0x1,'encry':0x0}],_0xde8d35=await this[_0x60ae72(0xdf)][_0x60ae72(0xe6)](_0x60ae72(0x11a)+_0x2a4d1f['map'](_0x5adfb4=>'(\x27'+_0x5adfb4[_0x60ae72(0xd7)]+_0x60ae72(0x128)+_0x5adfb4['configVal'][_0x60ae72(0xca)](/'/g,'\x5c\x27')+_0x60ae72(0x128)+_0x5adfb4[_0x60ae72(0xdc)]+_0x60ae72(0x128)+_0x5adfb4['encry']+'\x27)')['join'](',\x20'));common_1[_0x60ae72(0x12b)][_0x60ae72(0xe5)]('初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅',_0x60ae72(0xef));}catch(_0x5869d4){console[_0x60ae72(0xe5)]('error:\x20',_0x5869d4);throw new common_1['HttpException'](_0x60ae72(0xf3),common_1[_0x60ae72(0x114)][_0x60ae72(0x123)]);}}async[_0x16aa0b(0xce)](){const _0x97cb87=_0x16aa0b,_0x43e6c4=await this[_0x97cb87(0xdf)][_0x97cb87(0xe6)]('SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20menu'),_0x2b0885=parseInt(_0x43e6c4[0x0][_0x97cb87(0x13b)]);_0x2b0885===0x0&&await this[_0x97cb87(0xde)]();}async[_0x16aa0b(0xde)](){const _0x2908f6=_0x16aa0b;try{const _0x31d0b6=[{'menuTipText':_0x2908f6(0x104),'menuIcon':_0x2908f6(0x11e),'menuName':_0x2908f6(0xf0),'menuPath':_0x2908f6(0xe1),'menuType':0x0,'menuPlatform':0x1,'order':0x64,'isShow':!![]},{'menuTipText':_0x2908f6(0x111),'menuIcon':_0x2908f6(0xd5),'menuName':_0x2908f6(0xf1),'menuPath':_0x2908f6(0x13c),'menuType':0x0,'menuPlatform':0x1,'order':0xc8,'isShow':!![]},{'menuTipText':'专业绘画','menuIcon':_0x2908f6(0x12c),'menuName':_0x2908f6(0xf7),'menuPath':_0x2908f6(0xf9),'menuType':0x0,'menuPlatform':0x1,'order':0x12c,'isShow':!![]},{'menuTipText':_0x2908f6(0x10b),'menuIcon':'solar:album-line-duotone','menuName':_0x2908f6(0x100),'menuPath':'/market','menuType':0x0,'menuPlatform':0x1,'order':0x190,'isShow':!![]},{'menuTipText':_0x2908f6(0x127),'menuIcon':_0x2908f6(0xe9),'menuName':_0x2908f6(0x10e),'menuPath':'/draw','menuType':0x0,'menuPlatform':0x1,'order':0x1f4,'isShow':!![]},{'menuTipText':'思维导图','menuIcon':_0x2908f6(0x122),'menuName':_0x2908f6(0x10a),'menuPath':_0x2908f6(0x126),'menuType':0x0,'menuPlatform':0x1,'order':0x258,'isShow':!![]},{'menuTipText':_0x2908f6(0xd2),'menuIcon':'icon-park-outline:shopping','menuName':_0x2908f6(0xcc),'menuPath':'/pay','menuType':0x0,'menuPlatform':0x1,'order':0x2bc,'isShow':!![]},{'menuTipText':_0x2908f6(0x131),'menuIcon':_0x2908f6(0xdb),'menuName':_0x2908f6(0xc9),'menuPath':_0x2908f6(0xcf),'menuType':0x0,'menuPlatform':0x1,'order':0x320,'isShow':!![]}],_0x12d736=[{'menuTipText':'对话聊天','menuIcon':'ri:message-3-line','menuName':_0x2908f6(0xf0),'menuPath':_0x2908f6(0xe1),'menuType':0x0,'menuPlatform':0x0,'order':0x64,'isShow':!![]},{'menuTipText':_0x2908f6(0x111),'menuIcon':_0x2908f6(0xd5),'menuName':_0x2908f6(0xf1),'menuPath':_0x2908f6(0x13c),'menuType':0x0,'menuPlatform':0x0,'order':0xc8,'isShow':!![]},{'menuTipText':'专业绘画','menuIcon':'ri:landscape-line','menuName':_0x2908f6(0xf7),'menuPath':'/midjourney','menuType':0x0,'menuPlatform':0x0,'order':0x12c,'isShow':!![]},{'menuTipText':_0x2908f6(0x116),'menuIcon':_0x2908f6(0x122),'menuName':'Mind','menuPath':'/mind','menuType':0x0,'menuPlatform':0x0,'order':0x190,'isShow':!![]},{'menuTipText':_0x2908f6(0xda),'menuIcon':'ri:account-pin-box-line','menuName':'UserCenter','menuPath':'/user-center','menuType':0x0,'menuPlatform':0x0,'order':0x1f4,'isShow':!![]}],_0x4573f3=[..._0x31d0b6,..._0x12d736];for(const _0x51ca96 of _0x4573f3){await this['connection'][_0x2908f6(0xe6)]('INSERT\x20INTO\x20menu\x20(menuName,\x20menuPath,\x20menuIcon,\x20menuTipText,\x20menuType,\x20menuPlatform,\x20menuIframeUrl,\x20`order`,\x20isShow,\x20isJump,\x20isNeedAuth,\x20createdAt,\x20updatedAt,\x20deletedAt)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20NOW(),\x20NOW(),\x20NULL)',[_0x51ca96[_0x2908f6(0x102)],_0x51ca96[_0x2908f6(0xf5)],_0x51ca96[_0x2908f6(0x11f)],_0x51ca96['menuTipText'],_0x51ca96[_0x2908f6(0x10c)],_0x51ca96[_0x2908f6(0x11d)],null,_0x51ca96['order'],_0x51ca96[_0x2908f6(0xd4)],![],![]]);}common_1[_0x2908f6(0x12b)][_0x2908f6(0xe5)]('初始化菜单配置成功',_0x2908f6(0xef));}catch(_0x5daa74){console[_0x2908f6(0xe5)]('error:\x20',_0x5daa74);throw new common_1[(_0x2908f6(0xcb))](_0x2908f6(0x106),common_1[_0x2908f6(0x114)][_0x2908f6(0x123)]);}}async[_0x16aa0b(0x101)](){}};DatabaseService=__decorate([(0x0,common_1['Injectable'])(),__metadata('design:paramtypes',[typeorm_1['Connection']])],DatabaseService),exports[_0x16aa0b(0xef)]=DatabaseService;function _0x1700(){const _0x3944c4=['Pay','创建默认超级管理员失败！','checkMenuConfig','/share',']、初始密码为[','openaiTimeout','会员中心','baiduCode','isShow','ant-design:appstore-outlined','super','configKey','join','object','个人中心','uiw:share','public','INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27','createBaseMenuConfig','connection','registerSendModel4Count','/chat','registerSendModel3Count','length','普通积分','log','query','\x0a####\x20AIWeb\x20欢迎您\x0a\x20-\x20欢迎使用\x20AIWeb\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a','2FyjrQt','fluent:draw-image-24-regular','INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27','油画风格,像素风格,赛博朋克,动漫,日系,超现实主义,油画,卡通,插画,海报,写实,扁平,中国风,水墨画,唯美二次元,印象派,炫彩插画,像素艺术,艺术创想,色彩主义,数字艺术','__metadata','\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20(','\x27,\x200,\x201000,\x20100)','DatabaseService','Chat','AppStore','baiduToken','创建默认网站配置失败！','model4Name','menuPath','3365020iBhcMR','Midjourney','649956bthByg','/midjourney','defineProperty','firstRregisterSendModel4Count','951000yxEHJK','robotAvatar','admin','493528sGlLfY','Market','checkGalleryConfig','menuName','checkSiteBaseConfig','对话聊天','model3Name','创建基础菜单配置失败！','60DnkJew','675478XxAPyp','Translate\x20any\x20given\x20phrase\x20from\x20any\x20language\x20into\x20English.\x20For\x20instance,\x20when\x20I\x20input\x20\x27{可爱的熊猫}\x27,\x20you\x20should\x20output\x20\x27{cute\x20panda}\x27,\x20with\x20no\x20period\x20at\x20the\x20end.','Mind','绘画广场','menuType','@nestjs/common','Draw','初始化创建','https://api.lightai.io','应用广场','metadata','createDefaultUser','HttpStatus','error:\x20','思维导图',']\x20==============>\x20请注意查阅','22904607brmXYu','8pWBPIV','INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20','drawMjName','siteName','menuPlatform','ri:message-3-line','menuIcon','bcryptjs','300','icon-park-outline:mindmap-map','INTERNAL_SERVER_ERROR','用户成功、用户名为[','function','/mind','基础绘画','\x27,\x20\x27','firstRegisterSendRank','8oSYaEU','Logger','ri:landscape-line','9932049owvlTs','hashSync','firstRegisterSendStatus','decorate','推广计划','checkSuperAdmin','openaiBaseUrl','firstRregisterSendModel3Count','123456','createBaseSiteConfig','__esModule','baiduSiteId','typeorm','sk-','count','/app-store','isVerifyEmail','Share','replace','HttpException'];_0x1700=function(){return _0x3944c4;};return _0x1700();}