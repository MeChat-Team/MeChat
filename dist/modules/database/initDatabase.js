'use strict';const _0x3ef213=_0x1bbc;(function(_0x6f6c08,_0x9a165f){const _0x5fcda2=_0x1bbc,_0x560415=_0x6f6c08();while(!![]){try{const _0x16f592=-parseInt(_0x5fcda2(0x1a0))/0x1*(-parseInt(_0x5fcda2(0x1a3))/0x2)+parseInt(_0x5fcda2(0x17c))/0x3+parseInt(_0x5fcda2(0x19c))/0x4+parseInt(_0x5fcda2(0x175))/0x5*(-parseInt(_0x5fcda2(0x18c))/0x6)+parseInt(_0x5fcda2(0x188))/0x7*(parseInt(_0x5fcda2(0x1a4))/0x8)+parseInt(_0x5fcda2(0x17e))/0x9*(-parseInt(_0x5fcda2(0x18f))/0xa)+-parseInt(_0x5fcda2(0x184))/0xb;if(_0x16f592===_0x9a165f)break;else _0x560415['push'](_0x560415['shift']());}catch(_0x54b06c){_0x560415['push'](_0x560415['shift']());}}}(_0x4548,0x1bec1));Object['defineProperty'](exports,_0x3ef213(0x195),{'value':!![]}),exports[_0x3ef213(0x190)]=void 0x0;const common_1=require(_0x3ef213(0x19d)),dotenv_1=require(_0x3ef213(0x193)),mysql=require('mysql2/promise'),typeorm_1=require(_0x3ef213(0x1a2));(0x0,dotenv_1[_0x3ef213(0x177)])();const dataSourceOptions={'type':'mysql','port':parseInt(process[_0x3ef213(0x179)]['DB_PORT'],0xa),'host':process[_0x3ef213(0x179)][_0x3ef213(0x197)],'username':process[_0x3ef213(0x179)][_0x3ef213(0x18d)],'password':process[_0x3ef213(0x179)][_0x3ef213(0x185)],'database':process[_0x3ef213(0x179)][_0x3ef213(0x198)],'entities':[__dirname+_0x3ef213(0x19e)],'logging':![],'synchronize':!![],'charset':_0x3ef213(0x17f),'timezone':_0x3ef213(0x191)};function _0x1bbc(_0x38bb4b,_0x43b1ab){const _0x454861=_0x4548();return _0x1bbc=function(_0x1bbc32,_0x4f5ee5){_0x1bbc32=_0x1bbc32-0x175;let _0x1fc334=_0x454861[_0x1bbc32];return _0x1fc334;},_0x1bbc(_0x38bb4b,_0x43b1ab);}async function validateDatabase(){const _0x238173=_0x3ef213,_0x243997=await mysql['createConnection']({'host':process[_0x238173(0x179)][_0x238173(0x197)],'user':process[_0x238173(0x179)][_0x238173(0x18d)],'password':process[_0x238173(0x179)][_0x238173(0x185)],'port':parseInt(process['env'][_0x238173(0x178)],0xa)});try{const [_0x31ea7c]=await _0x243997[_0x238173(0x1a5)](_0x238173(0x186)+process[_0x238173(0x179)][_0x238173(0x198)]+'\x27');Array[_0x238173(0x17d)](_0x31ea7c)&&_0x31ea7c[_0x238173(0x192)]===0x0?(await _0x243997[_0x238173(0x1a5)](_0x238173(0x194)+process[_0x238173(0x179)][_0x238173(0x198)]),common_1[_0x238173(0x19f)]['log'](_0x238173(0x1a1)+process[_0x238173(0x179)]['DB_DATABASE']+']',_0x238173(0x17b))):common_1['Logger'][_0x238173(0x180)](_0x238173(0x182)+process[_0x238173(0x179)]['DB_DATABASE']+']',_0x238173(0x17b));}catch(_0x5d8d0d){common_1[_0x238173(0x19f)][_0x238173(0x18e)]('Error\x20during\x20database\x20validation:',_0x5d8d0d,_0x238173(0x17b));}finally{await _0x243997[_0x238173(0x18b)]();}}async function updateColumnType(){const _0xee1578=_0x3ef213,_0x569081=await mysql['createConnection']({'host':process[_0xee1578(0x179)]['DB_HOST'],'user':process[_0xee1578(0x179)]['DB_USER'],'password':process[_0xee1578(0x179)][_0xee1578(0x185)],'port':parseInt(process['env'][_0xee1578(0x178)],0xa),'database':process['env'][_0xee1578(0x198)]});async function _0x3dcb99(_0x307b4b,_0x3f38a2){const _0x3d09d3=_0xee1578;try{const [_0x33560b]=await _0x569081[_0x3d09d3(0x1a5)](_0x3d09d3(0x183),[_0x307b4b,_0x3f38a2]);_0x33560b[_0x3d09d3(0x192)]>0x0&&_0x33560b[0x0][_0x3d09d3(0x176)]!==_0x3d09d3(0x17a)?(await _0x569081['execute'](_0x3d09d3(0x19b),[_0x307b4b,_0x3f38a2]),common_1[_0x3d09d3(0x19f)]['log'](_0x3d09d3(0x19a)+_0x3f38a2+_0x3d09d3(0x181)+_0x307b4b,_0x3d09d3(0x17b))):common_1[_0x3d09d3(0x19f)][_0x3d09d3(0x180)](_0x3d09d3(0x19a)+_0x3f38a2+'\x20is\x20already\x20of\x20type\x20TEXT\x20in\x20table\x20'+_0x307b4b,_0x3d09d3(0x17b));}catch(_0x140955){common_1[_0x3d09d3(0x19f)][_0x3d09d3(0x18e)]('Error\x20updating\x20column\x20type\x20in\x20table\x20'+_0x307b4b+':',_0x140955);}}try{await _0x3dcb99(_0xee1578(0x177),'configVal'),await _0x3dcb99(_0xee1578(0x18a),'coverImg');}finally{await _0x569081[_0xee1578(0x18b)]();}}async function initDatabase(){const _0x15d613=_0x3ef213;await validateDatabase(),await updateColumnType();const _0x5bb5ac=new typeorm_1['DataSource'](dataSourceOptions);try{await _0x5bb5ac[_0x15d613(0x187)](),common_1['Logger']['log'](_0x15d613(0x196),'Database');}catch(_0x27e97a){common_1[_0x15d613(0x19f)]['error'](_0x15d613(0x199),_0x27e97a);}finally{await _0x5bb5ac[_0x15d613(0x189)]();}}exports['initDatabase']=initDatabase;function _0x4548(){const _0x25e739=['typeorm','2IdHkYZ','8InAmwi','execute','1088095FqKshW','DATA_TYPE','config','DB_PORT','env','text','Database','105696vzPoVY','isArray','98019UbOfyB','utf8mb4','log','\x20type\x20updated\x20to\x20TEXT\x20in\x20table\x20','数据库已存在[','SELECT\x20COLUMN_NAME,\x20DATA_TYPE\x20FROM\x20INFORMATION_SCHEMA.COLUMNS\x20WHERE\x20TABLE_NAME\x20=\x20?\x20AND\x20COLUMN_NAME\x20=\x20?','629772lXuuEo','DB_PASS','SHOW\x20DATABASES\x20LIKE\x20\x27','initialize','863058OxbqCr','destroy','app','end','6pAkNPp','DB_USER','error','10BcpALr','initDatabase','+08:00','length','dotenv','CREATE\x20DATABASE\x20','__esModule','Database\x20connected\x20and\x20synchronized\x20successfully','DB_HOST','DB_DATABASE','Error\x20during\x20TypeORM\x20initialization:','Column\x20','ALTER\x20TABLE\x20??\x20MODIFY\x20COLUMN\x20??\x20TEXT','736568UTsagV','@nestjs/common','/../**/*.entity{.ts,.js}','Logger','57463TcoRQt','数据库创建成功['];_0x4548=function(){return _0x25e739;};return _0x4548();}