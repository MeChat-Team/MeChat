'use strict';const _0x386d2a=_0x42b6;(function(_0x3e3acc,_0x37a79c){const _0x41cfaf=_0x42b6,_0x3306f3=_0x3e3acc();while(!![]){try{const _0x3e1f72=-parseInt(_0x41cfaf(0x189))/0x1+-parseInt(_0x41cfaf(0x196))/0x2+-parseInt(_0x41cfaf(0x18f))/0x3*(parseInt(_0x41cfaf(0x187))/0x4)+-parseInt(_0x41cfaf(0x18e))/0x5+parseInt(_0x41cfaf(0x1ad))/0x6+parseInt(_0x41cfaf(0x19f))/0x7*(parseInt(_0x41cfaf(0x18c))/0x8)+parseInt(_0x41cfaf(0x1a5))/0x9;if(_0x3e1f72===_0x37a79c)break;else _0x3306f3['push'](_0x3306f3['shift']());}catch(_0x6a0daf){_0x3306f3['push'](_0x3306f3['shift']());}}}(_0x6d34,0x4bbdb));function _0x42b6(_0x4d5fc2,_0x2ed44c){const _0x6d340d=_0x6d34();return _0x42b6=function(_0x42b6cc,_0x463cfb){_0x42b6cc=_0x42b6cc-0x184;let _0x4a3bdf=_0x6d340d[_0x42b6cc];return _0x4a3bdf;},_0x42b6(_0x4d5fc2,_0x2ed44c);}var __decorate=this&&this[_0x386d2a(0x1a1)]||function(_0x48cdfb,_0x2a7744,_0x7ddcd7,_0x3c2c6e){const _0x597c9c=_0x386d2a;var _0x45d6d3=arguments[_0x597c9c(0x1b0)],_0x1bdb01=_0x45d6d3<0x3?_0x2a7744:_0x3c2c6e===null?_0x3c2c6e=Object[_0x597c9c(0x1b2)](_0x2a7744,_0x7ddcd7):_0x3c2c6e,_0x2f9c53;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x597c9c(0x18d))_0x1bdb01=Reflect['decorate'](_0x48cdfb,_0x2a7744,_0x7ddcd7,_0x3c2c6e);else{for(var _0x1c854a=_0x48cdfb[_0x597c9c(0x1b0)]-0x1;_0x1c854a>=0x0;_0x1c854a--)if(_0x2f9c53=_0x48cdfb[_0x1c854a])_0x1bdb01=(_0x45d6d3<0x3?_0x2f9c53(_0x1bdb01):_0x45d6d3>0x3?_0x2f9c53(_0x2a7744,_0x7ddcd7,_0x1bdb01):_0x2f9c53(_0x2a7744,_0x7ddcd7))||_0x1bdb01;}return _0x45d6d3>0x3&&_0x1bdb01&&Object['defineProperty'](_0x2a7744,_0x7ddcd7,_0x1bdb01),_0x1bdb01;},__metadata=this&&this[_0x386d2a(0x186)]||function(_0x852f80,_0x3ce80a){const _0x2fb132=_0x386d2a;if(typeof Reflect===_0x2fb132(0x193)&&typeof Reflect['metadata']==='function')return Reflect[_0x2fb132(0x18a)](_0x852f80,_0x3ce80a);},__param=this&&this[_0x386d2a(0x1a3)]||function(_0x51cfb7,_0x32c80d){return function(_0x3f1f97,_0xf050a8){_0x32c80d(_0x3f1f97,_0xf050a8,_0x51cfb7);};};Object[_0x386d2a(0x1a9)](exports,'__esModule',{'value':!![]}),exports[_0x386d2a(0x19c)]=void 0x0;const globalConfig_service_1=require('./../globalConfig/globalConfig.service'),common_1=require('@nestjs/common'),schedule_1=require(_0x386d2a(0x1ae)),userBalance_entity_1=require(_0x386d2a(0x1a2)),typeorm_1=require(_0x386d2a(0x188)),typeorm_2=require('typeorm'),models_service_1=require(_0x386d2a(0x19d));function _0x6d34(){const _0x2b3a7d=['Injectable','InjectRepository','prototype','533538vSWPPA','@nestjs/schedule','EVERY_HOUR','length','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token','getOwnPropertyDescriptor','UserBalanceEntity','modelsService','__metadata','3724IabMuG','@nestjs/typeorm','201119pWMeTc','metadata','会员已到期、清空所有余额并移除会员身份！','2315752PujWig','function','2439775agfmsm','789hpzFrz','Logger','handleCron','checkUserMemerExpire','object','Cron','globalConfigService','241574nMIaTU','CronExpression','GlobalConfigService','Repository','then','EVERY_5_MINUTES','TaskService','../models/models.service','design:returntype','14sdbEer','userBalanceEntity','__decorate','../userBalance/userBalance.entity','__param','design:type','6273792CuRXQB','find','design:paramtypes','LessThanOrEqual','defineProperty'];_0x6d34=function(){return _0x2b3a7d;};return _0x6d34();}let TaskService=class TaskService{constructor(_0x5a088b,_0x140d76,_0x1f3c37){const _0x5ebc03=_0x386d2a;this[_0x5ebc03(0x1a0)]=_0x5a088b,this[_0x5ebc03(0x195)]=_0x140d76,this[_0x5ebc03(0x185)]=_0x1f3c37;}['handleCron'](){const _0x57e0cf=_0x386d2a;common_1[_0x57e0cf(0x190)]['debug'](_0x57e0cf(0x1b1),_0x57e0cf(0x19c)),this[_0x57e0cf(0x195)]['getWechatAccessToken']();}async['checkUserMemerExpire'](){const _0x524d8a=_0x386d2a,_0x42001a=await this[_0x524d8a(0x1a0)][_0x524d8a(0x1a6)]({'where':{'expirationTime':(0x0,typeorm_2[_0x524d8a(0x1a8)])(new Date())}});if(!_0x42001a||!_0x42001a[_0x524d8a(0x1b0)])return;_0x42001a['forEach'](_0x539a6e=>{const _0x54b63f=_0x524d8a;this[_0x54b63f(0x1a0)]['update']({'id':_0x539a6e['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x54b63f(0x19a)](_0x4d12e5=>{const _0x1ea06d=_0x54b63f;common_1[_0x1ea06d(0x190)]['debug'](_0x539a6e['id']+_0x1ea06d(0x18b),_0x1ea06d(0x19c));});});}};__decorate([(0x0,schedule_1[_0x386d2a(0x194)])(schedule_1[_0x386d2a(0x197)][_0x386d2a(0x1af)]),__metadata(_0x386d2a(0x1a4),Function),__metadata(_0x386d2a(0x1a7),[]),__metadata('design:returntype',void 0x0)],TaskService[_0x386d2a(0x1ac)],_0x386d2a(0x191),null),__decorate([(0x0,schedule_1[_0x386d2a(0x194)])(schedule_1['CronExpression'][_0x386d2a(0x19b)]),__metadata('design:type',Function),__metadata(_0x386d2a(0x1a7),[]),__metadata(_0x386d2a(0x19e),Promise)],TaskService[_0x386d2a(0x1ac)],_0x386d2a(0x192),null),TaskService=__decorate([(0x0,common_1[_0x386d2a(0x1aa)])(),__param(0x0,(0x0,typeorm_1[_0x386d2a(0x1ab)])(userBalance_entity_1[_0x386d2a(0x184)])),__metadata(_0x386d2a(0x1a7),[typeorm_2[_0x386d2a(0x199)],globalConfig_service_1[_0x386d2a(0x198)],models_service_1['ModelsService']])],TaskService),exports[_0x386d2a(0x19c)]=TaskService;