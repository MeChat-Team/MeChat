'use strict';const _0x591c66=_0x1019;(function(_0x5c53c3,_0x435673){const _0x49fce8=_0x1019,_0x2b7ab5=_0x5c53c3();while(!![]){try{const _0x49b264=-parseInt(_0x49fce8(0xdc))/0x1*(-parseInt(_0x49fce8(0xc9))/0x2)+parseInt(_0x49fce8(0xea))/0x3+-parseInt(_0x49fce8(0xef))/0x4+parseInt(_0x49fce8(0xe1))/0x5*(parseInt(_0x49fce8(0xd0))/0x6)+-parseInt(_0x49fce8(0xec))/0x7+-parseInt(_0x49fce8(0xf4))/0x8+parseInt(_0x49fce8(0xf6))/0x9;if(_0x49b264===_0x435673)break;else _0x2b7ab5['push'](_0x2b7ab5['shift']());}catch(_0x3383ce){_0x2b7ab5['push'](_0x2b7ab5['shift']());}}}(_0x5042,0x9a6fb));var __decorate=this&&this[_0x591c66(0xe9)]||function(_0x474ae0,_0x445428,_0x50e8df,_0x218686){const _0x39ad86=_0x591c66;var _0x5b4d50=arguments['length'],_0x5f2de8=_0x5b4d50<0x3?_0x445428:_0x218686===null?_0x218686=Object['getOwnPropertyDescriptor'](_0x445428,_0x50e8df):_0x218686,_0x4a89a7;if(typeof Reflect===_0x39ad86(0xee)&&typeof Reflect[_0x39ad86(0xe8)]===_0x39ad86(0xc8))_0x5f2de8=Reflect[_0x39ad86(0xe8)](_0x474ae0,_0x445428,_0x50e8df,_0x218686);else{for(var _0x1bbbec=_0x474ae0[_0x39ad86(0xca)]-0x1;_0x1bbbec>=0x0;_0x1bbbec--)if(_0x4a89a7=_0x474ae0[_0x1bbbec])_0x5f2de8=(_0x5b4d50<0x3?_0x4a89a7(_0x5f2de8):_0x5b4d50>0x3?_0x4a89a7(_0x445428,_0x50e8df,_0x5f2de8):_0x4a89a7(_0x445428,_0x50e8df))||_0x5f2de8;}return _0x5b4d50>0x3&&_0x5f2de8&&Object[_0x39ad86(0xd8)](_0x445428,_0x50e8df,_0x5f2de8),_0x5f2de8;},__metadata=this&&this['__metadata']||function(_0x4a15b7,_0x1e7ba1){const _0x4c2375=_0x591c66;if(typeof Reflect===_0x4c2375(0xee)&&typeof Reflect[_0x4c2375(0xe3)]==='function')return Reflect[_0x4c2375(0xe3)](_0x4a15b7,_0x1e7ba1);},__param=this&&this[_0x591c66(0xf2)]||function(_0x1dda26,_0x14cfa4){return function(_0x1a7b67,_0x2205f3){_0x14cfa4(_0x1a7b67,_0x2205f3,_0x1dda26);};};function _0x1019(_0x58b918,_0x521099){const _0x5042a2=_0x5042();return _0x1019=function(_0x101945,_0x50cb7a){_0x101945=_0x101945-0xc8;let _0x2f3a43=_0x5042a2[_0x101945];return _0x2f3a43;},_0x1019(_0x58b918,_0x521099);}Object[_0x591c66(0xd8)](exports,'__esModule',{'value':!![]}),exports[_0x591c66(0xcd)]=void 0x0;const globalConfig_service_1=require(_0x591c66(0xce)),common_1=require(_0x591c66(0xdb)),schedule_1=require(_0x591c66(0xd6)),userBalance_entity_1=require(_0x591c66(0xd2)),typeorm_1=require(_0x591c66(0xe5)),typeorm_2=require('typeorm'),models_service_1=require(_0x591c66(0xda));let TaskService=class TaskService{constructor(_0x3add81,_0x113936,_0x2e84e8){const _0x1e6ac4=_0x591c66;this[_0x1e6ac4(0xf3)]=_0x3add81,this[_0x1e6ac4(0xeb)]=_0x113936,this[_0x1e6ac4(0xd4)]=_0x2e84e8;}['handleCron'](){const _0x4de804=_0x591c66;common_1[_0x4de804(0xd5)][_0x4de804(0xd9)](_0x4de804(0xe6),'TaskService'),this['globalConfigService']['getWechatAccessToken']();}async[_0x591c66(0xdd)](){const _0xdc89e7=_0x591c66,_0x1693db=await this[_0xdc89e7(0xf3)][_0xdc89e7(0xf5)]({'where':{'expirationTime':(0x0,typeorm_2[_0xdc89e7(0xe4)])(new Date())}});if(!_0x1693db||!_0x1693db[_0xdc89e7(0xca)])return;_0x1693db['forEach'](_0x4ca124=>{const _0x19473a=_0xdc89e7;this['userBalanceEntity']['update']({'id':_0x4ca124['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x19473a(0xcc)](_0x5abe1f=>{const _0x3e4c27=_0x19473a;common_1[_0x3e4c27(0xd5)]['debug'](_0x4ca124['id']+_0x3e4c27(0xd1),_0x3e4c27(0xcd));});});}};__decorate([(0x0,schedule_1[_0x591c66(0xe0)])(schedule_1['CronExpression'][_0x591c66(0xcb)]),__metadata(_0x591c66(0xd3),Function),__metadata(_0x591c66(0xde),[]),__metadata(_0x591c66(0xdf),void 0x0)],TaskService[_0x591c66(0xf1)],_0x591c66(0xe2),null),__decorate([(0x0,schedule_1[_0x591c66(0xe0)])(schedule_1[_0x591c66(0xcf)]['EVERY_5_MINUTES']),__metadata(_0x591c66(0xd3),Function),__metadata('design:paramtypes',[]),__metadata(_0x591c66(0xdf),Promise)],TaskService[_0x591c66(0xf1)],'checkUserMemerExpire',null),TaskService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_1[_0x591c66(0xe7)])(userBalance_entity_1[_0x591c66(0xf7)])),__metadata(_0x591c66(0xde),[typeorm_2[_0x591c66(0xd7)],globalConfig_service_1[_0x591c66(0xf0)],models_service_1[_0x591c66(0xed)]])],TaskService),exports[_0x591c66(0xcd)]=TaskService;function _0x5042(){const _0x527f6a=['modelsService','Logger','@nestjs/schedule','Repository','defineProperty','debug','../models/models.service','@nestjs/common','3sxTPjy','checkUserMemerExpire','design:paramtypes','design:returntype','Cron','5SyPdix','handleCron','metadata','LessThanOrEqual','@nestjs/typeorm','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token','InjectRepository','decorate','__decorate','599298UCCRIf','globalConfigService','3156636tiAkwV','ModelsService','object','2258716hQbBpR','GlobalConfigService','prototype','__param','userBalanceEntity','5229960vkpTMw','find','12902841BBvasi','UserBalanceEntity','function','275350plBjGZ','length','EVERY_HOUR','then','TaskService','./../globalConfig/globalConfig.service','CronExpression','1533018yJpCDx','会员已到期、清空所有余额并移除会员身份！','../userBalance/userBalance.entity','design:type'];_0x5042=function(){return _0x527f6a;};return _0x5042();}