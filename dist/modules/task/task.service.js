'use strict';const _0x383651=_0x1f18;(function(_0x3041e5,_0x5c91f3){const _0x1e3373=_0x1f18,_0x20dacc=_0x3041e5();while(!![]){try{const _0x2009da=-parseInt(_0x1e3373(0x213))/0x1+parseInt(_0x1e3373(0x21e))/0x2+-parseInt(_0x1e3373(0x20d))/0x3+-parseInt(_0x1e3373(0x1f5))/0x4+parseInt(_0x1e3373(0x217))/0x5*(-parseInt(_0x1e3373(0x208))/0x6)+parseInt(_0x1e3373(0x212))/0x7+-parseInt(_0x1e3373(0x1fa))/0x8*(-parseInt(_0x1e3373(0x1fb))/0x9);if(_0x2009da===_0x5c91f3)break;else _0x20dacc['push'](_0x20dacc['shift']());}catch(_0x313ce9){_0x20dacc['push'](_0x20dacc['shift']());}}}(_0x4e53,0x282bd));function _0x1f18(_0xbbbe42,_0x440f90){const _0x4e53d6=_0x4e53();return _0x1f18=function(_0x1f18d1,_0x431fc5){_0x1f18d1=_0x1f18d1-0x1f4;let _0x509dd2=_0x4e53d6[_0x1f18d1];return _0x509dd2;},_0x1f18(_0xbbbe42,_0x440f90);}var __decorate=this&&this[_0x383651(0x20b)]||function(_0x4e077f,_0xbede3a,_0x29b555,_0x31b697){const _0x59e81e=_0x383651;var _0x50ed12=arguments[_0x59e81e(0x21c)],_0x3928b6=_0x50ed12<0x3?_0xbede3a:_0x31b697===null?_0x31b697=Object[_0x59e81e(0x1f7)](_0xbede3a,_0x29b555):_0x31b697,_0x494b1c;if(typeof Reflect===_0x59e81e(0x21a)&&typeof Reflect[_0x59e81e(0x216)]==='function')_0x3928b6=Reflect['decorate'](_0x4e077f,_0xbede3a,_0x29b555,_0x31b697);else{for(var _0x715f72=_0x4e077f['length']-0x1;_0x715f72>=0x0;_0x715f72--)if(_0x494b1c=_0x4e077f[_0x715f72])_0x3928b6=(_0x50ed12<0x3?_0x494b1c(_0x3928b6):_0x50ed12>0x3?_0x494b1c(_0xbede3a,_0x29b555,_0x3928b6):_0x494b1c(_0xbede3a,_0x29b555))||_0x3928b6;}return _0x50ed12>0x3&&_0x3928b6&&Object[_0x59e81e(0x1ff)](_0xbede3a,_0x29b555,_0x3928b6),_0x3928b6;},__metadata=this&&this[_0x383651(0x224)]||function(_0x5e74c9,_0x1a6486){const _0x16c222=_0x383651;if(typeof Reflect===_0x16c222(0x21a)&&typeof Reflect['metadata']===_0x16c222(0x202))return Reflect[_0x16c222(0x219)](_0x5e74c9,_0x1a6486);},__param=this&&this[_0x383651(0x20e)]||function(_0x473fe6,_0x598f44){return function(_0x15ecbe,_0x5083b1){_0x598f44(_0x15ecbe,_0x5083b1,_0x473fe6);};};Object[_0x383651(0x1ff)](exports,_0x383651(0x1fd),{'value':!![]}),exports[_0x383651(0x21f)]=void 0x0;const globalConfig_service_1=require('./../globalConfig/globalConfig.service'),common_1=require(_0x383651(0x205)),schedule_1=require(_0x383651(0x209)),userBalance_entity_1=require(_0x383651(0x211)),typeorm_1=require('@nestjs/typeorm'),typeorm_2=require(_0x383651(0x206)),models_service_1=require(_0x383651(0x1fe));let TaskService=class TaskService{constructor(_0xea8871,_0x589862,_0x2656cd){const _0x3c5f1f=_0x383651;this[_0x3c5f1f(0x200)]=_0xea8871,this[_0x3c5f1f(0x1f8)]=_0x589862,this[_0x3c5f1f(0x221)]=_0x2656cd;}[_0x383651(0x218)](){const _0x2efa2a=_0x383651;common_1['Logger'][_0x2efa2a(0x223)]('Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token',_0x2efa2a(0x21f)),this[_0x2efa2a(0x1f8)][_0x2efa2a(0x228)]();}async[_0x383651(0x226)](){const _0x3585e0=_0x383651,_0x86e436=await this[_0x3585e0(0x200)][_0x3585e0(0x1fc)]({'where':{'expirationTime':(0x0,typeorm_2[_0x3585e0(0x21b)])(new Date())}});if(!_0x86e436||!_0x86e436[_0x3585e0(0x21c)])return;_0x86e436[_0x3585e0(0x215)](_0x1c1cc9=>{const _0x279e8e=_0x3585e0;this[_0x279e8e(0x200)]['update']({'id':_0x1c1cc9['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x279e8e(0x20f)](_0x2e3e4c=>{const _0x3bc820=_0x279e8e;common_1[_0x3bc820(0x201)]['debug'](_0x1c1cc9['id']+_0x3bc820(0x227),_0x3bc820(0x21f));});});}};__decorate([(0x0,schedule_1[_0x383651(0x1f6)])(schedule_1['CronExpression'][_0x383651(0x222)]),__metadata(_0x383651(0x20c),Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',void 0x0)],TaskService[_0x383651(0x207)],_0x383651(0x218),null),__decorate([(0x0,schedule_1[_0x383651(0x1f6)])(schedule_1[_0x383651(0x203)][_0x383651(0x225)]),__metadata(_0x383651(0x20c),Function),__metadata(_0x383651(0x204),[]),__metadata(_0x383651(0x21d),Promise)],TaskService[_0x383651(0x207)],'checkUserMemerExpire',null),TaskService=__decorate([(0x0,common_1[_0x383651(0x1f9)])(),__param(0x0,(0x0,typeorm_1[_0x383651(0x1f4)])(userBalance_entity_1[_0x383651(0x210)])),__metadata(_0x383651(0x204),[typeorm_2[_0x383651(0x220)],globalConfig_service_1[_0x383651(0x20a)],models_service_1[_0x383651(0x214)]])],TaskService),exports[_0x383651(0x21f)]=TaskService;function _0x4e53(){const _0x2f0335=['length','design:returntype','303000ZqbVeo','TaskService','Repository','modelsService','EVERY_HOUR','debug','__metadata','EVERY_5_MINUTES','checkUserMemerExpire','会员已到期、清空所有余额并移除会员身份！','getWechatAccessToken','InjectRepository','1313328UqqBnY','Cron','getOwnPropertyDescriptor','globalConfigService','Injectable','8OdPjjy','7633737iYHLlU','find','__esModule','../models/models.service','defineProperty','userBalanceEntity','Logger','function','CronExpression','design:paramtypes','@nestjs/common','typeorm','prototype','18918sYwWbw','@nestjs/schedule','GlobalConfigService','__decorate','design:type','504327bUXbho','__param','then','UserBalanceEntity','../userBalance/userBalance.entity','963263byPYzT','202009ufiivE','ModelsService','forEach','decorate','435QTNOJj','handleCron','metadata','object','LessThanOrEqual'];_0x4e53=function(){return _0x2f0335;};return _0x4e53();}