'use strict';function _0x36a5(){const _0x268e09=['UserBalanceEntity','4931502LgXYpc','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token','16vbVpPr','GlobalConfigService','Repository','prototype','Cron','forEach','@nestjs/typeorm','getWechatAccessToken','../models/models.service','@nestjs/common','design:returntype','42184VoGITA','3959190gtQEui','../userBalance/userBalance.entity','20470703zJZKGT','1503QhJnal','InjectRepository','ModelsService','design:paramtypes','defineProperty','checkUserMemerExpire','2171050HFAAGY','38aWytNP','decorate','CronExpression','userBalanceEntity','handleCron','9703323MwCPeX','design:type','object','modelsService','__esModule','__param','EVERY_5_MINUTES','./../globalConfig/globalConfig.service','10itGcwM','debug','LessThanOrEqual','EVERY_HOUR','function','__metadata','metadata','length','typeorm','find','then','69884jLBBLx','globalConfigService','TaskService','Logger','Injectable'];_0x36a5=function(){return _0x268e09;};return _0x36a5();}const _0x75d313=_0x5ee7;(function(_0x26198f,_0xed1bb){const _0x129f81=_0x5ee7,_0x428206=_0x26198f();while(!![]){try{const _0x4252d5=-parseInt(_0x129f81(0x177))/0x1*(-parseInt(_0x129f81(0x15f))/0x2)+-parseInt(_0x129f81(0x17d))/0x3+-parseInt(_0x129f81(0x17f))/0x4*(parseInt(_0x129f81(0x15e))/0x5)+parseInt(_0x129f81(0x155))/0x6+parseInt(_0x129f81(0x164))/0x7+-parseInt(_0x129f81(0x154))/0x8*(parseInt(_0x129f81(0x158))/0x9)+parseInt(_0x129f81(0x16c))/0xa*(parseInt(_0x129f81(0x157))/0xb);if(_0x4252d5===_0xed1bb)break;else _0x428206['push'](_0x428206['shift']());}catch(_0x207728){_0x428206['push'](_0x428206['shift']());}}}(_0x36a5,0xedaf6));function _0x5ee7(_0x3f44e3,_0xbe0e28){const _0x36a566=_0x36a5();return _0x5ee7=function(_0x5ee729,_0x909bdd){_0x5ee729=_0x5ee729-0x14f;let _0x420da6=_0x36a566[_0x5ee729];return _0x420da6;},_0x5ee7(_0x3f44e3,_0xbe0e28);}var __decorate=this&&this['__decorate']||function(_0x343b07,_0x29be95,_0x16e78d,_0xfa7324){const _0x59e035=_0x5ee7;var _0x49f312=arguments[_0x59e035(0x173)],_0x337c88=_0x49f312<0x3?_0x29be95:_0xfa7324===null?_0xfa7324=Object['getOwnPropertyDescriptor'](_0x29be95,_0x16e78d):_0xfa7324,_0x400e45;if(typeof Reflect==='object'&&typeof Reflect[_0x59e035(0x160)]==='function')_0x337c88=Reflect['decorate'](_0x343b07,_0x29be95,_0x16e78d,_0xfa7324);else{for(var _0x37b806=_0x343b07[_0x59e035(0x173)]-0x1;_0x37b806>=0x0;_0x37b806--)if(_0x400e45=_0x343b07[_0x37b806])_0x337c88=(_0x49f312<0x3?_0x400e45(_0x337c88):_0x49f312>0x3?_0x400e45(_0x29be95,_0x16e78d,_0x337c88):_0x400e45(_0x29be95,_0x16e78d))||_0x337c88;}return _0x49f312>0x3&&_0x337c88&&Object[_0x59e035(0x15c)](_0x29be95,_0x16e78d,_0x337c88),_0x337c88;},__metadata=this&&this[_0x75d313(0x171)]||function(_0x345462,_0x43fd48){const _0x2c00be=_0x75d313;if(typeof Reflect===_0x2c00be(0x166)&&typeof Reflect[_0x2c00be(0x172)]===_0x2c00be(0x170))return Reflect['metadata'](_0x345462,_0x43fd48);},__param=this&&this[_0x75d313(0x169)]||function(_0x50f2e4,_0x53815a){return function(_0x482a5a,_0x15c4da){_0x53815a(_0x482a5a,_0x15c4da,_0x50f2e4);};};Object[_0x75d313(0x15c)](exports,_0x75d313(0x168),{'value':!![]}),exports[_0x75d313(0x179)]=void 0x0;const globalConfig_service_1=require(_0x75d313(0x16b)),common_1=require(_0x75d313(0x152)),schedule_1=require('@nestjs/schedule'),userBalance_entity_1=require(_0x75d313(0x156)),typeorm_1=require(_0x75d313(0x14f)),typeorm_2=require(_0x75d313(0x174)),models_service_1=require(_0x75d313(0x151));let TaskService=class TaskService{constructor(_0x109cb9,_0x3d0e82,_0x2b14df){const _0x3742cd=_0x75d313;this[_0x3742cd(0x162)]=_0x109cb9,this[_0x3742cd(0x178)]=_0x3d0e82,this[_0x3742cd(0x167)]=_0x2b14df;}[_0x75d313(0x163)](){const _0x5d92eb=_0x75d313;common_1[_0x5d92eb(0x17a)][_0x5d92eb(0x16d)](_0x5d92eb(0x17e),_0x5d92eb(0x179)),this['globalConfigService'][_0x5d92eb(0x150)]();}async[_0x75d313(0x15d)](){const _0x5e6766=_0x75d313,_0x321ae8=await this[_0x5e6766(0x162)][_0x5e6766(0x175)]({'where':{'expirationTime':(0x0,typeorm_2[_0x5e6766(0x16e)])(new Date())}});if(!_0x321ae8||!_0x321ae8[_0x5e6766(0x173)])return;_0x321ae8[_0x5e6766(0x184)](_0x1c2cb3=>{const _0xdc9911=_0x5e6766;this[_0xdc9911(0x162)]['update']({'id':_0x1c2cb3['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0xdc9911(0x176)](_0x38dbba=>{const _0x2176cd=_0xdc9911;common_1[_0x2176cd(0x17a)]['debug'](_0x1c2cb3['id']+'会员已到期、清空所有余额并移除会员身份！',_0x2176cd(0x179));});});}};__decorate([(0x0,schedule_1[_0x75d313(0x183)])(schedule_1[_0x75d313(0x161)][_0x75d313(0x16f)]),__metadata(_0x75d313(0x165),Function),__metadata(_0x75d313(0x15b),[]),__metadata('design:returntype',void 0x0)],TaskService[_0x75d313(0x182)],_0x75d313(0x163),null),__decorate([(0x0,schedule_1[_0x75d313(0x183)])(schedule_1[_0x75d313(0x161)][_0x75d313(0x16a)]),__metadata('design:type',Function),__metadata(_0x75d313(0x15b),[]),__metadata(_0x75d313(0x153),Promise)],TaskService['prototype'],_0x75d313(0x15d),null),TaskService=__decorate([(0x0,common_1[_0x75d313(0x17b)])(),__param(0x0,(0x0,typeorm_1[_0x75d313(0x159)])(userBalance_entity_1[_0x75d313(0x17c)])),__metadata(_0x75d313(0x15b),[typeorm_2[_0x75d313(0x181)],globalConfig_service_1[_0x75d313(0x180)],models_service_1[_0x75d313(0x15a)]])],TaskService),exports[_0x75d313(0x179)]=TaskService;