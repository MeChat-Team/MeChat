'use strict';const _0x221232=_0x38e4;(function(_0x3054c0,_0xd3159b){const _0x56cd5c=_0x38e4,_0x8489fa=_0x3054c0();while(!![]){try{const _0x154a52=parseInt(_0x56cd5c(0x1d0))/0x1+parseInt(_0x56cd5c(0x1ec))/0x2*(-parseInt(_0x56cd5c(0x1c4))/0x3)+-parseInt(_0x56cd5c(0x1d4))/0x4*(parseInt(_0x56cd5c(0x1ef))/0x5)+parseInt(_0x56cd5c(0x1d9))/0x6*(-parseInt(_0x56cd5c(0x1c6))/0x7)+parseInt(_0x56cd5c(0x1e7))/0x8*(parseInt(_0x56cd5c(0x1e2))/0x9)+-parseInt(_0x56cd5c(0x1cd))/0xa*(-parseInt(_0x56cd5c(0x1ca))/0xb)+parseInt(_0x56cd5c(0x1f0))/0xc*(-parseInt(_0x56cd5c(0x1e3))/0xd);if(_0x154a52===_0xd3159b)break;else _0x8489fa['push'](_0x8489fa['shift']());}catch(_0x3615c2){_0x8489fa['push'](_0x8489fa['shift']());}}}(_0x1354,0x9e224));function _0x38e4(_0x307da1,_0x470120){const _0x13545f=_0x1354();return _0x38e4=function(_0x38e469,_0xc35a05){_0x38e469=_0x38e469-0x1bf;let _0x37dfd2=_0x13545f[_0x38e469];return _0x37dfd2;},_0x38e4(_0x307da1,_0x470120);}function _0x1354(){const _0x1534be=['design:paramtypes','design:returntype','getWechatAccessToken','getOwnPropertyDescriptor','1201702RnVNKZ','object','Injectable','10etdiQw','55932voJUcp','debug','globalConfigService','InjectRepository','@nestjs/schedule','EVERY_5_MINUTES','UserBalanceEntity','metadata','3VfDfOg','typeorm','21798ygHmIX','TaskService','function','@nestjs/common','96371QEGzjj','defineProperty','__param','910JCYXbR','design:type','__metadata','621249oiWEEG','length','modelsService','forEach','1079636bIerGB','handleCron','decorate','../userBalance/userBalance.entity','GlobalConfigService','1194ctgDOX','Logger','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token','then','checkUserMemerExpire','CronExpression','LessThanOrEqual','prototype','@nestjs/typeorm','3136509eJdKLY','156rxbXbp','../models/models.service','userBalanceEntity','__decorate','24eIakpa'];_0x1354=function(){return _0x1534be;};return _0x1354();}var __decorate=this&&this[_0x221232(0x1e6)]||function(_0x59fb1a,_0x53ede7,_0x3c1ffb,_0x3a8f72){const _0x49562e=_0x221232;var _0x39d566=arguments['length'],_0x49b09a=_0x39d566<0x3?_0x53ede7:_0x3a8f72===null?_0x3a8f72=Object[_0x49562e(0x1eb)](_0x53ede7,_0x3c1ffb):_0x3a8f72,_0x3ca5a0;if(typeof Reflect===_0x49562e(0x1ed)&&typeof Reflect[_0x49562e(0x1d6)]==='function')_0x49b09a=Reflect[_0x49562e(0x1d6)](_0x59fb1a,_0x53ede7,_0x3c1ffb,_0x3a8f72);else{for(var _0x146d65=_0x59fb1a['length']-0x1;_0x146d65>=0x0;_0x146d65--)if(_0x3ca5a0=_0x59fb1a[_0x146d65])_0x49b09a=(_0x39d566<0x3?_0x3ca5a0(_0x49b09a):_0x39d566>0x3?_0x3ca5a0(_0x53ede7,_0x3c1ffb,_0x49b09a):_0x3ca5a0(_0x53ede7,_0x3c1ffb))||_0x49b09a;}return _0x39d566>0x3&&_0x49b09a&&Object[_0x49562e(0x1cb)](_0x53ede7,_0x3c1ffb,_0x49b09a),_0x49b09a;},__metadata=this&&this[_0x221232(0x1cf)]||function(_0x1d6e34,_0x5c8573){const _0x32de32=_0x221232;if(typeof Reflect==='object'&&typeof Reflect[_0x32de32(0x1c3)]===_0x32de32(0x1c8))return Reflect[_0x32de32(0x1c3)](_0x1d6e34,_0x5c8573);},__param=this&&this[_0x221232(0x1cc)]||function(_0x38cbb2,_0x2516d9){return function(_0x4f1c3d,_0x3e5a27){_0x2516d9(_0x4f1c3d,_0x3e5a27,_0x38cbb2);};};Object[_0x221232(0x1cb)](exports,'__esModule',{'value':!![]}),exports[_0x221232(0x1c7)]=void 0x0;const globalConfig_service_1=require('./../globalConfig/globalConfig.service'),common_1=require(_0x221232(0x1c9)),schedule_1=require(_0x221232(0x1c0)),userBalance_entity_1=require(_0x221232(0x1d7)),typeorm_1=require(_0x221232(0x1e1)),typeorm_2=require(_0x221232(0x1c5)),models_service_1=require(_0x221232(0x1e4));let TaskService=class TaskService{constructor(_0x1ef2b7,_0x290a3c,_0x1d5511){const _0x30ca6f=_0x221232;this[_0x30ca6f(0x1e5)]=_0x1ef2b7,this[_0x30ca6f(0x1f2)]=_0x290a3c,this[_0x30ca6f(0x1d2)]=_0x1d5511;}[_0x221232(0x1d5)](){const _0x269df1=_0x221232;common_1[_0x269df1(0x1da)][_0x269df1(0x1f1)](_0x269df1(0x1db),_0x269df1(0x1c7)),this[_0x269df1(0x1f2)][_0x269df1(0x1ea)]();}async[_0x221232(0x1dd)](){const _0x485b46=_0x221232,_0x4ba4cd=await this['userBalanceEntity']['find']({'where':{'expirationTime':(0x0,typeorm_2[_0x485b46(0x1df)])(new Date())}});if(!_0x4ba4cd||!_0x4ba4cd[_0x485b46(0x1d1)])return;_0x4ba4cd[_0x485b46(0x1d3)](_0x4c72a4=>{const _0x52d7de=_0x485b46;this['userBalanceEntity']['update']({'id':_0x4c72a4['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x52d7de(0x1dc)](_0x36242e=>{const _0x17ffc5=_0x52d7de;common_1['Logger'][_0x17ffc5(0x1f1)](_0x4c72a4['id']+'会员已到期、清空所有余额并移除会员身份！','TaskService');});});}};__decorate([(0x0,schedule_1['Cron'])(schedule_1[_0x221232(0x1de)]['EVERY_HOUR']),__metadata(_0x221232(0x1ce),Function),__metadata('design:paramtypes',[]),__metadata(_0x221232(0x1e9),void 0x0)],TaskService[_0x221232(0x1e0)],'handleCron',null),__decorate([(0x0,schedule_1['Cron'])(schedule_1['CronExpression'][_0x221232(0x1c1)]),__metadata(_0x221232(0x1ce),Function),__metadata(_0x221232(0x1e8),[]),__metadata(_0x221232(0x1e9),Promise)],TaskService['prototype'],_0x221232(0x1dd),null),TaskService=__decorate([(0x0,common_1[_0x221232(0x1ee)])(),__param(0x0,(0x0,typeorm_1[_0x221232(0x1bf)])(userBalance_entity_1[_0x221232(0x1c2)])),__metadata(_0x221232(0x1e8),[typeorm_2['Repository'],globalConfig_service_1[_0x221232(0x1d8)],models_service_1['ModelsService']])],TaskService),exports[_0x221232(0x1c7)]=TaskService;