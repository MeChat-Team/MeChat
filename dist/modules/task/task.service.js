'use strict';const _0x5d818a=_0x256d;function _0x256d(_0x57dad9,_0x2e3451){const _0x51d2cc=_0x51d2();return _0x256d=function(_0x256dc5,_0x26035){_0x256dc5=_0x256dc5-0x1e0;let _0x3dd291=_0x51d2cc[_0x256dc5];return _0x3dd291;},_0x256d(_0x57dad9,_0x2e3451);}(function(_0x137f70,_0x571f25){const _0x28a38f=_0x256d,_0x464419=_0x137f70();while(!![]){try{const _0x41ee41=parseInt(_0x28a38f(0x20d))/0x1*(-parseInt(_0x28a38f(0x1fe))/0x2)+-parseInt(_0x28a38f(0x202))/0x3*(-parseInt(_0x28a38f(0x20b))/0x4)+parseInt(_0x28a38f(0x214))/0x5*(-parseInt(_0x28a38f(0x1f5))/0x6)+-parseInt(_0x28a38f(0x1fa))/0x7*(-parseInt(_0x28a38f(0x1ed))/0x8)+parseInt(_0x28a38f(0x1e1))/0x9+-parseInt(_0x28a38f(0x1e4))/0xa*(parseInt(_0x28a38f(0x213))/0xb)+-parseInt(_0x28a38f(0x211))/0xc*(-parseInt(_0x28a38f(0x1fb))/0xd);if(_0x41ee41===_0x571f25)break;else _0x464419['push'](_0x464419['shift']());}catch(_0xaed25d){_0x464419['push'](_0x464419['shift']());}}}(_0x51d2,0xf013a));function _0x51d2(){const _0x24a2ec=['debug','then','1576078NJujnu','31855421TNMKXv','Repository','ModelsService','1438348MuWIeR','decorate','__esModule','length','3Okeols','@nestjs/schedule','modelsService','prototype','Logger','userBalanceEntity','checkUserMemerExpire','getOwnPropertyDescriptor','UserBalanceEntity','5124844WLqkUJ','./../globalConfig/globalConfig.service','1XGpsyM','design:type','defineProperty','object','12BObqhK','会员已到期、清空所有余额并移除会员身份！','17287138EktqPa','5qdBEnu','function','2648835feIvml','__decorate','EVERY_HOUR','10SpaZPG','TaskService','design:paramtypes','metadata','InjectRepository','@nestjs/common','find','handleCron','design:returntype','24FmEqFd','update','@nestjs/typeorm','globalConfigService','../userBalance/userBalance.entity','Cron','../models/models.service','Injectable','8563914albZiu','__metadata','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token'];_0x51d2=function(){return _0x24a2ec;};return _0x51d2();}var __decorate=this&&this[_0x5d818a(0x1e2)]||function(_0x23d229,_0x55c7c6,_0xa13640,_0x521f2d){const _0x270d5a=_0x5d818a;var _0x5482f5=arguments[_0x270d5a(0x201)],_0x1ae66b=_0x5482f5<0x3?_0x55c7c6:_0x521f2d===null?_0x521f2d=Object[_0x270d5a(0x209)](_0x55c7c6,_0xa13640):_0x521f2d,_0x56fa02;if(typeof Reflect===_0x270d5a(0x210)&&typeof Reflect['decorate']===_0x270d5a(0x1e0))_0x1ae66b=Reflect[_0x270d5a(0x1ff)](_0x23d229,_0x55c7c6,_0xa13640,_0x521f2d);else{for(var _0x42496e=_0x23d229[_0x270d5a(0x201)]-0x1;_0x42496e>=0x0;_0x42496e--)if(_0x56fa02=_0x23d229[_0x42496e])_0x1ae66b=(_0x5482f5<0x3?_0x56fa02(_0x1ae66b):_0x5482f5>0x3?_0x56fa02(_0x55c7c6,_0xa13640,_0x1ae66b):_0x56fa02(_0x55c7c6,_0xa13640))||_0x1ae66b;}return _0x5482f5>0x3&&_0x1ae66b&&Object['defineProperty'](_0x55c7c6,_0xa13640,_0x1ae66b),_0x1ae66b;},__metadata=this&&this[_0x5d818a(0x1f6)]||function(_0x109232,_0x4b4b98){const _0x557843=_0x5d818a;if(typeof Reflect==='object'&&typeof Reflect['metadata']==='function')return Reflect[_0x557843(0x1e7)](_0x109232,_0x4b4b98);},__param=this&&this['__param']||function(_0x17064b,_0x23fcc3){return function(_0x496a23,_0x37ab4e){_0x23fcc3(_0x496a23,_0x37ab4e,_0x17064b);};};Object[_0x5d818a(0x20f)](exports,_0x5d818a(0x200),{'value':!![]}),exports['TaskService']=void 0x0;const globalConfig_service_1=require(_0x5d818a(0x20c)),common_1=require(_0x5d818a(0x1e9)),schedule_1=require(_0x5d818a(0x203)),userBalance_entity_1=require(_0x5d818a(0x1f1)),typeorm_1=require(_0x5d818a(0x1ef)),typeorm_2=require('typeorm'),models_service_1=require(_0x5d818a(0x1f3));let TaskService=class TaskService{constructor(_0x2306a8,_0x32ba9e,_0x529aa6){const _0xeee685=_0x5d818a;this['userBalanceEntity']=_0x2306a8,this[_0xeee685(0x1f0)]=_0x32ba9e,this[_0xeee685(0x204)]=_0x529aa6;}[_0x5d818a(0x1eb)](){const _0x392299=_0x5d818a;common_1[_0x392299(0x206)][_0x392299(0x1f8)](_0x392299(0x1f7),_0x392299(0x1e5)),this[_0x392299(0x1f0)]['getWechatAccessToken']();}async[_0x5d818a(0x208)](){const _0x2f63ce=_0x5d818a,_0xa835a4=await this[_0x2f63ce(0x207)][_0x2f63ce(0x1ea)]({'where':{'expirationTime':(0x0,typeorm_2['LessThanOrEqual'])(new Date())}});if(!_0xa835a4||!_0xa835a4[_0x2f63ce(0x201)])return;_0xa835a4['forEach'](_0x405dab=>{const _0x33b9ec=_0x2f63ce;this['userBalanceEntity'][_0x33b9ec(0x1ee)]({'id':_0x405dab['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x33b9ec(0x1f9)](_0x5af034=>{const _0x45aa1c=_0x33b9ec;common_1['Logger'][_0x45aa1c(0x1f8)](_0x405dab['id']+_0x45aa1c(0x212),'TaskService');});});}};__decorate([(0x0,schedule_1[_0x5d818a(0x1f2)])(schedule_1['CronExpression'][_0x5d818a(0x1e3)]),__metadata(_0x5d818a(0x20e),Function),__metadata(_0x5d818a(0x1e6),[]),__metadata(_0x5d818a(0x1ec),void 0x0)],TaskService[_0x5d818a(0x205)],_0x5d818a(0x1eb),null),__decorate([(0x0,schedule_1[_0x5d818a(0x1f2)])(schedule_1['CronExpression']['EVERY_5_MINUTES']),__metadata(_0x5d818a(0x20e),Function),__metadata(_0x5d818a(0x1e6),[]),__metadata(_0x5d818a(0x1ec),Promise)],TaskService[_0x5d818a(0x205)],_0x5d818a(0x208),null),TaskService=__decorate([(0x0,common_1[_0x5d818a(0x1f4)])(),__param(0x0,(0x0,typeorm_1[_0x5d818a(0x1e8)])(userBalance_entity_1[_0x5d818a(0x20a)])),__metadata(_0x5d818a(0x1e6),[typeorm_2[_0x5d818a(0x1fc)],globalConfig_service_1['GlobalConfigService'],models_service_1[_0x5d818a(0x1fd)]])],TaskService),exports[_0x5d818a(0x1e5)]=TaskService;