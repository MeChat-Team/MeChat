'use strict';const _0x56fccb=_0x5fb1;(function(_0x21bc5b,_0x50e387){const _0x192eb9=_0x5fb1,_0xd159=_0x21bc5b();while(!![]){try{const _0x59a48d=-parseInt(_0x192eb9(0x1d3))/0x1+-parseInt(_0x192eb9(0x1d6))/0x2+-parseInt(_0x192eb9(0x1e4))/0x3+-parseInt(_0x192eb9(0x1dd))/0x4+parseInt(_0x192eb9(0x1e0))/0x5*(-parseInt(_0x192eb9(0x1e8))/0x6)+parseInt(_0x192eb9(0x1fc))/0x7*(-parseInt(_0x192eb9(0x1db))/0x8)+parseInt(_0x192eb9(0x1e5))/0x9;if(_0x59a48d===_0x50e387)break;else _0xd159['push'](_0xd159['shift']());}catch(_0x3be508){_0xd159['push'](_0xd159['shift']());}}}(_0x352c,0x6c9db));var __decorate=this&&this['__decorate']||function(_0x51a24c,_0x1c1999,_0x3e8f63,_0x56cd52){const _0x4e5543=_0x5fb1;var _0x58a93b=arguments[_0x4e5543(0x1f7)],_0x143561=_0x58a93b<0x3?_0x1c1999:_0x56cd52===null?_0x56cd52=Object[_0x4e5543(0x1f8)](_0x1c1999,_0x3e8f63):_0x56cd52,_0x2a513d;if(typeof Reflect===_0x4e5543(0x1f3)&&typeof Reflect['decorate']==='function')_0x143561=Reflect[_0x4e5543(0x1d2)](_0x51a24c,_0x1c1999,_0x3e8f63,_0x56cd52);else{for(var _0x2b9fe9=_0x51a24c['length']-0x1;_0x2b9fe9>=0x0;_0x2b9fe9--)if(_0x2a513d=_0x51a24c[_0x2b9fe9])_0x143561=(_0x58a93b<0x3?_0x2a513d(_0x143561):_0x58a93b>0x3?_0x2a513d(_0x1c1999,_0x3e8f63,_0x143561):_0x2a513d(_0x1c1999,_0x3e8f63))||_0x143561;}return _0x58a93b>0x3&&_0x143561&&Object[_0x4e5543(0x1eb)](_0x1c1999,_0x3e8f63,_0x143561),_0x143561;},__metadata=this&&this[_0x56fccb(0x1ce)]||function(_0x3c1854,_0x334a8c){const _0xace26a=_0x56fccb;if(typeof Reflect===_0xace26a(0x1f3)&&typeof Reflect[_0xace26a(0x203)]===_0xace26a(0x1dc))return Reflect[_0xace26a(0x203)](_0x3c1854,_0x334a8c);},__param=this&&this[_0x56fccb(0x1ea)]||function(_0x33cfb0,_0x1fc6d5){return function(_0x35767b,_0x5da644){_0x1fc6d5(_0x35767b,_0x5da644,_0x33cfb0);};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[_0x56fccb(0x1e9)]=void 0x0;const common_1=require('@nestjs/common'),typeorm_1=require(_0x56fccb(0x1d0)),typeorm_2=require(_0x56fccb(0x1e1)),autoreply_entity_1=require(_0x56fccb(0x1de));function _0x352c(){const _0x2e9b40=['metadata','queryAutoreply','filter','affected','prompt','loadAutoReplyList','__metadata','添加问题成功！','@nestjs/typeorm','answer','decorate','860638cWZmAw','AutoReplyEntity','onModuleInit','160516CqXTIv','forEach','includes','该问题不存在,请检查您的提交信息','some','31816VZYzeA','function','557404tpEymm','./autoreply.entity','更新失败','397685tOZPcT','typeorm','map','trim','1788411YcMPXF','24639363KMKtXj','find','add','6afjPxw','AutoreplyService','__param','defineProperty','HttpException','isAIReplyEnabled','findOne','checkAutoReply','autoReplyEntity','autoReplyFuzzyMatch','HttpStatus','object','删除失败','has','update','length','getOwnPropertyDescriptor','autoReplyMap','split','push','945dOTQOK','DESC','autoReplyKes','更新问题成功','keywords','updateAutoreply','删除问题成功'];_0x352c=function(){return _0x2e9b40;};return _0x352c();}function _0x5fb1(_0x12bd17,_0xbea009){const _0x352c37=_0x352c();return _0x5fb1=function(_0x5fb184,_0x2eac5e){_0x5fb184=_0x5fb184-0x1cb;let _0x1955e3=_0x352c37[_0x5fb184];return _0x1955e3;},_0x5fb1(_0x12bd17,_0xbea009);}let AutoreplyService=class AutoreplyService{constructor(_0x25a2dc){const _0x73da00=_0x56fccb;this[_0x73da00(0x1f0)]=_0x25a2dc,this[_0x73da00(0x1fe)]=[],this[_0x73da00(0x1f9)]={},this[_0x73da00(0x1f1)]=!![];}async[_0x56fccb(0x1d5)](){const _0x30bf43=_0x56fccb;await this[_0x30bf43(0x1cd)]();}async['loadAutoReplyList'](){const _0x38c167=_0x56fccb,_0x1c7df8=await this[_0x38c167(0x1f0)][_0x38c167(0x1e6)]({'where':{'status':0x1},'select':[_0x38c167(0x1cc),_0x38c167(0x1d1),_0x38c167(0x1ed)]});this[_0x38c167(0x1f9)]={},this[_0x38c167(0x1fe)]=[],_0x1c7df8[_0x38c167(0x1d7)](_0x3b33f9=>{const _0x59e08d=_0x38c167;this[_0x59e08d(0x1f9)][_0x3b33f9[_0x59e08d(0x1cc)]]={'answer':_0x3b33f9[_0x59e08d(0x1d1)],'isAIReplyEnabled':_0x3b33f9['isAIReplyEnabled']};const _0x58a0a4=_0x3b33f9[_0x59e08d(0x1cc)][_0x59e08d(0x1fa)]('\x20')[_0x59e08d(0x1e2)](_0x1ffc82=>_0x1ffc82[_0x59e08d(0x1e3)]());this['autoReplyKes'][_0x59e08d(0x1fb)]({'prompt':_0x3b33f9['prompt'],'keywords':_0x58a0a4});});}async[_0x56fccb(0x1ef)](_0x19c658){const _0x4d3e55=_0x56fccb;let _0x4cee15=[],_0x2b747f=0x0;const _0x5b669a=new Set();if(this[_0x4d3e55(0x1f1)])for(const _0x22f775 of this[_0x4d3e55(0x1fe)]){_0x22f775[_0x4d3e55(0x200)][_0x4d3e55(0x1da)](_0xb1f725=>_0x19c658['includes'](_0xb1f725))&&(!_0x5b669a['has'](_0x22f775[_0x4d3e55(0x1cc)])&&(_0x4cee15['push'](this[_0x4d3e55(0x1f9)][_0x22f775[_0x4d3e55(0x1cc)]][_0x4d3e55(0x1d1)]),_0x5b669a['add'](_0x22f775['prompt']),this[_0x4d3e55(0x1f9)][_0x22f775['prompt']][_0x4d3e55(0x1ed)]===0x1&&(_0x2b747f=0x1)));}else{const _0x3cbe05=this[_0x4d3e55(0x1fe)][_0x4d3e55(0x205)](_0x11a975=>_0x11a975['prompt']===_0x19c658);for(const _0x4177af of _0x3cbe05){!_0x5b669a[_0x4d3e55(0x1f5)](_0x4177af[_0x4d3e55(0x1cc)])&&(_0x4cee15[_0x4d3e55(0x1fb)](this[_0x4d3e55(0x1f9)][_0x4177af[_0x4d3e55(0x1cc)]][_0x4d3e55(0x1d1)]),_0x5b669a[_0x4d3e55(0x1e7)](_0x4177af[_0x4d3e55(0x1cc)]),this['autoReplyMap'][_0x4177af['prompt']][_0x4d3e55(0x1ed)]===0x1&&(_0x2b747f=0x1));}}return{'answer':_0x4cee15['join']('\x0a'),'isAIReplyEnabled':_0x2b747f};}async[_0x56fccb(0x204)](_0x57c4a3){const _0x28e1d5=_0x56fccb,{page:page=0x1,size:size=0xa,prompt:_0x15ccaa,status:_0x2e325a}=_0x57c4a3,_0x51bb12={};[0x0,0x1,'0','1'][_0x28e1d5(0x1d8)](_0x2e325a)&&(_0x51bb12['status']=_0x2e325a),_0x15ccaa&&(_0x51bb12[_0x28e1d5(0x1cc)]=(0x0,typeorm_2['Like'])('%'+_0x15ccaa+'%'));const [_0x29a1fe,_0x5390e3]=await this[_0x28e1d5(0x1f0)]['findAndCount']({'where':_0x51bb12,'skip':(page-0x1)*size,'take':size,'order':{'id':_0x28e1d5(0x1fd)}});return{'rows':_0x29a1fe,'count':_0x5390e3};}async['addAutoreply'](_0x452fe9){const _0x2e679d=_0x56fccb;return await this[_0x2e679d(0x1f0)]['save'](_0x452fe9),await this[_0x2e679d(0x1cd)](),_0x2e679d(0x1cf);}async[_0x56fccb(0x201)](_0x42f138){const _0x52542f=_0x56fccb,{id:_0x106f41}=_0x42f138,_0x305395=await this[_0x52542f(0x1f0)][_0x52542f(0x1f6)]({'id':_0x106f41},_0x42f138);if(_0x305395['affected']>0x0)return await this[_0x52542f(0x1cd)](),_0x52542f(0x1ff);throw new common_1[(_0x52542f(0x1ec))](_0x52542f(0x1df),common_1[_0x52542f(0x1f2)]['BAD_REQUEST']);}async['delAutoreply'](_0x488023){const _0x21713e=_0x56fccb,{id:_0x8231d9}=_0x488023,_0x42f775=await this[_0x21713e(0x1f0)][_0x21713e(0x1ee)]({'where':{'id':_0x8231d9}});if(!_0x42f775)throw new common_1[(_0x21713e(0x1ec))](_0x21713e(0x1d9),common_1[_0x21713e(0x1f2)]['BAD_REQUEST']);const _0x4a9d30=await this[_0x21713e(0x1f0)]['delete']({'id':_0x8231d9});if(_0x4a9d30[_0x21713e(0x1cb)]>0x0)return await this[_0x21713e(0x1cd)](),_0x21713e(0x202);throw new common_1['HttpException'](_0x21713e(0x1f4),common_1[_0x21713e(0x1f2)]['BAD_REQUEST']);}};AutoreplyService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_1['InjectRepository'])(autoreply_entity_1[_0x56fccb(0x1d4)])),__metadata('design:paramtypes',[typeorm_2['Repository']])],AutoreplyService),exports[_0x56fccb(0x1e9)]=AutoreplyService;