'use strict';const _0x28c2d3=_0x3d73;(function(_0x191048,_0x5c41db){const _0x3a98bc=_0x3d73,_0x3a7d18=_0x191048();while(!![]){try{const _0x2fa22c=-parseInt(_0x3a98bc(0xa3))/0x1*(-parseInt(_0x3a98bc(0xbf))/0x2)+parseInt(_0x3a98bc(0xd7))/0x3*(-parseInt(_0x3a98bc(0xd1))/0x4)+-parseInt(_0x3a98bc(0xaf))/0x5*(-parseInt(_0x3a98bc(0xcb))/0x6)+-parseInt(_0x3a98bc(0xc4))/0x7+parseInt(_0x3a98bc(0xdb))/0x8+parseInt(_0x3a98bc(0xd4))/0x9+-parseInt(_0x3a98bc(0xbc))/0xa*(parseInt(_0x3a98bc(0xe1))/0xb);if(_0x2fa22c===_0x5c41db)break;else _0x3a7d18['push'](_0x3a7d18['shift']());}catch(_0x1f34e4){_0x3a7d18['push'](_0x3a7d18['shift']());}}}(_0x68a0,0x51585));var __decorate=this&&this[_0x28c2d3(0xb8)]||function(_0x2dec2b,_0x53f339,_0x509caf,_0xfce38c){const _0x1f4e91=_0x28c2d3;var _0x407fea=arguments['length'],_0x2363e2=_0x407fea<0x3?_0x53f339:_0xfce38c===null?_0xfce38c=Object['getOwnPropertyDescriptor'](_0x53f339,_0x509caf):_0xfce38c,_0x45915b;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x1f4e91(0xa7))_0x2363e2=Reflect['decorate'](_0x2dec2b,_0x53f339,_0x509caf,_0xfce38c);else{for(var _0x4f7023=_0x2dec2b[_0x1f4e91(0xda)]-0x1;_0x4f7023>=0x0;_0x4f7023--)if(_0x45915b=_0x2dec2b[_0x4f7023])_0x2363e2=(_0x407fea<0x3?_0x45915b(_0x2363e2):_0x407fea>0x3?_0x45915b(_0x53f339,_0x509caf,_0x2363e2):_0x45915b(_0x53f339,_0x509caf))||_0x2363e2;}return _0x407fea>0x3&&_0x2363e2&&Object[_0x1f4e91(0xad)](_0x53f339,_0x509caf,_0x2363e2),_0x2363e2;},__metadata=this&&this[_0x28c2d3(0xc6)]||function(_0x4fc542,_0x487caf){const _0xd3e325=_0x28c2d3;if(typeof Reflect===_0xd3e325(0xc3)&&typeof Reflect[_0xd3e325(0xcc)]===_0xd3e325(0xa7))return Reflect[_0xd3e325(0xcc)](_0x4fc542,_0x487caf);},__param=this&&this[_0x28c2d3(0xc5)]||function(_0x3a862f,_0x219614){return function(_0x5d0091,_0x82dbb7){_0x219614(_0x5d0091,_0x82dbb7,_0x3a862f);};};function _0x68a0(){const _0x3ca05a=['checkAutoReply','object','4226068WWfMxk','__param','__metadata','__esModule','HttpStatus','has','AutoReplyEntity','1428WVxcBF','metadata','save','Injectable','delete','isAIReplyEnabled','54948OXhQuf','status','prompt','5180760TkOIUP','DESC','map','39YLVlIc','forEach','BAD_REQUEST','length','5071016edVoVq','keywords','push','updateAutoreply','autoReplyEntity','queryAutoreply','22hUfhRW','update','join','design:paramtypes','affected','trim','findAndCount','13839KnMJoQ','autoReplyKes','answer','删除问题成功','function','addAutoreply','更新失败','./autoreply.entity','add','AutoreplyService','defineProperty','find','3140cvwrhr','该问题不存在,请检查您的提交信息','loadAutoReplyList','some','typeorm','delAutoreply','Like','HttpException','onModuleInit','__decorate','autoReplyFuzzyMatch','includes','autoReplyMap','2116970LLMJPB','添加问题成功！','InjectRepository','26GIXKJN','删除失败','@nestjs/common'];_0x68a0=function(){return _0x3ca05a;};return _0x68a0();}Object[_0x28c2d3(0xad)](exports,_0x28c2d3(0xc7),{'value':!![]}),exports[_0x28c2d3(0xac)]=void 0x0;function _0x3d73(_0x37f075,_0x10ee77){const _0x68a043=_0x68a0();return _0x3d73=function(_0x3d7354,_0x59500b){_0x3d7354=_0x3d7354-0xa1;let _0x12028c=_0x68a043[_0x3d7354];return _0x12028c;},_0x3d73(_0x37f075,_0x10ee77);}const common_1=require(_0x28c2d3(0xc1)),typeorm_1=require('@nestjs/typeorm'),typeorm_2=require(_0x28c2d3(0xb3)),autoreply_entity_1=require(_0x28c2d3(0xaa));let AutoreplyService=class AutoreplyService{constructor(_0x2e4a62){const _0x2db4db=_0x28c2d3;this[_0x2db4db(0xdf)]=_0x2e4a62,this[_0x2db4db(0xa4)]=[],this[_0x2db4db(0xbb)]={},this[_0x2db4db(0xb9)]=!![];}async[_0x28c2d3(0xb7)](){const _0x2b906f=_0x28c2d3;await this[_0x2b906f(0xb1)]();}async[_0x28c2d3(0xb1)](){const _0x298cda=_0x28c2d3,_0xbb0654=await this['autoReplyEntity'][_0x298cda(0xae)]({'where':{'status':0x1},'select':[_0x298cda(0xd3),_0x298cda(0xa5),'isAIReplyEnabled']});this[_0x298cda(0xbb)]={},this[_0x298cda(0xa4)]=[],_0xbb0654[_0x298cda(0xd8)](_0x20a133=>{const _0x206a39=_0x298cda;this[_0x206a39(0xbb)][_0x20a133[_0x206a39(0xd3)]]={'answer':_0x20a133[_0x206a39(0xa5)],'isAIReplyEnabled':_0x20a133[_0x206a39(0xd0)]};const _0x27e9c1=_0x20a133['prompt']['split']('\x20')[_0x206a39(0xd6)](_0x277404=>_0x277404[_0x206a39(0xa1)]());this[_0x206a39(0xa4)][_0x206a39(0xdd)]({'prompt':_0x20a133[_0x206a39(0xd3)],'keywords':_0x27e9c1});});}async[_0x28c2d3(0xc2)](_0x26b8f7){const _0x2315e0=_0x28c2d3;let _0x1604e6=[],_0x305e0a=0x0;const _0x3a11a1=new Set();if(this['autoReplyFuzzyMatch'])for(const _0x18c9f6 of this['autoReplyKes']){_0x18c9f6[_0x2315e0(0xdc)][_0x2315e0(0xb2)](_0x42f67d=>_0x26b8f7[_0x2315e0(0xba)](_0x42f67d))&&(!_0x3a11a1[_0x2315e0(0xc9)](_0x18c9f6['prompt'])&&(_0x1604e6[_0x2315e0(0xdd)](this[_0x2315e0(0xbb)][_0x18c9f6[_0x2315e0(0xd3)]][_0x2315e0(0xa5)]),_0x3a11a1[_0x2315e0(0xab)](_0x18c9f6[_0x2315e0(0xd3)]),this['autoReplyMap'][_0x18c9f6[_0x2315e0(0xd3)]][_0x2315e0(0xd0)]===0x1&&(_0x305e0a=0x1)));}else{const _0x4f90dc=this[_0x2315e0(0xa4)]['filter'](_0x82357a=>_0x82357a[_0x2315e0(0xd3)]===_0x26b8f7);for(const _0xe22ffc of _0x4f90dc){!_0x3a11a1[_0x2315e0(0xc9)](_0xe22ffc[_0x2315e0(0xd3)])&&(_0x1604e6['push'](this[_0x2315e0(0xbb)][_0xe22ffc[_0x2315e0(0xd3)]][_0x2315e0(0xa5)]),_0x3a11a1['add'](_0xe22ffc['prompt']),this[_0x2315e0(0xbb)][_0xe22ffc[_0x2315e0(0xd3)]][_0x2315e0(0xd0)]===0x1&&(_0x305e0a=0x1));}}return{'answer':_0x1604e6[_0x2315e0(0xe3)]('\x0a'),'isAIReplyEnabled':_0x305e0a};}async[_0x28c2d3(0xe0)](_0x51f8f7){const _0x4dd982=_0x28c2d3,{page:page=0x1,size:size=0xa,prompt:_0x17fbb8,status:_0x1488ea}=_0x51f8f7,_0x15e208={};[0x0,0x1,'0','1'][_0x4dd982(0xba)](_0x1488ea)&&(_0x15e208[_0x4dd982(0xd2)]=_0x1488ea),_0x17fbb8&&(_0x15e208['prompt']=(0x0,typeorm_2[_0x4dd982(0xb5)])('%'+_0x17fbb8+'%'));const [_0x149130,_0x5702e9]=await this[_0x4dd982(0xdf)][_0x4dd982(0xa2)]({'where':_0x15e208,'skip':(page-0x1)*size,'take':size,'order':{'id':_0x4dd982(0xd5)}});return{'rows':_0x149130,'count':_0x5702e9};}async[_0x28c2d3(0xa8)](_0x1671f2){const _0x1709fe=_0x28c2d3;return await this['autoReplyEntity'][_0x1709fe(0xcd)](_0x1671f2),await this[_0x1709fe(0xb1)](),_0x1709fe(0xbd);}async[_0x28c2d3(0xde)](_0x24005d){const _0x724ce4=_0x28c2d3,{id:_0x298dd4}=_0x24005d,_0x445cc9=await this[_0x724ce4(0xdf)][_0x724ce4(0xe2)]({'id':_0x298dd4},_0x24005d);if(_0x445cc9[_0x724ce4(0xe5)]>0x0)return await this[_0x724ce4(0xb1)](),'更新问题成功';throw new common_1['HttpException'](_0x724ce4(0xa9),common_1[_0x724ce4(0xc8)][_0x724ce4(0xd9)]);}async[_0x28c2d3(0xb4)](_0x5a7992){const _0x1c8b12=_0x28c2d3,{id:_0x4984bd}=_0x5a7992,_0xad0a5b=await this[_0x1c8b12(0xdf)]['findOne']({'where':{'id':_0x4984bd}});if(!_0xad0a5b)throw new common_1['HttpException'](_0x1c8b12(0xb0),common_1[_0x1c8b12(0xc8)]['BAD_REQUEST']);const _0x6d9aa4=await this[_0x1c8b12(0xdf)][_0x1c8b12(0xcf)]({'id':_0x4984bd});if(_0x6d9aa4[_0x1c8b12(0xe5)]>0x0)return await this[_0x1c8b12(0xb1)](),_0x1c8b12(0xa6);throw new common_1[(_0x1c8b12(0xb6))](_0x1c8b12(0xc0),common_1[_0x1c8b12(0xc8)]['BAD_REQUEST']);}};AutoreplyService=__decorate([(0x0,common_1[_0x28c2d3(0xce)])(),__param(0x0,(0x0,typeorm_1[_0x28c2d3(0xbe)])(autoreply_entity_1[_0x28c2d3(0xca)])),__metadata(_0x28c2d3(0xe4),[typeorm_2['Repository']])],AutoreplyService),exports[_0x28c2d3(0xac)]=AutoreplyService;