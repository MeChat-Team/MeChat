'use strict';const _0x1539f0=_0xde72;(function(_0x4665e8,_0x3c0d06){const _0x3d1faa=_0xde72,_0x370bbc=_0x4665e8();while(!![]){try{const _0x2a0028=-parseInt(_0x3d1faa(0xed))/0x1*(parseInt(_0x3d1faa(0xe7))/0x2)+parseInt(_0x3d1faa(0xb6))/0x3+parseInt(_0x3d1faa(0xee))/0x4+-parseInt(_0x3d1faa(0xb1))/0x5*(parseInt(_0x3d1faa(0xa2))/0x6)+parseInt(_0x3d1faa(0xa9))/0x7*(-parseInt(_0x3d1faa(0xd9))/0x8)+-parseInt(_0x3d1faa(0xd3))/0x9+parseInt(_0x3d1faa(0xc4))/0xa;if(_0x2a0028===_0x3c0d06)break;else _0x370bbc['push'](_0x370bbc['shift']());}catch(_0x1b1c9a){_0x370bbc['push'](_0x370bbc['shift']());}}}(_0x5967,0xe0908));var __decorate=this&&this[_0x1539f0(0xeb)]||function(_0x3e0540,_0x1f1598,_0x5afdf7,_0x5ae75a){const _0x47dea2=_0x1539f0;var _0x1cc56d=arguments[_0x47dea2(0xe1)],_0x4c02ad=_0x1cc56d<0x3?_0x1f1598:_0x5ae75a===null?_0x5ae75a=Object[_0x47dea2(0xbf)](_0x1f1598,_0x5afdf7):_0x5ae75a,_0x41e910;if(typeof Reflect===_0x47dea2(0xb2)&&typeof Reflect[_0x47dea2(0xaa)]===_0x47dea2(0xf9))_0x4c02ad=Reflect[_0x47dea2(0xaa)](_0x3e0540,_0x1f1598,_0x5afdf7,_0x5ae75a);else{for(var _0x1eea7d=_0x3e0540[_0x47dea2(0xe1)]-0x1;_0x1eea7d>=0x0;_0x1eea7d--)if(_0x41e910=_0x3e0540[_0x1eea7d])_0x4c02ad=(_0x1cc56d<0x3?_0x41e910(_0x4c02ad):_0x1cc56d>0x3?_0x41e910(_0x1f1598,_0x5afdf7,_0x4c02ad):_0x41e910(_0x1f1598,_0x5afdf7))||_0x4c02ad;}return _0x1cc56d>0x3&&_0x4c02ad&&Object[_0x47dea2(0xa8)](_0x1f1598,_0x5afdf7,_0x4c02ad),_0x4c02ad;},__metadata=this&&this[_0x1539f0(0xea)]||function(_0x4cb526,_0x2b7137){const _0x9b6be6=_0x1539f0;if(typeof Reflect===_0x9b6be6(0xb2)&&typeof Reflect[_0x9b6be6(0xb3)]===_0x9b6be6(0xf9))return Reflect[_0x9b6be6(0xb3)](_0x4cb526,_0x2b7137);},__param=this&&this[_0x1539f0(0xc3)]||function(_0x1e9568,_0x24c170){return function(_0x30203d,_0x4d5dc1){_0x24c170(_0x30203d,_0x4d5dc1,_0x1e9568);};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[_0x1539f0(0xd5)]=void 0x0;const jwtAuth_guard_1=require(_0x1539f0(0xc9)),utils_1=require(_0x1539f0(0x9c)),common_1=require(_0x1539f0(0xf1)),swagger_1=require(_0x1539f0(0x97)),getQrCode_dto_1=require(_0x1539f0(0xdd)),official_service_1=require(_0x1539f0(0xda));function _0x5967(){const _0x5f10da=['weChatMpUrl','__metadata','__decorate','sceneStr','71JaRzSk','3463004MwBlsk','bindWxBySceneStr','official','@nestjs/common','loginBySceneStr','scan','notifyPost','Query','prototype','getQRCodeTicket','getQRSceneStr','function','VIEW','@nestjs/swagger','CLICK','eventkey','scanBindWx','msgtype','../../common/utils','Controller','Req','getRedirectUrl','公众号通知接口GET','ApiTags','6GqvSuu','获取登录跳转地址','formatUrl','Post','event','officialService','defineProperty','2401lovbgp','decorate','text','verify','content','send','genXmlMsg','echostr','2255395jUxNUJ','object','metadata','获取二维码','env','4590300IVgpwe','TRUE','xml:\x20','signature','nonce','JwtAuthGuard','获取绑定二维码的sceneStr','notify','qrscene_','getOwnPropertyDescriptor','subscribe','getQRCode','sceneStr:\x20','__param','22116720xkpCbF','/cgi-bin/showqrcode?ticket=','扫码登录轮询查询','design:paramtypes','ISDEV','../../common/auth/jwtAuth.guard','success','includes','officialBindAccountText','design:type','getQRSceneStrByBind','code','GetQrCodeDto','公众号静默登录','timestamp','15668208TZdptb','officialScanLoginText','OfficialController','url','扫码绑定轮询查询','getJsapiTicket','18440BGiXVI','./official.service','https://mp.weixin.qq.com','Body','./dto/getQrCode.dto','log','OfficialService','aotoPlay','length','status','ApiOperation','loginByCode','genXmlMsgByConfig','fromusername','19862FjbncG','design:returntype'];_0x5967=function(){return _0x5f10da;};return _0x5967();}function _0xde72(_0x990f2a,_0x4d8a17){const _0x5967d7=_0x5967();return _0xde72=function(_0xde72ea,_0x1ea091){_0xde72ea=_0xde72ea-0x96;let _0x35ff40=_0x5967d7[_0xde72ea];return _0x35ff40;},_0xde72(_0x990f2a,_0x4d8a17);}let OfficialController=class OfficialController{constructor(_0x4487d8){const _0x3d10b7=_0x1539f0;this[_0x3d10b7(0xa7)]=_0x4487d8;}async[_0x1539f0(0xbd)](_0x4b91cf,_0xef03b3,_0xfd452d){const _0x160c53=_0x1539f0;console[_0x160c53(0xde)]('get\x20通知>>>',_0xef03b3,_0xfd452d);const _0x1460f6=await this['officialService'][_0x160c53(0xac)](_0xef03b3[_0x160c53(0xb9)],_0xef03b3[_0x160c53(0xba)],_0xef03b3[_0x160c53(0xd2)]);return _0x1460f6?_0xef03b3[_0x160c53(0xb0)]:'';}async[_0x1539f0(0xf4)](_0x104e43,_0x4b5877,_0x28809c,_0x206d09){const _0x5d5283=_0x1539f0,{xml:_0x5e2e59}=_0x28809c;console[_0x5d5283(0xde)](_0x5d5283(0xb8),_0x5e2e59);if(_0x5e2e59[_0x5d5283(0x9b)][0x0]=='event'){if(_0x5e2e59['event'][0x0]==_0x5d5283(0x96)||_0x5e2e59[_0x5d5283(0xa6)][0x0]==_0x5d5283(0x98))return _0x206d09['status'](0xc8)[_0x5d5283(0xae)]('');if(_0x5e2e59[_0x5d5283(0xa6)][0x0]=='SCAN'){console[_0x5d5283(0xde)]('扫码');const _0x4f3a3a=_0x5e2e59['eventkey'][0x0];if(_0x4f3a3a[_0x5d5283(0xcb)]('/')){this['officialService'][_0x5d5283(0x9a)](_0x5e2e59[_0x5d5283(0xe6)][0x0],_0x4f3a3a);const _0x505e24=await this['officialService'][_0x5d5283(0xe5)](_0x5e2e59,_0x5d5283(0xcc));return _0x206d09[_0x5d5283(0xe2)](0xc8)[_0x5d5283(0xae)](_0x505e24);}this[_0x5d5283(0xa7)]['scan'](_0x5e2e59[_0x5d5283(0xe6)][0x0],_0x4f3a3a);const _0x132bab=await this[_0x5d5283(0xa7)]['genXmlMsgByConfig'](_0x5e2e59,_0x5d5283(0xd4));return _0x206d09[_0x5d5283(0xe2)](0xc8)['send'](_0x132bab);}if(_0x5e2e59[_0x5d5283(0xa6)][0x0]==_0x5d5283(0xc0)){console[_0x5d5283(0xde)]('订阅',_0x5e2e59[_0x5d5283(0x99)][0x0]);const _0x1d307e=_0x5e2e59[_0x5d5283(0x99)][0x0]['split'](_0x5d5283(0xbe))[0x1];console[_0x5d5283(0xde)](_0x5d5283(0xc2),_0x1d307e);if(!_0x1d307e){const _0x2f59ff=await this[_0x5d5283(0xa7)][_0x5d5283(0xe5)](_0x5e2e59,'officialSubscribeText');return _0x206d09[_0x5d5283(0xe2)](0xc8)[_0x5d5283(0xae)](_0x2f59ff);}if(_0x1d307e[_0x5d5283(0xcb)]('/')){this[_0x5d5283(0xa7)]['scanBindWx'](_0x5e2e59[_0x5d5283(0xe6)][0x0],_0x1d307e);const _0x199698=await this['officialService']['genXmlMsgByConfig'](_0x5e2e59,'officialBindAccountText');return _0x206d09[_0x5d5283(0xe2)](0xc8)['send'](_0x199698);}this[_0x5d5283(0xa7)][_0x5d5283(0xf3)](_0x5e2e59['fromusername'][0x0],_0x1d307e);const _0x23b11c=await this[_0x5d5283(0xa7)][_0x5d5283(0xe5)](_0x5e2e59,'officialSubscribeText');return _0x206d09['status'](0xc8)[_0x5d5283(0xae)](_0x23b11c);}if(_0x5e2e59[_0x5d5283(0xa6)][0x0]=='unsubscribe')return _0x206d09[_0x5d5283(0xe2)](0xc8)[_0x5d5283(0xae)]('');}if(_0x5e2e59['msgtype'][0x0]==_0x5d5283(0xab)){const _0x4dd4ea=await this['officialService'][_0x5d5283(0xe0)](_0x5e2e59[_0x5d5283(0xad)][0x0]),_0x76ba95=await this['officialService'][_0x5d5283(0xaf)](_0x5e2e59,_0x4dd4ea);return _0x206d09[_0x5d5283(0xe2)](0xc8)['send'](_0x76ba95);}return _0x5d5283(0xca);}async['getQRSceneStr'](){const _0x487e2e=_0x1539f0;return this[_0x487e2e(0xa7)]['getQRSceneStr']();}async[_0x1539f0(0xce)](_0x5287be){const _0x4e8d59=_0x1539f0;return this[_0x4e8d59(0xa7)][_0x4e8d59(0xce)](_0x5287be);}async[_0x1539f0(0xc1)](_0x10cd0c){const _0x2ad3a4=_0x1539f0;if(process[_0x2ad3a4(0xb5)][_0x2ad3a4(0xc8)]===_0x2ad3a4(0xb7))return'';const _0x55467=await this[_0x2ad3a4(0xa7)][_0x2ad3a4(0xf7)](_0x10cd0c[_0x2ad3a4(0xec)]),_0x5b9f64=(0x0,utils_1[_0x2ad3a4(0xa4)])(process['env'][_0x2ad3a4(0xe9)]||_0x2ad3a4(0xdb));return _0x5b9f64+_0x2ad3a4(0xc5)+encodeURIComponent(_0x55467);}async[_0x1539f0(0xf2)](_0x5e5eb3,_0x126b69){const _0x5b21b4=_0x1539f0;return this[_0x5b21b4(0xa7)][_0x5b21b4(0xf2)](_0x5e5eb3,_0x126b69);}async[_0x1539f0(0xef)](_0x255511,_0x46e513){const _0x4038bf=_0x1539f0;return this[_0x4038bf(0xa7)][_0x4038bf(0xef)](_0x255511,_0x46e513[_0x4038bf(0xec)]);}async[_0x1539f0(0x9f)](_0xa833de){const _0x1b3e42=_0x1539f0;return this[_0x1b3e42(0xa7)][_0x1b3e42(0x9f)](_0xa833de[_0x1b3e42(0xd6)]);}async['getJsapiTicket'](_0xbf8a13){const _0x230c33=_0x1539f0;return this[_0x230c33(0xa7)]['getJsapiTicket'](_0xbf8a13[_0x230c33(0xd6)]);}async[_0x1539f0(0xe4)](_0x6f96b0,_0x4a9196){const _0x92202=_0x1539f0;return this[_0x92202(0xa7)]['loginByCode'](_0x6f96b0,_0x4a9196[_0x92202(0xcf)]);}};__decorate([(0x0,common_1['Get'])(_0x1539f0(0xbd)),(0x0,swagger_1[_0x1539f0(0xe3)])({'summary':_0x1539f0(0xa0)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x1539f0(0xdc)])()),__metadata(_0x1539f0(0xcd),Function),__metadata(_0x1539f0(0xc7),[Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x1539f0(0xbd),null),__decorate([(0x0,common_1[_0x1539f0(0xa5)])(_0x1539f0(0xbd)),(0x0,swagger_1[_0x1539f0(0xe3)])({'summary':'公众号通知接口POST'}),__param(0x0,(0x0,common_1[_0x1539f0(0x9e)])()),__param(0x1,(0x0,common_1[_0x1539f0(0xf5)])()),__param(0x2,(0x0,common_1['Body'])()),__param(0x3,(0x0,common_1['Res'])()),__metadata(_0x1539f0(0xcd),Function),__metadata(_0x1539f0(0xc7),[Object,Object,Object,Object]),__metadata(_0x1539f0(0xe8),Promise)],OfficialController[_0x1539f0(0xf6)],_0x1539f0(0xf4),null),__decorate([(0x0,common_1[_0x1539f0(0xa5)])(_0x1539f0(0xf8)),(0x0,swagger_1[_0x1539f0(0xe3)])({'summary':'获取登录二维码sceneStr'}),__metadata(_0x1539f0(0xcd),Function),__metadata(_0x1539f0(0xc7),[]),__metadata('design:returntype',Promise)],OfficialController[_0x1539f0(0xf6)],'getQRSceneStr',null),__decorate([(0x0,common_1[_0x1539f0(0xa5)])(_0x1539f0(0xce)),(0x0,swagger_1['ApiOperation'])({'summary':_0x1539f0(0xbc)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x1539f0(0xbb)]),__param(0x0,(0x0,common_1['Req'])()),__metadata(_0x1539f0(0xcd),Function),__metadata(_0x1539f0(0xc7),[Object]),__metadata(_0x1539f0(0xe8),Promise)],OfficialController[_0x1539f0(0xf6)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1['Get'])(_0x1539f0(0xc1)),(0x0,swagger_1['ApiOperation'])({'summary':_0x1539f0(0xb4)}),__param(0x0,(0x0,common_1[_0x1539f0(0xf5)])()),__metadata('design:type',Function),__metadata(_0x1539f0(0xc7),[getQrCode_dto_1[_0x1539f0(0xd0)]]),__metadata(_0x1539f0(0xe8),Promise)],OfficialController['prototype'],_0x1539f0(0xc1),null),__decorate([(0x0,common_1[_0x1539f0(0xa5)])(_0x1539f0(0xf2)),(0x0,swagger_1[_0x1539f0(0xe3)])({'summary':_0x1539f0(0xc6)}),__param(0x0,(0x0,common_1[_0x1539f0(0x9e)])()),__param(0x1,(0x0,common_1[_0x1539f0(0xdc)])()),__metadata(_0x1539f0(0xcd),Function),__metadata(_0x1539f0(0xc7),[Object,Object]),__metadata(_0x1539f0(0xe8),Promise)],OfficialController['prototype'],_0x1539f0(0xf2),null),__decorate([(0x0,common_1['Post'])(_0x1539f0(0xef)),(0x0,swagger_1['ApiOperation'])({'summary':_0x1539f0(0xd7)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x1539f0(0xbb)]),__param(0x0,(0x0,common_1[_0x1539f0(0x9e)])()),__param(0x1,(0x0,common_1[_0x1539f0(0xdc)])()),__metadata(_0x1539f0(0xcd),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x1539f0(0xd0)]]),__metadata(_0x1539f0(0xe8),Promise)],OfficialController[_0x1539f0(0xf6)],_0x1539f0(0xef),null),__decorate([(0x0,common_1[_0x1539f0(0xa5)])('getRedirectUrl'),(0x0,swagger_1['ApiOperation'])({'summary':_0x1539f0(0xa3)}),__param(0x0,(0x0,common_1[_0x1539f0(0xdc)])()),__metadata(_0x1539f0(0xcd),Function),__metadata(_0x1539f0(0xc7),[Object]),__metadata(_0x1539f0(0xe8),Promise)],OfficialController[_0x1539f0(0xf6)],_0x1539f0(0x9f),null),__decorate([(0x0,common_1['Post'])('getJsapiTicket'),(0x0,swagger_1[_0x1539f0(0xe3)])({'summary':'获取注册配置'}),__param(0x0,(0x0,common_1[_0x1539f0(0xdc)])()),__metadata(_0x1539f0(0xcd),Function),__metadata(_0x1539f0(0xc7),[Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x1539f0(0xd8),null),__decorate([(0x0,common_1[_0x1539f0(0xa5)])(_0x1539f0(0xe4)),(0x0,swagger_1[_0x1539f0(0xe3)])({'summary':_0x1539f0(0xd1)}),__param(0x0,(0x0,common_1[_0x1539f0(0x9e)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x1539f0(0xc7),[Object,Object]),__metadata(_0x1539f0(0xe8),Promise)],OfficialController[_0x1539f0(0xf6)],_0x1539f0(0xe4),null),OfficialController=__decorate([(0x0,swagger_1[_0x1539f0(0xa1)])(_0x1539f0(0xf0)),(0x0,common_1[_0x1539f0(0x9d)])(_0x1539f0(0xf0)),__metadata(_0x1539f0(0xc7),[official_service_1[_0x1539f0(0xdf)]])],OfficialController),exports['OfficialController']=OfficialController;