'use strict';function _0x577e(_0x4ad959,_0x21a55c){const _0x17d312=_0x17d3();return _0x577e=function(_0x577ec3,_0x4b07f6){_0x577ec3=_0x577ec3-0xc6;let _0x44640b=_0x17d312[_0x577ec3];return _0x44640b;},_0x577e(_0x4ad959,_0x21a55c);}const _0x463f7d=_0x577e;(function(_0x21b9db,_0x519ff1){const _0x16ad0b=_0x577e,_0xcfc22a=_0x21b9db();while(!![]){try{const _0x12587b=-parseInt(_0x16ad0b(0x10c))/0x1+parseInt(_0x16ad0b(0x123))/0x2+parseInt(_0x16ad0b(0x103))/0x3+-parseInt(_0x16ad0b(0x11e))/0x4+parseInt(_0x16ad0b(0xec))/0x5+parseInt(_0x16ad0b(0xe8))/0x6+parseInt(_0x16ad0b(0x107))/0x7;if(_0x12587b===_0x519ff1)break;else _0xcfc22a['push'](_0xcfc22a['shift']());}catch(_0x10267a){_0xcfc22a['push'](_0xcfc22a['shift']());}}}(_0x17d3,0x284aa));var __decorate=this&&this[_0x463f7d(0xf4)]||function(_0x2b02fe,_0x9da3de,_0x2b2855,_0x12f8d7){const _0x52e404=_0x463f7d;var _0x20a971=arguments[_0x52e404(0xfa)],_0xb6252d=_0x20a971<0x3?_0x9da3de:_0x12f8d7===null?_0x12f8d7=Object[_0x52e404(0x121)](_0x9da3de,_0x2b2855):_0x12f8d7,_0x39143b;if(typeof Reflect===_0x52e404(0xde)&&typeof Reflect[_0x52e404(0x109)]===_0x52e404(0x102))_0xb6252d=Reflect[_0x52e404(0x109)](_0x2b02fe,_0x9da3de,_0x2b2855,_0x12f8d7);else{for(var _0x1ef9e5=_0x2b02fe['length']-0x1;_0x1ef9e5>=0x0;_0x1ef9e5--)if(_0x39143b=_0x2b02fe[_0x1ef9e5])_0xb6252d=(_0x20a971<0x3?_0x39143b(_0xb6252d):_0x20a971>0x3?_0x39143b(_0x9da3de,_0x2b2855,_0xb6252d):_0x39143b(_0x9da3de,_0x2b2855))||_0xb6252d;}return _0x20a971>0x3&&_0xb6252d&&Object[_0x52e404(0x116)](_0x9da3de,_0x2b2855,_0xb6252d),_0xb6252d;},__metadata=this&&this[_0x463f7d(0xcf)]||function(_0x3cd871,_0x3d92ea){const _0x25b322=_0x463f7d;if(typeof Reflect===_0x25b322(0xde)&&typeof Reflect[_0x25b322(0x117)]==='function')return Reflect[_0x25b322(0x117)](_0x3cd871,_0x3d92ea);},__param=this&&this[_0x463f7d(0xff)]||function(_0xfe8a19,_0x4ec6e6){return function(_0x1828d5,_0x29157c){_0x4ec6e6(_0x1828d5,_0x29157c,_0xfe8a19);};};function _0x17d3(){const _0x9fa545=['__decorate','xml:\x20','@nestjs/common','scan','env','officialSubscribeText','length','sceneStr:\x20','OfficialController','GetQrCodeDto','getRedirectUrl','__param','OfficialService','url','function','639204rXzRZT','TRUE','loginByCode','formatUrl','864822byaGUO','Controller','decorate','design:paramtypes','log','258677tqfODa','Query','event','scanBindWx','getQRCodeTicket','send','getJsapiTicket','../../common/auth/jwtAuth.guard','SCAN','get\x20通知>>>','defineProperty','metadata','genXmlMsg','Get','获取注册配置','status','Post','getQRCode','1006348igZyJB','includes','获取登录跳转地址','getOwnPropertyDescriptor','UseGuards','29336wCaerj','获取二维码','officialService','JwtAuthGuard','subscribe','bindWxBySceneStr','ApiTags','sceneStr','./official.service','success','公众号通知接口GET','unsubscribe','Body','signature','__metadata','Res','getQRSceneStr','genXmlMsgByConfig','design:type','officialScanLoginText','loginBySceneStr','fromusername','./dto/getQrCode.dto','公众号静默登录','/cgi-bin/showqrcode?ticket=','official','design:returntype','VIEW','@nestjs/swagger','object','notify','eventkey','weChatMpUrl','扫码绑定轮询查询','公众号通知接口POST','timestamp','getQRSceneStrByBind','text','content','725064ecPLkj','qrscene_','CLICK','ApiOperation','1015860HJXhsO','Req','prototype','获取绑定二维码的sceneStr','code','officialBindAccountText','msgtype','../../common/utils'];_0x17d3=function(){return _0x9fa545;};return _0x17d3();}Object[_0x463f7d(0x116)](exports,'__esModule',{'value':!![]}),exports[_0x463f7d(0xfc)]=void 0x0;const jwtAuth_guard_1=require(_0x463f7d(0x113)),utils_1=require(_0x463f7d(0xf3)),common_1=require(_0x463f7d(0xf6)),swagger_1=require(_0x463f7d(0xdd)),getQrCode_dto_1=require(_0x463f7d(0xd7)),official_service_1=require(_0x463f7d(0xc9));let OfficialController=class OfficialController{constructor(_0x87d649){const _0xe7867a=_0x463f7d;this[_0xe7867a(0x125)]=_0x87d649;}async[_0x463f7d(0xdf)](_0x5afe92,_0x1335c1,_0xa1c444){const _0xad874d=_0x463f7d;console[_0xad874d(0x10b)](_0xad874d(0x115),_0x1335c1,_0xa1c444);const _0x4d5b7e=await this[_0xad874d(0x125)]['verify'](_0x1335c1[_0xad874d(0xce)],_0x1335c1['nonce'],_0x1335c1[_0xad874d(0xe4)]);return _0x4d5b7e?_0x1335c1['echostr']:'';}async['notifyPost'](_0x12edb9,_0x43d04d,_0x5d9778,_0x5dd6df){const _0x49eaca=_0x463f7d,{xml:_0x4528f1}=_0x5d9778;console[_0x49eaca(0x10b)](_0x49eaca(0xf5),_0x4528f1);if(_0x4528f1[_0x49eaca(0xf2)][0x0]==_0x49eaca(0x10e)){if(_0x4528f1[_0x49eaca(0x10e)][0x0]==_0x49eaca(0xdc)||_0x4528f1[_0x49eaca(0x10e)][0x0]==_0x49eaca(0xea))return _0x5dd6df[_0x49eaca(0x11b)](0xc8)[_0x49eaca(0x111)]('');if(_0x4528f1['event'][0x0]==_0x49eaca(0x114)){console[_0x49eaca(0x10b)]('扫码');const _0x547809=_0x4528f1[_0x49eaca(0xe0)][0x0];if(_0x547809[_0x49eaca(0x11f)]('/')){this[_0x49eaca(0x125)][_0x49eaca(0x10f)](_0x4528f1[_0x49eaca(0xd6)][0x0],_0x547809);const _0x2b6aff=await this[_0x49eaca(0x125)]['genXmlMsgByConfig'](_0x4528f1,_0x49eaca(0xf1));return _0x5dd6df[_0x49eaca(0x11b)](0xc8)['send'](_0x2b6aff);}this[_0x49eaca(0x125)][_0x49eaca(0xf7)](_0x4528f1[_0x49eaca(0xd6)][0x0],_0x547809);const _0x51f8d2=await this[_0x49eaca(0x125)]['genXmlMsgByConfig'](_0x4528f1,_0x49eaca(0xd4));return _0x5dd6df[_0x49eaca(0x11b)](0xc8)[_0x49eaca(0x111)](_0x51f8d2);}if(_0x4528f1[_0x49eaca(0x10e)][0x0]==_0x49eaca(0x127)){console[_0x49eaca(0x10b)]('订阅',_0x4528f1[_0x49eaca(0xe0)][0x0]);const _0x376212=_0x4528f1[_0x49eaca(0xe0)][0x0]['split'](_0x49eaca(0xe9))[0x1];console['log'](_0x49eaca(0xfb),_0x376212);if(!_0x376212){const _0x1ab157=await this['officialService'][_0x49eaca(0xd2)](_0x4528f1,_0x49eaca(0xf9));return _0x5dd6df[_0x49eaca(0x11b)](0xc8)[_0x49eaca(0x111)](_0x1ab157);}if(_0x376212[_0x49eaca(0x11f)]('/')){this[_0x49eaca(0x125)][_0x49eaca(0x10f)](_0x4528f1[_0x49eaca(0xd6)][0x0],_0x376212);const _0x1af237=await this[_0x49eaca(0x125)]['genXmlMsgByConfig'](_0x4528f1,_0x49eaca(0xf1));return _0x5dd6df[_0x49eaca(0x11b)](0xc8)['send'](_0x1af237);}this[_0x49eaca(0x125)]['scan'](_0x4528f1['fromusername'][0x0],_0x376212);const _0x43377b=await this[_0x49eaca(0x125)][_0x49eaca(0xd2)](_0x4528f1,_0x49eaca(0xf9));return _0x5dd6df['status'](0xc8)[_0x49eaca(0x111)](_0x43377b);}if(_0x4528f1[_0x49eaca(0x10e)][0x0]==_0x49eaca(0xcc))return _0x5dd6df['status'](0xc8)['send']('');}if(_0x4528f1[_0x49eaca(0xf2)][0x0]==_0x49eaca(0xe6)){const _0x50fd3a=await this[_0x49eaca(0x125)]['aotoPlay'](_0x4528f1[_0x49eaca(0xe7)][0x0]),_0x51e8e6=await this['officialService'][_0x49eaca(0x118)](_0x4528f1,_0x50fd3a);return _0x5dd6df['status'](0xc8)[_0x49eaca(0x111)](_0x51e8e6);}return _0x49eaca(0xca);}async[_0x463f7d(0xd1)](){const _0x3491e3=_0x463f7d;return this[_0x3491e3(0x125)][_0x3491e3(0xd1)]();}async[_0x463f7d(0xe5)](_0x4e2fb0){const _0x3aa3a5=_0x463f7d;return this[_0x3aa3a5(0x125)]['getQRSceneStrByBind'](_0x4e2fb0);}async['getQRCode'](_0x489657){const _0x42e159=_0x463f7d;if(process[_0x42e159(0xf8)]['ISDEV']===_0x42e159(0x104))return'';const _0x19e3dc=await this['officialService'][_0x42e159(0x110)](_0x489657[_0x42e159(0xc8)]),_0x15b1de=(0x0,utils_1[_0x42e159(0x106)])(process[_0x42e159(0xf8)][_0x42e159(0xe1)]||'https://mp.weixin.qq.com');return _0x15b1de+_0x42e159(0xd9)+encodeURIComponent(_0x19e3dc);}async[_0x463f7d(0xd5)](_0x1d6cd6,_0x4f62a1){const _0x2f8c25=_0x463f7d;return this[_0x2f8c25(0x125)]['loginBySceneStr'](_0x1d6cd6,_0x4f62a1);}async['bindWxBySceneStr'](_0x5e5ba9,_0x5e38ef){const _0x138c02=_0x463f7d;return this['officialService'][_0x138c02(0xc6)](_0x5e5ba9,_0x5e38ef[_0x138c02(0xc8)]);}async[_0x463f7d(0xfe)](_0x1f02e5){const _0x5bde31=_0x463f7d;return this[_0x5bde31(0x125)][_0x5bde31(0xfe)](_0x1f02e5[_0x5bde31(0x101)]);}async[_0x463f7d(0x112)](_0x4e49ee){const _0x56870f=_0x463f7d;return this[_0x56870f(0x125)][_0x56870f(0x112)](_0x4e49ee['url']);}async[_0x463f7d(0x105)](_0x32c019,_0x264f98){const _0x107cd0=_0x463f7d;return this[_0x107cd0(0x125)][_0x107cd0(0x105)](_0x32c019,_0x264f98[_0x107cd0(0xf0)]);}};__decorate([(0x0,common_1[_0x463f7d(0x119)])('notify'),(0x0,swagger_1[_0x463f7d(0xeb)])({'summary':_0x463f7d(0xcb)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x463f7d(0x10d)])()),__param(0x2,(0x0,common_1[_0x463f7d(0xcd)])()),__metadata(_0x463f7d(0xd3),Function),__metadata(_0x463f7d(0x10a),[Object,Object,Object]),__metadata(_0x463f7d(0xdb),Promise)],OfficialController[_0x463f7d(0xee)],_0x463f7d(0xdf),null),__decorate([(0x0,common_1['Post'])(_0x463f7d(0xdf)),(0x0,swagger_1[_0x463f7d(0xeb)])({'summary':_0x463f7d(0xe3)}),__param(0x0,(0x0,common_1[_0x463f7d(0xed)])()),__param(0x1,(0x0,common_1[_0x463f7d(0x10d)])()),__param(0x2,(0x0,common_1[_0x463f7d(0xcd)])()),__param(0x3,(0x0,common_1[_0x463f7d(0xd0)])()),__metadata(_0x463f7d(0xd3),Function),__metadata(_0x463f7d(0x10a),[Object,Object,Object,Object]),__metadata(_0x463f7d(0xdb),Promise)],OfficialController[_0x463f7d(0xee)],'notifyPost',null),__decorate([(0x0,common_1[_0x463f7d(0x11c)])(_0x463f7d(0xd1)),(0x0,swagger_1['ApiOperation'])({'summary':'获取登录二维码sceneStr'}),__metadata(_0x463f7d(0xd3),Function),__metadata(_0x463f7d(0x10a),[]),__metadata('design:returntype',Promise)],OfficialController[_0x463f7d(0xee)],_0x463f7d(0xd1),null),__decorate([(0x0,common_1['Post'])(_0x463f7d(0xe5)),(0x0,swagger_1[_0x463f7d(0xeb)])({'summary':_0x463f7d(0xef)}),(0x0,common_1[_0x463f7d(0x122)])(jwtAuth_guard_1[_0x463f7d(0x126)]),__param(0x0,(0x0,common_1[_0x463f7d(0xed)])()),__metadata(_0x463f7d(0xd3),Function),__metadata(_0x463f7d(0x10a),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x463f7d(0xee)],_0x463f7d(0xe5),null),__decorate([(0x0,common_1['Get'])('getQRCode'),(0x0,swagger_1['ApiOperation'])({'summary':_0x463f7d(0x124)}),__param(0x0,(0x0,common_1[_0x463f7d(0x10d)])()),__metadata(_0x463f7d(0xd3),Function),__metadata(_0x463f7d(0x10a),[getQrCode_dto_1[_0x463f7d(0xfd)]]),__metadata(_0x463f7d(0xdb),Promise)],OfficialController[_0x463f7d(0xee)],_0x463f7d(0x11d),null),__decorate([(0x0,common_1[_0x463f7d(0x11c)])(_0x463f7d(0xd5)),(0x0,swagger_1[_0x463f7d(0xeb)])({'summary':'扫码登录轮询查询'}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x463f7d(0xd3),Function),__metadata(_0x463f7d(0x10a),[Object,Object]),__metadata(_0x463f7d(0xdb),Promise)],OfficialController['prototype'],_0x463f7d(0xd5),null),__decorate([(0x0,common_1['Post'])(_0x463f7d(0xc6)),(0x0,swagger_1[_0x463f7d(0xeb)])({'summary':_0x463f7d(0xe2)}),(0x0,common_1[_0x463f7d(0x122)])(jwtAuth_guard_1[_0x463f7d(0x126)]),__param(0x0,(0x0,common_1[_0x463f7d(0xed)])()),__param(0x1,(0x0,common_1[_0x463f7d(0xcd)])()),__metadata(_0x463f7d(0xd3),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x463f7d(0xdb),Promise)],OfficialController['prototype'],_0x463f7d(0xc6),null),__decorate([(0x0,common_1[_0x463f7d(0x11c)])(_0x463f7d(0xfe)),(0x0,swagger_1[_0x463f7d(0xeb)])({'summary':_0x463f7d(0x120)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x463f7d(0xd3),Function),__metadata(_0x463f7d(0x10a),[Object]),__metadata(_0x463f7d(0xdb),Promise)],OfficialController[_0x463f7d(0xee)],'getRedirectUrl',null),__decorate([(0x0,common_1[_0x463f7d(0x11c)])(_0x463f7d(0x112)),(0x0,swagger_1[_0x463f7d(0xeb)])({'summary':_0x463f7d(0x11a)}),__param(0x0,(0x0,common_1[_0x463f7d(0xcd)])()),__metadata(_0x463f7d(0xd3),Function),__metadata(_0x463f7d(0x10a),[Object]),__metadata(_0x463f7d(0xdb),Promise)],OfficialController[_0x463f7d(0xee)],_0x463f7d(0x112),null),__decorate([(0x0,common_1[_0x463f7d(0x11c)])(_0x463f7d(0x105)),(0x0,swagger_1[_0x463f7d(0xeb)])({'summary':_0x463f7d(0xd8)}),__param(0x0,(0x0,common_1[_0x463f7d(0xed)])()),__param(0x1,(0x0,common_1[_0x463f7d(0xcd)])()),__metadata(_0x463f7d(0xd3),Function),__metadata(_0x463f7d(0x10a),[Object,Object]),__metadata(_0x463f7d(0xdb),Promise)],OfficialController[_0x463f7d(0xee)],_0x463f7d(0x105),null),OfficialController=__decorate([(0x0,swagger_1[_0x463f7d(0xc7)])(_0x463f7d(0xda)),(0x0,common_1[_0x463f7d(0x108)])(_0x463f7d(0xda)),__metadata(_0x463f7d(0x10a),[official_service_1[_0x463f7d(0x100)]])],OfficialController),exports[_0x463f7d(0xfc)]=OfficialController;