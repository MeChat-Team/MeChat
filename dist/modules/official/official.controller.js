'use strict';const _0x5b6f51=_0x1cac;function _0x1cac(_0x25850e,_0x594694){const _0xf2507d=_0xf250();return _0x1cac=function(_0x1cac55,_0x522782){_0x1cac55=_0x1cac55-0x1c6;let _0x1b98cf=_0xf2507d[_0x1cac55];return _0x1b98cf;},_0x1cac(_0x25850e,_0x594694);}(function(_0x4c2f21,_0x5a6108){const _0x399587=_0x1cac,_0x2c95fe=_0x4c2f21();while(!![]){try{const _0x5c068c=parseInt(_0x399587(0x207))/0x1+parseInt(_0x399587(0x1f2))/0x2*(parseInt(_0x399587(0x20a))/0x3)+-parseInt(_0x399587(0x200))/0x4+-parseInt(_0x399587(0x1e3))/0x5*(-parseInt(_0x399587(0x1cd))/0x6)+-parseInt(_0x399587(0x1ec))/0x7*(parseInt(_0x399587(0x1d1))/0x8)+parseInt(_0x399587(0x202))/0x9*(parseInt(_0x399587(0x1fe))/0xa)+-parseInt(_0x399587(0x1f1))/0xb;if(_0x5c068c===_0x5a6108)break;else _0x2c95fe['push'](_0x2c95fe['shift']());}catch(_0x321599){_0x2c95fe['push'](_0x2c95fe['shift']());}}}(_0xf250,0xa5fcb));var __decorate=this&&this['__decorate']||function(_0x3263e3,_0x197eb3,_0x59699b,_0x5f3aaa){const _0x4c7825=_0x1cac;var _0x19d52b=arguments[_0x4c7825(0x20f)],_0x5456a7=_0x19d52b<0x3?_0x197eb3:_0x5f3aaa===null?_0x5f3aaa=Object[_0x4c7825(0x1e6)](_0x197eb3,_0x59699b):_0x5f3aaa,_0x3fbbf3;if(typeof Reflect==='object'&&typeof Reflect[_0x4c7825(0x1db)]===_0x4c7825(0x221))_0x5456a7=Reflect[_0x4c7825(0x1db)](_0x3263e3,_0x197eb3,_0x59699b,_0x5f3aaa);else{for(var _0x5bbed4=_0x3263e3['length']-0x1;_0x5bbed4>=0x0;_0x5bbed4--)if(_0x3fbbf3=_0x3263e3[_0x5bbed4])_0x5456a7=(_0x19d52b<0x3?_0x3fbbf3(_0x5456a7):_0x19d52b>0x3?_0x3fbbf3(_0x197eb3,_0x59699b,_0x5456a7):_0x3fbbf3(_0x197eb3,_0x59699b))||_0x5456a7;}return _0x19d52b>0x3&&_0x5456a7&&Object[_0x4c7825(0x1e0)](_0x197eb3,_0x59699b,_0x5456a7),_0x5456a7;},__metadata=this&&this[_0x5b6f51(0x213)]||function(_0x416ec4,_0x312d5f){const _0x111cd5=_0x5b6f51;if(typeof Reflect===_0x111cd5(0x1f9)&&typeof Reflect[_0x111cd5(0x206)]===_0x111cd5(0x221))return Reflect[_0x111cd5(0x206)](_0x416ec4,_0x312d5f);},__param=this&&this[_0x5b6f51(0x1f6)]||function(_0x2200bc,_0x5b8919){return function(_0x318304,_0x1b4bff){_0x5b8919(_0x318304,_0x1b4bff,_0x2200bc);};};Object['defineProperty'](exports,_0x5b6f51(0x208),{'value':!![]}),exports['OfficialController']=void 0x0;const jwtAuth_guard_1=require('../../common/auth/jwtAuth.guard'),utils_1=require(_0x5b6f51(0x204)),common_1=require('@nestjs/common'),swagger_1=require(_0x5b6f51(0x1d7)),getQrCode_dto_1=require(_0x5b6f51(0x1c6)),official_service_1=require('./official.service');let OfficialController=class OfficialController{constructor(_0x5e46ae){const _0x40a2d7=_0x5b6f51;this[_0x40a2d7(0x212)]=_0x5e46ae;}async[_0x5b6f51(0x219)](_0x597d1a,_0x42a68c,_0x1120fb){const _0x413437=_0x5b6f51;console[_0x413437(0x214)](_0x413437(0x21e),_0x42a68c,_0x1120fb);const _0x3954f4=await this[_0x413437(0x212)][_0x413437(0x218)](_0x42a68c[_0x413437(0x1e1)],_0x42a68c['nonce'],_0x42a68c['timestamp']);return _0x3954f4?_0x42a68c['echostr']:'';}async[_0x5b6f51(0x20d)](_0x46090e,_0x36cff5,_0x40a391,_0x96f9fd){const _0x5234c8=_0x5b6f51,{xml:_0x456c80}=_0x40a391;console[_0x5234c8(0x214)](_0x5234c8(0x203),_0x456c80);if(_0x456c80['msgtype'][0x0]==_0x5234c8(0x20b)){if(_0x456c80[_0x5234c8(0x20b)][0x0]==_0x5234c8(0x21c)||_0x456c80[_0x5234c8(0x20b)][0x0]==_0x5234c8(0x1eb))return _0x96f9fd[_0x5234c8(0x1d9)](0xc8)[_0x5234c8(0x1fd)]('');if(_0x456c80[_0x5234c8(0x20b)][0x0]==_0x5234c8(0x216)){console['log']('扫码');const _0x16424e=_0x456c80['eventkey'][0x0];if(_0x16424e[_0x5234c8(0x1ea)]('/')){this[_0x5234c8(0x212)][_0x5234c8(0x205)](_0x456c80[_0x5234c8(0x1ed)][0x0],_0x16424e);const _0x140dce=await this['officialService'][_0x5234c8(0x1cc)](_0x456c80,_0x5234c8(0x215));return _0x96f9fd['status'](0xc8)[_0x5234c8(0x1fd)](_0x140dce);}this['officialService'][_0x5234c8(0x21a)](_0x456c80[_0x5234c8(0x1ed)][0x0],_0x16424e);const _0xd8307e=await this[_0x5234c8(0x212)]['genXmlMsgByConfig'](_0x456c80,_0x5234c8(0x1cf));return _0x96f9fd[_0x5234c8(0x1d9)](0xc8)['send'](_0xd8307e);}if(_0x456c80[_0x5234c8(0x20b)][0x0]==_0x5234c8(0x20c)){console['log']('订阅',_0x456c80[_0x5234c8(0x1d2)][0x0]);const _0x25e668=_0x456c80['eventkey'][0x0][_0x5234c8(0x1ee)](_0x5234c8(0x222))[0x1];console[_0x5234c8(0x214)](_0x5234c8(0x1e2),_0x25e668);if(!_0x25e668){const _0x2e3dc1=await this[_0x5234c8(0x212)][_0x5234c8(0x1cc)](_0x456c80,_0x5234c8(0x21d));return _0x96f9fd[_0x5234c8(0x1d9)](0xc8)[_0x5234c8(0x1fd)](_0x2e3dc1);}if(_0x25e668[_0x5234c8(0x1ea)]('/')){this[_0x5234c8(0x212)]['scanBindWx'](_0x456c80['fromusername'][0x0],_0x25e668);const _0x386bd2=await this[_0x5234c8(0x212)][_0x5234c8(0x1cc)](_0x456c80,'officialBindAccountText');return _0x96f9fd[_0x5234c8(0x1d9)](0xc8)[_0x5234c8(0x1fd)](_0x386bd2);}this[_0x5234c8(0x212)][_0x5234c8(0x21a)](_0x456c80[_0x5234c8(0x1ed)][0x0],_0x25e668);const _0x2110bf=await this[_0x5234c8(0x212)][_0x5234c8(0x1cc)](_0x456c80,_0x5234c8(0x21d));return _0x96f9fd[_0x5234c8(0x1d9)](0xc8)['send'](_0x2110bf);}if(_0x456c80[_0x5234c8(0x20b)][0x0]=='unsubscribe')return _0x96f9fd[_0x5234c8(0x1d9)](0xc8)[_0x5234c8(0x1fd)]('');}if(_0x456c80[_0x5234c8(0x21b)][0x0]==_0x5234c8(0x1cb)){const _0x279f3b=await this[_0x5234c8(0x212)][_0x5234c8(0x211)](_0x456c80[_0x5234c8(0x1d3)][0x0]),_0x35c316=await this[_0x5234c8(0x212)][_0x5234c8(0x1c9)](_0x456c80,_0x279f3b);return _0x96f9fd[_0x5234c8(0x1d9)](0xc8)[_0x5234c8(0x1fd)](_0x35c316);}return _0x5234c8(0x1f5);}async['getQRSceneStr'](){const _0x5ce6d1=_0x5b6f51;return this['officialService'][_0x5ce6d1(0x1f7)]();}async[_0x5b6f51(0x1de)](_0x43bf98){const _0x28a6ee=_0x5b6f51;return this[_0x28a6ee(0x212)][_0x28a6ee(0x1de)](_0x43bf98);}async['getQRCode'](_0x4b3c0d){const _0x31f363=_0x5b6f51;if(process[_0x31f363(0x20e)]['ISDEV']===_0x31f363(0x1d0))return'';const _0x137dd9=await this['officialService'][_0x31f363(0x223)](_0x4b3c0d[_0x31f363(0x1f4)]),_0x5b4ea2=(0x0,utils_1[_0x31f363(0x1e5)])(process['env']['weChatMpUrl']||_0x31f363(0x210));return _0x5b4ea2+_0x31f363(0x1f8)+encodeURIComponent(_0x137dd9);}async[_0x5b6f51(0x1c7)](_0x57c97b,_0x109995){const _0x4a25ba=_0x5b6f51;return this[_0x4a25ba(0x212)][_0x4a25ba(0x1c7)](_0x57c97b,_0x109995);}async[_0x5b6f51(0x1df)](_0x162aa4,_0x1275fd){const _0x572122=_0x5b6f51;return this[_0x572122(0x212)][_0x572122(0x1df)](_0x162aa4,_0x1275fd[_0x572122(0x1f4)]);}async['getRedirectUrl'](_0x22f47f){const _0x5d8164=_0x5b6f51;return this[_0x5d8164(0x212)][_0x5d8164(0x209)](_0x22f47f['url']);}async[_0x5b6f51(0x21f)](_0x2eb2c2){const _0xbabee3=_0x5b6f51;return this[_0xbabee3(0x212)]['getJsapiTicket'](_0x2eb2c2['url']);}async[_0x5b6f51(0x1fa)](_0x295a5d,_0x371f81){const _0x1a000b=_0x5b6f51;return this[_0x1a000b(0x212)]['loginByCode'](_0x295a5d,_0x371f81['code']);}};function _0xf250(){const _0x4af873=['公众号静默登录','2151hLjbmB','xml:\x20','../../common/utils','scanBindWx','metadata','1281865qImSfn','__esModule','getRedirectUrl','64797ebTgLZ','event','subscribe','notifyPost','env','length','https://mp.weixin.qq.com','aotoPlay','officialService','__metadata','log','officialBindAccountText','SCAN','ApiOperation','verify','notify','scan','msgtype','VIEW','officialSubscribeText','get\x20通知>>>','getJsapiTicket','获取二维码','function','qrscene_','getQRCodeTicket','./dto/getQrCode.dto','loginBySceneStr','design:paramtypes','genXmlMsg','Controller','text','genXmlMsgByConfig','6iWYhRb','Get','officialScanLoginText','TRUE','8uNOQsG','eventkey','content','Req','公众号通知接口POST','Post','@nestjs/swagger','Res','status','design:type','decorate','获取注册配置','JwtAuthGuard','getQRSceneStrByBind','bindWxBySceneStr','defineProperty','signature','sceneStr:\x20','2448160LevfIJ','Body','formatUrl','getOwnPropertyDescriptor','GetQrCodeDto','扫码绑定轮询查询','prototype','includes','CLICK','4620749YuaHBv','fromusername','split','获取登录跳转地址','Query','12615240FWzgzi','116vpffGQ','official','sceneStr','success','__param','getQRSceneStr','/cgi-bin/showqrcode?ticket=','object','loginByCode','ApiTags','design:returntype','send','13030mudWyd','OfficialController','3395304zUdTfZ'];_0xf250=function(){return _0x4af873;};return _0xf250();}__decorate([(0x0,common_1[_0x5b6f51(0x1ce)])(_0x5b6f51(0x219)),(0x0,swagger_1[_0x5b6f51(0x217)])({'summary':'公众号通知接口GET'}),__param(0x0,(0x0,common_1[_0x5b6f51(0x1d4)])()),__param(0x1,(0x0,common_1[_0x5b6f51(0x1f0)])()),__param(0x2,(0x0,common_1[_0x5b6f51(0x1e4)])()),__metadata(_0x5b6f51(0x1da),Function),__metadata('design:paramtypes',[Object,Object,Object]),__metadata(_0x5b6f51(0x1fc),Promise)],OfficialController[_0x5b6f51(0x1e9)],'notify',null),__decorate([(0x0,common_1['Post'])(_0x5b6f51(0x219)),(0x0,swagger_1[_0x5b6f51(0x217)])({'summary':_0x5b6f51(0x1d5)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x5b6f51(0x1e4)])()),__param(0x3,(0x0,common_1[_0x5b6f51(0x1d8)])()),__metadata(_0x5b6f51(0x1da),Function),__metadata(_0x5b6f51(0x1c8),[Object,Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x5b6f51(0x1e9)],_0x5b6f51(0x20d),null),__decorate([(0x0,common_1[_0x5b6f51(0x1d6)])(_0x5b6f51(0x1f7)),(0x0,swagger_1[_0x5b6f51(0x217)])({'summary':'获取登录二维码sceneStr'}),__metadata(_0x5b6f51(0x1da),Function),__metadata('design:paramtypes',[]),__metadata(_0x5b6f51(0x1fc),Promise)],OfficialController['prototype'],_0x5b6f51(0x1f7),null),__decorate([(0x0,common_1['Post'])('getQRSceneStrByBind'),(0x0,swagger_1[_0x5b6f51(0x217)])({'summary':'获取绑定二维码的sceneStr'}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x5b6f51(0x1dd)]),__param(0x0,(0x0,common_1['Req'])()),__metadata(_0x5b6f51(0x1da),Function),__metadata(_0x5b6f51(0x1c8),[Object]),__metadata(_0x5b6f51(0x1fc),Promise)],OfficialController[_0x5b6f51(0x1e9)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1[_0x5b6f51(0x1ce)])('getQRCode'),(0x0,swagger_1['ApiOperation'])({'summary':_0x5b6f51(0x220)}),__param(0x0,(0x0,common_1[_0x5b6f51(0x1f0)])()),__metadata(_0x5b6f51(0x1da),Function),__metadata('design:paramtypes',[getQrCode_dto_1['GetQrCodeDto']]),__metadata('design:returntype',Promise)],OfficialController[_0x5b6f51(0x1e9)],'getQRCode',null),__decorate([(0x0,common_1[_0x5b6f51(0x1d6)])(_0x5b6f51(0x1c7)),(0x0,swagger_1['ApiOperation'])({'summary':'扫码登录轮询查询'}),__param(0x0,(0x0,common_1[_0x5b6f51(0x1d4)])()),__param(0x1,(0x0,common_1[_0x5b6f51(0x1e4)])()),__metadata(_0x5b6f51(0x1da),Function),__metadata(_0x5b6f51(0x1c8),[Object,Object]),__metadata(_0x5b6f51(0x1fc),Promise)],OfficialController[_0x5b6f51(0x1e9)],_0x5b6f51(0x1c7),null),__decorate([(0x0,common_1['Post'])(_0x5b6f51(0x1df)),(0x0,swagger_1[_0x5b6f51(0x217)])({'summary':_0x5b6f51(0x1e8)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x5b6f51(0x1dd)]),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x5b6f51(0x1e4)])()),__metadata('design:type',Function),__metadata(_0x5b6f51(0x1c8),[Object,getQrCode_dto_1[_0x5b6f51(0x1e7)]]),__metadata(_0x5b6f51(0x1fc),Promise)],OfficialController[_0x5b6f51(0x1e9)],'bindWxBySceneStr',null),__decorate([(0x0,common_1[_0x5b6f51(0x1d6)])('getRedirectUrl'),(0x0,swagger_1[_0x5b6f51(0x217)])({'summary':_0x5b6f51(0x1ef)}),__param(0x0,(0x0,common_1[_0x5b6f51(0x1e4)])()),__metadata('design:type',Function),__metadata(_0x5b6f51(0x1c8),[Object]),__metadata(_0x5b6f51(0x1fc),Promise)],OfficialController[_0x5b6f51(0x1e9)],_0x5b6f51(0x209),null),__decorate([(0x0,common_1[_0x5b6f51(0x1d6)])(_0x5b6f51(0x21f)),(0x0,swagger_1[_0x5b6f51(0x217)])({'summary':_0x5b6f51(0x1dc)}),__param(0x0,(0x0,common_1[_0x5b6f51(0x1e4)])()),__metadata(_0x5b6f51(0x1da),Function),__metadata(_0x5b6f51(0x1c8),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x5b6f51(0x1e9)],_0x5b6f51(0x21f),null),__decorate([(0x0,common_1[_0x5b6f51(0x1d6)])(_0x5b6f51(0x1fa)),(0x0,swagger_1[_0x5b6f51(0x217)])({'summary':_0x5b6f51(0x201)}),__param(0x0,(0x0,common_1[_0x5b6f51(0x1d4)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x5b6f51(0x1da),Function),__metadata(_0x5b6f51(0x1c8),[Object,Object]),__metadata(_0x5b6f51(0x1fc),Promise)],OfficialController[_0x5b6f51(0x1e9)],_0x5b6f51(0x1fa),null),OfficialController=__decorate([(0x0,swagger_1[_0x5b6f51(0x1fb)])('official'),(0x0,common_1[_0x5b6f51(0x1ca)])(_0x5b6f51(0x1f3)),__metadata(_0x5b6f51(0x1c8),[official_service_1['OfficialService']])],OfficialController),exports[_0x5b6f51(0x1ff)]=OfficialController;