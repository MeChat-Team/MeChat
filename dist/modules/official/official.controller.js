'use strict';const _0x97443e=_0x28a1;(function(_0x459666,_0x1f0409){const _0x45b1ce=_0x28a1,_0x2eb46f=_0x459666();while(!![]){try{const _0x3f520e=parseInt(_0x45b1ce(0x1a6))/0x1*(parseInt(_0x45b1ce(0x16d))/0x2)+parseInt(_0x45b1ce(0x198))/0x3+parseInt(_0x45b1ce(0x1bb))/0x4*(-parseInt(_0x45b1ce(0x196))/0x5)+-parseInt(_0x45b1ce(0x18f))/0x6*(parseInt(_0x45b1ce(0x16e))/0x7)+parseInt(_0x45b1ce(0x1b6))/0x8*(-parseInt(_0x45b1ce(0x166))/0x9)+parseInt(_0x45b1ce(0x1b4))/0xa+parseInt(_0x45b1ce(0x1b7))/0xb*(parseInt(_0x45b1ce(0x193))/0xc);if(_0x3f520e===_0x1f0409)break;else _0x2eb46f['push'](_0x2eb46f['shift']());}catch(_0x4683cb){_0x2eb46f['push'](_0x2eb46f['shift']());}}}(_0x2e63,0x66cfa));var __decorate=this&&this[_0x97443e(0x1a1)]||function(_0x599665,_0x4c760c,_0x4dff2f,_0xd1e335){const _0x5ab2af=_0x97443e;var _0x5dd0ad=arguments[_0x5ab2af(0x164)],_0x2531ac=_0x5dd0ad<0x3?_0x4c760c:_0xd1e335===null?_0xd1e335=Object['getOwnPropertyDescriptor'](_0x4c760c,_0x4dff2f):_0xd1e335,_0x383c39;if(typeof Reflect===_0x5ab2af(0x1af)&&typeof Reflect[_0x5ab2af(0x189)]===_0x5ab2af(0x179))_0x2531ac=Reflect[_0x5ab2af(0x189)](_0x599665,_0x4c760c,_0x4dff2f,_0xd1e335);else{for(var _0x1f0481=_0x599665[_0x5ab2af(0x164)]-0x1;_0x1f0481>=0x0;_0x1f0481--)if(_0x383c39=_0x599665[_0x1f0481])_0x2531ac=(_0x5dd0ad<0x3?_0x383c39(_0x2531ac):_0x5dd0ad>0x3?_0x383c39(_0x4c760c,_0x4dff2f,_0x2531ac):_0x383c39(_0x4c760c,_0x4dff2f))||_0x2531ac;}return _0x5dd0ad>0x3&&_0x2531ac&&Object['defineProperty'](_0x4c760c,_0x4dff2f,_0x2531ac),_0x2531ac;},__metadata=this&&this[_0x97443e(0x1ae)]||function(_0x4b87ef,_0x3cea3a){const _0x3e0106=_0x97443e;if(typeof Reflect===_0x3e0106(0x1af)&&typeof Reflect['metadata']==='function')return Reflect[_0x3e0106(0x183)](_0x4b87ef,_0x3cea3a);},__param=this&&this[_0x97443e(0x1bd)]||function(_0x53a08e,_0x31dd18){return function(_0x5591e4,_0x1691c9){_0x31dd18(_0x5591e4,_0x1691c9,_0x53a08e);};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['OfficialController']=void 0x0;const jwtAuth_guard_1=require('../../common/auth/jwtAuth.guard'),utils_1=require('../../common/utils'),common_1=require('@nestjs/common'),swagger_1=require(_0x97443e(0x162)),getQrCode_dto_1=require('./dto/getQrCode.dto'),official_service_1=require(_0x97443e(0x1b3));let OfficialController=class OfficialController{constructor(_0x4732bd){const _0x32ba0a=_0x97443e;this[_0x32ba0a(0x176)]=_0x4732bd;}async['notify'](_0x19cb75,_0x4a7364,_0x5d7519){const _0x1c0325=_0x97443e;console['log'](_0x1c0325(0x161),_0x4a7364,_0x5d7519);const _0x7050ab=await this[_0x1c0325(0x176)][_0x1c0325(0x1a2)](_0x4a7364['signature'],_0x4a7364[_0x1c0325(0x169)],_0x4a7364[_0x1c0325(0x190)]);return _0x7050ab?_0x4a7364[_0x1c0325(0x16c)]:'';}async[_0x97443e(0x1bc)](_0x567354,_0x37d4fb,_0x3274f8,_0x1325fd){const _0x4cc6e9=_0x97443e,{xml:_0x40633c}=_0x3274f8;console[_0x4cc6e9(0x1b1)]('xml:\x20',_0x40633c);if(_0x40633c['msgtype'][0x0]==_0x4cc6e9(0x1ba)){if(_0x40633c[_0x4cc6e9(0x1ba)][0x0]==_0x4cc6e9(0x180)||_0x40633c['event'][0x0]==_0x4cc6e9(0x181))return _0x1325fd[_0x4cc6e9(0x1ad)](0xc8)[_0x4cc6e9(0x185)]('');if(_0x40633c['event'][0x0]==_0x4cc6e9(0x168)){console[_0x4cc6e9(0x1b1)]('扫码');const _0x382294=_0x40633c[_0x4cc6e9(0x19d)][0x0];if(_0x382294[_0x4cc6e9(0x17b)]('/')){this['officialService'][_0x4cc6e9(0x19a)](_0x40633c[_0x4cc6e9(0x186)][0x0],_0x382294);const _0x2a79d9=await this[_0x4cc6e9(0x176)][_0x4cc6e9(0x18d)](_0x40633c,_0x4cc6e9(0x197));return _0x1325fd[_0x4cc6e9(0x1ad)](0xc8)['send'](_0x2a79d9);}this['officialService']['scan'](_0x40633c[_0x4cc6e9(0x186)][0x0],_0x382294);const _0x5b1629=await this['officialService']['genXmlMsgByConfig'](_0x40633c,_0x4cc6e9(0x173));return _0x1325fd[_0x4cc6e9(0x1ad)](0xc8)[_0x4cc6e9(0x185)](_0x5b1629);}if(_0x40633c[_0x4cc6e9(0x1ba)][0x0]=='subscribe'){console[_0x4cc6e9(0x1b1)]('订阅',_0x40633c[_0x4cc6e9(0x19d)][0x0]);const _0xd89ba1=_0x40633c['eventkey'][0x0]['split']('qrscene_')[0x1];console[_0x4cc6e9(0x1b1)](_0x4cc6e9(0x1b0),_0xd89ba1);if(!_0xd89ba1){const _0x50f27b=await this[_0x4cc6e9(0x176)]['genXmlMsgByConfig'](_0x40633c,_0x4cc6e9(0x178));return _0x1325fd[_0x4cc6e9(0x1ad)](0xc8)['send'](_0x50f27b);}if(_0xd89ba1[_0x4cc6e9(0x17b)]('/')){this[_0x4cc6e9(0x176)][_0x4cc6e9(0x19a)](_0x40633c[_0x4cc6e9(0x186)][0x0],_0xd89ba1);const _0x4bd371=await this[_0x4cc6e9(0x176)]['genXmlMsgByConfig'](_0x40633c,_0x4cc6e9(0x197));return _0x1325fd[_0x4cc6e9(0x1ad)](0xc8)[_0x4cc6e9(0x185)](_0x4bd371);}this['officialService'][_0x4cc6e9(0x19e)](_0x40633c[_0x4cc6e9(0x186)][0x0],_0xd89ba1);const _0x54dc75=await this[_0x4cc6e9(0x176)]['genXmlMsgByConfig'](_0x40633c,'officialSubscribeText');return _0x1325fd['status'](0xc8)[_0x4cc6e9(0x185)](_0x54dc75);}if(_0x40633c[_0x4cc6e9(0x1ba)][0x0]=='unsubscribe')return _0x1325fd['status'](0xc8)[_0x4cc6e9(0x185)]('');}if(_0x40633c[_0x4cc6e9(0x1a7)][0x0]==_0x4cc6e9(0x1a5)){const _0x37aea1=await this[_0x4cc6e9(0x176)][_0x4cc6e9(0x16b)](_0x40633c[_0x4cc6e9(0x194)][0x0]),_0xdb70bc=await this['officialService'][_0x4cc6e9(0x1b8)](_0x40633c,_0x37aea1);return _0x1325fd[_0x4cc6e9(0x1ad)](0xc8)['send'](_0xdb70bc);}return _0x4cc6e9(0x163);}async[_0x97443e(0x1a0)](){const _0x198df3=_0x97443e;return this[_0x198df3(0x176)][_0x198df3(0x1a0)]();}async[_0x97443e(0x1b5)](_0x523c18){const _0x185d5c=_0x97443e;return this['officialService'][_0x185d5c(0x1b5)](_0x523c18);}async[_0x97443e(0x18c)](_0x2283b0){const _0x26207f=_0x97443e;if(process['env']['ISDEV']===_0x26207f(0x18b))return'';const _0x1a77b8=await this[_0x26207f(0x176)][_0x26207f(0x171)](_0x2283b0[_0x26207f(0x170)]),_0xfeee4=(0x0,utils_1[_0x26207f(0x17d)])(process[_0x26207f(0x18e)][_0x26207f(0x1a3)]||_0x26207f(0x1b2));return _0xfeee4+'/cgi-bin/showqrcode?ticket='+encodeURIComponent(_0x1a77b8);}async[_0x97443e(0x172)](_0xfbbc4e,_0x1c810b){const _0x120e20=_0x97443e;return this[_0x120e20(0x176)][_0x120e20(0x172)](_0xfbbc4e,_0x1c810b);}async[_0x97443e(0x160)](_0x14e67c,_0x4f154d){const _0x4998a9=_0x97443e;return this['officialService']['bindWxBySceneStr'](_0x14e67c,_0x4f154d[_0x4998a9(0x170)]);}async[_0x97443e(0x188)](_0x335798){const _0x5b9edb=_0x97443e;return this['officialService'][_0x5b9edb(0x188)](_0x335798[_0x5b9edb(0x16f)]);}async['getJsapiTicket'](_0x286c60){const _0x1ac9f7=_0x97443e;return this[_0x1ac9f7(0x176)][_0x1ac9f7(0x1ac)](_0x286c60[_0x1ac9f7(0x16f)]);}async[_0x97443e(0x19c)](_0x297c62,_0x2e0419){const _0x572698=_0x97443e;return this[_0x572698(0x176)]['loginByCode'](_0x297c62,_0x2e0419[_0x572698(0x17c)]);}};function _0x28a1(_0x3710f5,_0x3b5124){const _0x2e63fb=_0x2e63();return _0x28a1=function(_0x28a1d5,_0xc96486){_0x28a1d5=_0x28a1d5-0x160;let _0x3a0da1=_0x2e63fb[_0x28a1d5];return _0x3a0da1;},_0x28a1(_0x3710f5,_0x3b5124);}function _0x2e63(){const _0xd4832f=['formatUrl','Controller','公众号通知接口GET','VIEW','CLICK','获取注册配置','metadata','获取二维码','send','fromusername','JwtAuthGuard','getRedirectUrl','decorate','design:paramtypes','TRUE','getQRCode','genXmlMsgByConfig','env','57738hpLoMA','timestamp','OfficialController','design:type','2711748qdQySs','content','Post','308435AvNmtS','officialBindAccountText','337887FAJSTZ','Query','scanBindWx','ApiOperation','loginByCode','eventkey','scan','ApiTags','getQRSceneStr','__decorate','verify','weChatMpUrl','GetQrCodeDto','text','283775rsnMXD','msgtype','notify','Get','获取绑定二维码的sceneStr','Res','getJsapiTicket','status','__metadata','object','sceneStr:\x20','log','https://mp.weixin.qq.com','./official.service','2303380CmkyXB','getQRSceneStrByBind','1893624LzzuMI','99nPtdLu','genXmlMsg','Req','event','48hzfXbw','notifyPost','__param','UseGuards','bindWxBySceneStr','get\x20通知>>>','@nestjs/swagger','success','length','Body','27zUHrmI','design:returntype','SCAN','nonce','official','aotoPlay','echostr','2XsYFpA','574yQKwpm','url','sceneStr','getQRCodeTicket','loginBySceneStr','officialScanLoginText','prototype','扫码绑定轮询查询','officialService','扫码登录轮询查询','officialSubscribeText','function','公众号通知接口POST','includes','code'];_0x2e63=function(){return _0xd4832f;};return _0x2e63();}__decorate([(0x0,common_1[_0x97443e(0x1a9)])(_0x97443e(0x1a8)),(0x0,swagger_1[_0x97443e(0x19b)])({'summary':_0x97443e(0x17f)}),__param(0x0,(0x0,common_1[_0x97443e(0x1b9)])()),__param(0x1,(0x0,common_1[_0x97443e(0x199)])()),__param(0x2,(0x0,common_1[_0x97443e(0x165)])()),__metadata(_0x97443e(0x192),Function),__metadata(_0x97443e(0x18a),[Object,Object,Object]),__metadata(_0x97443e(0x167),Promise)],OfficialController[_0x97443e(0x174)],_0x97443e(0x1a8),null),__decorate([(0x0,common_1['Post'])(_0x97443e(0x1a8)),(0x0,swagger_1[_0x97443e(0x19b)])({'summary':_0x97443e(0x17a)}),__param(0x0,(0x0,common_1[_0x97443e(0x1b9)])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x97443e(0x165)])()),__param(0x3,(0x0,common_1[_0x97443e(0x1ab)])()),__metadata('design:type',Function),__metadata(_0x97443e(0x18a),[Object,Object,Object,Object]),__metadata(_0x97443e(0x167),Promise)],OfficialController[_0x97443e(0x174)],_0x97443e(0x1bc),null),__decorate([(0x0,common_1[_0x97443e(0x195)])(_0x97443e(0x1a0)),(0x0,swagger_1[_0x97443e(0x19b)])({'summary':'获取登录二维码sceneStr'}),__metadata(_0x97443e(0x192),Function),__metadata(_0x97443e(0x18a),[]),__metadata(_0x97443e(0x167),Promise)],OfficialController[_0x97443e(0x174)],_0x97443e(0x1a0),null),__decorate([(0x0,common_1[_0x97443e(0x195)])(_0x97443e(0x1b5)),(0x0,swagger_1[_0x97443e(0x19b)])({'summary':_0x97443e(0x1aa)}),(0x0,common_1[_0x97443e(0x1be)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1['Req'])()),__metadata(_0x97443e(0x192),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x97443e(0x167),Promise)],OfficialController['prototype'],'getQRSceneStrByBind',null),__decorate([(0x0,common_1[_0x97443e(0x1a9)])('getQRCode'),(0x0,swagger_1[_0x97443e(0x19b)])({'summary':_0x97443e(0x184)}),__param(0x0,(0x0,common_1[_0x97443e(0x199)])()),__metadata(_0x97443e(0x192),Function),__metadata(_0x97443e(0x18a),[getQrCode_dto_1[_0x97443e(0x1a4)]]),__metadata('design:returntype',Promise)],OfficialController[_0x97443e(0x174)],_0x97443e(0x18c),null),__decorate([(0x0,common_1[_0x97443e(0x195)])(_0x97443e(0x172)),(0x0,swagger_1['ApiOperation'])({'summary':_0x97443e(0x177)}),__param(0x0,(0x0,common_1[_0x97443e(0x1b9)])()),__param(0x1,(0x0,common_1[_0x97443e(0x165)])()),__metadata('design:type',Function),__metadata(_0x97443e(0x18a),[Object,Object]),__metadata(_0x97443e(0x167),Promise)],OfficialController[_0x97443e(0x174)],_0x97443e(0x172),null),__decorate([(0x0,common_1[_0x97443e(0x195)])(_0x97443e(0x160)),(0x0,swagger_1[_0x97443e(0x19b)])({'summary':_0x97443e(0x175)}),(0x0,common_1[_0x97443e(0x1be)])(jwtAuth_guard_1[_0x97443e(0x187)]),__param(0x0,(0x0,common_1[_0x97443e(0x1b9)])()),__param(0x1,(0x0,common_1[_0x97443e(0x165)])()),__metadata(_0x97443e(0x192),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x97443e(0x1a4)]]),__metadata(_0x97443e(0x167),Promise)],OfficialController['prototype'],'bindWxBySceneStr',null),__decorate([(0x0,common_1[_0x97443e(0x195)])('getRedirectUrl'),(0x0,swagger_1[_0x97443e(0x19b)])({'summary':'获取登录跳转地址'}),__param(0x0,(0x0,common_1[_0x97443e(0x165)])()),__metadata(_0x97443e(0x192),Function),__metadata(_0x97443e(0x18a),[Object]),__metadata(_0x97443e(0x167),Promise)],OfficialController[_0x97443e(0x174)],_0x97443e(0x188),null),__decorate([(0x0,common_1[_0x97443e(0x195)])('getJsapiTicket'),(0x0,swagger_1['ApiOperation'])({'summary':_0x97443e(0x182)}),__param(0x0,(0x0,common_1[_0x97443e(0x165)])()),__metadata(_0x97443e(0x192),Function),__metadata(_0x97443e(0x18a),[Object]),__metadata(_0x97443e(0x167),Promise)],OfficialController[_0x97443e(0x174)],_0x97443e(0x1ac),null),__decorate([(0x0,common_1[_0x97443e(0x195)])(_0x97443e(0x19c)),(0x0,swagger_1['ApiOperation'])({'summary':'公众号静默登录'}),__param(0x0,(0x0,common_1[_0x97443e(0x1b9)])()),__param(0x1,(0x0,common_1[_0x97443e(0x165)])()),__metadata(_0x97443e(0x192),Function),__metadata(_0x97443e(0x18a),[Object,Object]),__metadata(_0x97443e(0x167),Promise)],OfficialController[_0x97443e(0x174)],_0x97443e(0x19c),null),OfficialController=__decorate([(0x0,swagger_1[_0x97443e(0x19f)])('official'),(0x0,common_1[_0x97443e(0x17e)])(_0x97443e(0x16a)),__metadata(_0x97443e(0x18a),[official_service_1['OfficialService']])],OfficialController),exports[_0x97443e(0x191)]=OfficialController;