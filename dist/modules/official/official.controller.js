'use strict';const _0x16c0c7=_0xd33b;(function(_0x312c4e,_0x47d263){const _0x17985e=_0xd33b,_0xc4c875=_0x312c4e();while(!![]){try{const _0x2e39a9=-parseInt(_0x17985e(0x198))/0x1+-parseInt(_0x17985e(0x1ac))/0x2*(-parseInt(_0x17985e(0x1a1))/0x3)+parseInt(_0x17985e(0x1ce))/0x4+parseInt(_0x17985e(0x19a))/0x5*(-parseInt(_0x17985e(0x1a5))/0x6)+-parseInt(_0x17985e(0x1c2))/0x7+-parseInt(_0x17985e(0x1dd))/0x8+parseInt(_0x17985e(0x19f))/0x9;if(_0x2e39a9===_0x47d263)break;else _0xc4c875['push'](_0xc4c875['shift']());}catch(_0xc2d5a5){_0xc4c875['push'](_0xc4c875['shift']());}}}(_0x1646,0xbefee));function _0x1646(){const _0x366985=['unsubscribe','echostr','ISDEV','text','split','../../common/auth/jwtAuth.guard','OfficialController','ApiOperation','scanBindWx','url','getJsapiTicket','Req','559293dxpDur','design:paramtypes','5LxaIOZ','genXmlMsgByConfig','JwtAuthGuard','sceneStr','signature','28521171EbRqmV','object','4317RvSTTC','loginByCode','__param','scan','4562742JQGxge','getQRSceneStrByBind','VIEW','Body','length','code','__esModule','1958XuBqub','metadata','__decorate','design:returntype','Controller','getQRCode','msgtype','official','timestamp','xml:\x20','officialSubscribeText','SCAN','function','includes','getQRSceneStr','qrscene_','GetQrCodeDto','ApiTags','loginBySceneStr','officialService','decorate','Post','10935239KbcLNh','notifyPost','Get','OfficialService','__metadata','sceneStr:\x20','扫码登录轮询查询','getOwnPropertyDescriptor','log','Query','https://mp.weixin.qq.com','subscribe','1506452ujYnwf','获取登录跳转地址','../../common/utils','./dto/getQrCode.dto','eventkey','env','get\x20通知>>>','UseGuards','event','status','扫码绑定轮询查询','获取二维码','send','/cgi-bin/showqrcode?ticket=','defineProperty','10321344bUWknM','prototype','bindWxBySceneStr','officialScanLoginText','获取登录二维码sceneStr','genXmlMsg','Res','fromusername','design:type','getRedirectUrl','获取注册配置','./official.service'];_0x1646=function(){return _0x366985;};return _0x1646();}var __decorate=this&&this[_0x16c0c7(0x1ae)]||function(_0x1f2bbe,_0x58bfbf,_0x4e98ef,_0x169ac6){const _0x1e6c25=_0x16c0c7;var _0x5d0806=arguments[_0x1e6c25(0x1a9)],_0x8ff8f6=_0x5d0806<0x3?_0x58bfbf:_0x169ac6===null?_0x169ac6=Object[_0x1e6c25(0x1c9)](_0x58bfbf,_0x4e98ef):_0x169ac6,_0x4cc350;if(typeof Reflect===_0x1e6c25(0x1a0)&&typeof Reflect[_0x1e6c25(0x1c0)]===_0x1e6c25(0x1b8))_0x8ff8f6=Reflect[_0x1e6c25(0x1c0)](_0x1f2bbe,_0x58bfbf,_0x4e98ef,_0x169ac6);else{for(var _0x5bc5f0=_0x1f2bbe['length']-0x1;_0x5bc5f0>=0x0;_0x5bc5f0--)if(_0x4cc350=_0x1f2bbe[_0x5bc5f0])_0x8ff8f6=(_0x5d0806<0x3?_0x4cc350(_0x8ff8f6):_0x5d0806>0x3?_0x4cc350(_0x58bfbf,_0x4e98ef,_0x8ff8f6):_0x4cc350(_0x58bfbf,_0x4e98ef))||_0x8ff8f6;}return _0x5d0806>0x3&&_0x8ff8f6&&Object[_0x1e6c25(0x1dc)](_0x58bfbf,_0x4e98ef,_0x8ff8f6),_0x8ff8f6;},__metadata=this&&this[_0x16c0c7(0x1c6)]||function(_0x4407a8,_0x2935d3){const _0x1a873a=_0x16c0c7;if(typeof Reflect==='object'&&typeof Reflect[_0x1a873a(0x1ad)]==='function')return Reflect[_0x1a873a(0x1ad)](_0x4407a8,_0x2935d3);},__param=this&&this[_0x16c0c7(0x1a3)]||function(_0xe9bfca,_0x562020){return function(_0xca3fec,_0x381945){_0x562020(_0xca3fec,_0x381945,_0xe9bfca);};};Object[_0x16c0c7(0x1dc)](exports,_0x16c0c7(0x1ab),{'value':!![]}),exports[_0x16c0c7(0x192)]=void 0x0;const jwtAuth_guard_1=require(_0x16c0c7(0x191)),utils_1=require(_0x16c0c7(0x1d0)),common_1=require('@nestjs/common'),swagger_1=require('@nestjs/swagger'),getQrCode_dto_1=require(_0x16c0c7(0x1d1)),official_service_1=require(_0x16c0c7(0x18b));function _0xd33b(_0x19dc93,_0x28809e){const _0x16466f=_0x1646();return _0xd33b=function(_0xd33bff,_0x2e19e8){_0xd33bff=_0xd33bff-0x188;let _0x5e8924=_0x16466f[_0xd33bff];return _0x5e8924;},_0xd33b(_0x19dc93,_0x28809e);}let OfficialController=class OfficialController{constructor(_0x4ef01d){this['officialService']=_0x4ef01d;}async['notify'](_0xf7957a,_0xc83dd1,_0x234e05){const _0x4af11e=_0x16c0c7;console[_0x4af11e(0x1ca)](_0x4af11e(0x1d4),_0xc83dd1,_0x234e05);const _0x308b70=await this[_0x4af11e(0x1bf)]['verify'](_0xc83dd1[_0x4af11e(0x19e)],_0xc83dd1['nonce'],_0xc83dd1[_0x4af11e(0x1b4)]);return _0x308b70?_0xc83dd1[_0x4af11e(0x18d)]:'';}async[_0x16c0c7(0x1c3)](_0x13a519,_0x238ed2,_0x3724df,_0xa9a283){const _0x1eba0e=_0x16c0c7,{xml:_0x526c05}=_0x3724df;console[_0x1eba0e(0x1ca)](_0x1eba0e(0x1b5),_0x526c05);if(_0x526c05[_0x1eba0e(0x1b2)][0x0]==_0x1eba0e(0x1d6)){if(_0x526c05[_0x1eba0e(0x1d6)][0x0]==_0x1eba0e(0x1a7)||_0x526c05[_0x1eba0e(0x1d6)][0x0]=='CLICK')return _0xa9a283[_0x1eba0e(0x1d7)](0xc8)[_0x1eba0e(0x1da)]('');if(_0x526c05['event'][0x0]==_0x1eba0e(0x1b7)){console['log']('扫码');const _0x40cda5=_0x526c05['eventkey'][0x0];if(_0x40cda5['includes']('/')){this[_0x1eba0e(0x1bf)][_0x1eba0e(0x194)](_0x526c05['fromusername'][0x0],_0x40cda5);const _0x2e1e6d=await this[_0x1eba0e(0x1bf)][_0x1eba0e(0x19b)](_0x526c05,'officialBindAccountText');return _0xa9a283['status'](0xc8)[_0x1eba0e(0x1da)](_0x2e1e6d);}this[_0x1eba0e(0x1bf)][_0x1eba0e(0x1a4)](_0x526c05[_0x1eba0e(0x1e4)][0x0],_0x40cda5);const _0x46c026=await this[_0x1eba0e(0x1bf)][_0x1eba0e(0x19b)](_0x526c05,_0x1eba0e(0x1e0));return _0xa9a283['status'](0xc8)['send'](_0x46c026);}if(_0x526c05[_0x1eba0e(0x1d6)][0x0]==_0x1eba0e(0x1cd)){console[_0x1eba0e(0x1ca)]('订阅',_0x526c05[_0x1eba0e(0x1d2)][0x0]);const _0x492b27=_0x526c05[_0x1eba0e(0x1d2)][0x0][_0x1eba0e(0x190)](_0x1eba0e(0x1bb))[0x1];console[_0x1eba0e(0x1ca)](_0x1eba0e(0x1c7),_0x492b27);if(!_0x492b27){const _0x1b7f6e=await this[_0x1eba0e(0x1bf)][_0x1eba0e(0x19b)](_0x526c05,_0x1eba0e(0x1b6));return _0xa9a283['status'](0xc8)['send'](_0x1b7f6e);}if(_0x492b27[_0x1eba0e(0x1b9)]('/')){this[_0x1eba0e(0x1bf)][_0x1eba0e(0x194)](_0x526c05[_0x1eba0e(0x1e4)][0x0],_0x492b27);const _0x4231b5=await this['officialService'][_0x1eba0e(0x19b)](_0x526c05,'officialBindAccountText');return _0xa9a283[_0x1eba0e(0x1d7)](0xc8)['send'](_0x4231b5);}this['officialService'][_0x1eba0e(0x1a4)](_0x526c05[_0x1eba0e(0x1e4)][0x0],_0x492b27);const _0x4e8612=await this['officialService'][_0x1eba0e(0x19b)](_0x526c05,_0x1eba0e(0x1b6));return _0xa9a283['status'](0xc8)[_0x1eba0e(0x1da)](_0x4e8612);}if(_0x526c05['event'][0x0]==_0x1eba0e(0x18c))return _0xa9a283[_0x1eba0e(0x1d7)](0xc8)[_0x1eba0e(0x1da)]('');}if(_0x526c05[_0x1eba0e(0x1b2)][0x0]==_0x1eba0e(0x18f)){const _0x4e2097=await this[_0x1eba0e(0x1bf)]['aotoPlay'](_0x526c05['content'][0x0]),_0x58d12a=await this['officialService'][_0x1eba0e(0x1e2)](_0x526c05,_0x4e2097);return _0xa9a283[_0x1eba0e(0x1d7)](0xc8)[_0x1eba0e(0x1da)](_0x58d12a);}return'success';}async[_0x16c0c7(0x1ba)](){const _0x4af9aa=_0x16c0c7;return this[_0x4af9aa(0x1bf)][_0x4af9aa(0x1ba)]();}async[_0x16c0c7(0x1a6)](_0x4804d8){const _0x701d48=_0x16c0c7;return this[_0x701d48(0x1bf)]['getQRSceneStrByBind'](_0x4804d8);}async[_0x16c0c7(0x1b1)](_0x214552){const _0x3627b0=_0x16c0c7;if(process['env'][_0x3627b0(0x18e)]==='TRUE')return'';const _0x197f79=await this[_0x3627b0(0x1bf)]['getQRCodeTicket'](_0x214552[_0x3627b0(0x19d)]),_0x1cbf45=(0x0,utils_1['formatUrl'])(process[_0x3627b0(0x1d3)]['weChatMpUrl']||_0x3627b0(0x1cc));return _0x1cbf45+_0x3627b0(0x1db)+encodeURIComponent(_0x197f79);}async['loginBySceneStr'](_0xf39159,_0x5ef4c9){const _0x482a4f=_0x16c0c7;return this[_0x482a4f(0x1bf)][_0x482a4f(0x1be)](_0xf39159,_0x5ef4c9);}async[_0x16c0c7(0x1df)](_0x13ec08,_0x3fb98a){const _0x4d55a9=_0x16c0c7;return this['officialService'][_0x4d55a9(0x1df)](_0x13ec08,_0x3fb98a[_0x4d55a9(0x19d)]);}async['getRedirectUrl'](_0x1a7c2a){const _0x4cac4e=_0x16c0c7;return this['officialService'][_0x4cac4e(0x189)](_0x1a7c2a[_0x4cac4e(0x195)]);}async[_0x16c0c7(0x196)](_0x11bd28){const _0x2db1fd=_0x16c0c7;return this[_0x2db1fd(0x1bf)][_0x2db1fd(0x196)](_0x11bd28[_0x2db1fd(0x195)]);}async[_0x16c0c7(0x1a2)](_0x2eff28,_0x14bc05){const _0x1e6047=_0x16c0c7;return this[_0x1e6047(0x1bf)]['loginByCode'](_0x2eff28,_0x14bc05[_0x1e6047(0x1aa)]);}};__decorate([(0x0,common_1['Get'])('notify'),(0x0,swagger_1[_0x16c0c7(0x193)])({'summary':'公众号通知接口GET'}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x16c0c7(0x1cb)])()),__param(0x2,(0x0,common_1['Body'])()),__metadata(_0x16c0c7(0x188),Function),__metadata(_0x16c0c7(0x199),[Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x16c0c7(0x1de)],'notify',null),__decorate([(0x0,common_1[_0x16c0c7(0x1c1)])('notify'),(0x0,swagger_1['ApiOperation'])({'summary':'公众号通知接口POST'}),__param(0x0,(0x0,common_1[_0x16c0c7(0x197)])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x16c0c7(0x1a8)])()),__param(0x3,(0x0,common_1[_0x16c0c7(0x1e3)])()),__metadata(_0x16c0c7(0x188),Function),__metadata('design:paramtypes',[Object,Object,Object,Object]),__metadata(_0x16c0c7(0x1af),Promise)],OfficialController[_0x16c0c7(0x1de)],'notifyPost',null),__decorate([(0x0,common_1['Post'])('getQRSceneStr'),(0x0,swagger_1[_0x16c0c7(0x193)])({'summary':_0x16c0c7(0x1e1)}),__metadata(_0x16c0c7(0x188),Function),__metadata(_0x16c0c7(0x199),[]),__metadata(_0x16c0c7(0x1af),Promise)],OfficialController['prototype'],_0x16c0c7(0x1ba),null),__decorate([(0x0,common_1[_0x16c0c7(0x1c1)])('getQRSceneStrByBind'),(0x0,swagger_1[_0x16c0c7(0x193)])({'summary':'获取绑定二维码的sceneStr'}),(0x0,common_1[_0x16c0c7(0x1d5)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x16c0c7(0x197)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object]),__metadata(_0x16c0c7(0x1af),Promise)],OfficialController[_0x16c0c7(0x1de)],_0x16c0c7(0x1a6),null),__decorate([(0x0,common_1[_0x16c0c7(0x1c4)])('getQRCode'),(0x0,swagger_1['ApiOperation'])({'summary':_0x16c0c7(0x1d9)}),__param(0x0,(0x0,common_1[_0x16c0c7(0x1cb)])()),__metadata(_0x16c0c7(0x188),Function),__metadata(_0x16c0c7(0x199),[getQrCode_dto_1[_0x16c0c7(0x1bc)]]),__metadata(_0x16c0c7(0x1af),Promise)],OfficialController[_0x16c0c7(0x1de)],_0x16c0c7(0x1b1),null),__decorate([(0x0,common_1[_0x16c0c7(0x1c1)])('loginBySceneStr'),(0x0,swagger_1[_0x16c0c7(0x193)])({'summary':_0x16c0c7(0x1c8)}),__param(0x0,(0x0,common_1[_0x16c0c7(0x197)])()),__param(0x1,(0x0,common_1[_0x16c0c7(0x1a8)])()),__metadata('design:type',Function),__metadata(_0x16c0c7(0x199),[Object,Object]),__metadata(_0x16c0c7(0x1af),Promise)],OfficialController[_0x16c0c7(0x1de)],_0x16c0c7(0x1be),null),__decorate([(0x0,common_1[_0x16c0c7(0x1c1)])('bindWxBySceneStr'),(0x0,swagger_1[_0x16c0c7(0x193)])({'summary':_0x16c0c7(0x1d8)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x16c0c7(0x19c)]),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x16c0c7(0x1a8)])()),__metadata(_0x16c0c7(0x188),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x16c0c7(0x1bc)]]),__metadata('design:returntype',Promise)],OfficialController[_0x16c0c7(0x1de)],_0x16c0c7(0x1df),null),__decorate([(0x0,common_1[_0x16c0c7(0x1c1)])(_0x16c0c7(0x189)),(0x0,swagger_1[_0x16c0c7(0x193)])({'summary':_0x16c0c7(0x1cf)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x16c0c7(0x188),Function),__metadata(_0x16c0c7(0x199),[Object]),__metadata(_0x16c0c7(0x1af),Promise)],OfficialController[_0x16c0c7(0x1de)],_0x16c0c7(0x189),null),__decorate([(0x0,common_1[_0x16c0c7(0x1c1)])(_0x16c0c7(0x196)),(0x0,swagger_1[_0x16c0c7(0x193)])({'summary':_0x16c0c7(0x18a)}),__param(0x0,(0x0,common_1[_0x16c0c7(0x1a8)])()),__metadata(_0x16c0c7(0x188),Function),__metadata(_0x16c0c7(0x199),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x16c0c7(0x1de)],_0x16c0c7(0x196),null),__decorate([(0x0,common_1[_0x16c0c7(0x1c1)])(_0x16c0c7(0x1a2)),(0x0,swagger_1[_0x16c0c7(0x193)])({'summary':'公众号静默登录'}),__param(0x0,(0x0,common_1[_0x16c0c7(0x197)])()),__param(0x1,(0x0,common_1[_0x16c0c7(0x1a8)])()),__metadata(_0x16c0c7(0x188),Function),__metadata(_0x16c0c7(0x199),[Object,Object]),__metadata(_0x16c0c7(0x1af),Promise)],OfficialController[_0x16c0c7(0x1de)],_0x16c0c7(0x1a2),null),OfficialController=__decorate([(0x0,swagger_1[_0x16c0c7(0x1bd)])(_0x16c0c7(0x1b3)),(0x0,common_1[_0x16c0c7(0x1b0)])(_0x16c0c7(0x1b3)),__metadata(_0x16c0c7(0x199),[official_service_1[_0x16c0c7(0x1c5)]])],OfficialController),exports[_0x16c0c7(0x192)]=OfficialController;