'use strict';const _0x309c1e=_0x2366;(function(_0x1d357f,_0x144eef){const _0x3a2dd9=_0x2366,_0x4cdcee=_0x1d357f();while(!![]){try{const _0x4a1cd0=-parseInt(_0x3a2dd9(0x207))/0x1*(-parseInt(_0x3a2dd9(0x231))/0x2)+parseInt(_0x3a2dd9(0x210))/0x3*(-parseInt(_0x3a2dd9(0x21f))/0x4)+parseInt(_0x3a2dd9(0x1e1))/0x5+parseInt(_0x3a2dd9(0x1f3))/0x6*(-parseInt(_0x3a2dd9(0x1fa))/0x7)+parseInt(_0x3a2dd9(0x22c))/0x8+parseInt(_0x3a2dd9(0x20b))/0x9+-parseInt(_0x3a2dd9(0x1ff))/0xa*(parseInt(_0x3a2dd9(0x1ed))/0xb);if(_0x4a1cd0===_0x144eef)break;else _0x4cdcee['push'](_0x4cdcee['shift']());}catch(_0x804ec3){_0x4cdcee['push'](_0x4cdcee['shift']());}}}(_0x2202,0xad640));var __decorate=this&&this[_0x309c1e(0x1fe)]||function(_0x15e4b9,_0x479486,_0x1c1213,_0x51ea6e){const _0x31157e=_0x309c1e;var _0x261df1=arguments[_0x31157e(0x20e)],_0x4e55ff=_0x261df1<0x3?_0x479486:_0x51ea6e===null?_0x51ea6e=Object[_0x31157e(0x1db)](_0x479486,_0x1c1213):_0x51ea6e,_0x283274;if(typeof Reflect===_0x31157e(0x204)&&typeof Reflect[_0x31157e(0x1f9)]==='function')_0x4e55ff=Reflect[_0x31157e(0x1f9)](_0x15e4b9,_0x479486,_0x1c1213,_0x51ea6e);else{for(var _0x4e3766=_0x15e4b9[_0x31157e(0x20e)]-0x1;_0x4e3766>=0x0;_0x4e3766--)if(_0x283274=_0x15e4b9[_0x4e3766])_0x4e55ff=(_0x261df1<0x3?_0x283274(_0x4e55ff):_0x261df1>0x3?_0x283274(_0x479486,_0x1c1213,_0x4e55ff):_0x283274(_0x479486,_0x1c1213))||_0x4e55ff;}return _0x261df1>0x3&&_0x4e55ff&&Object['defineProperty'](_0x479486,_0x1c1213,_0x4e55ff),_0x4e55ff;},__metadata=this&&this[_0x309c1e(0x1eb)]||function(_0x44416b,_0x23e097){const _0x2ae183=_0x309c1e;if(typeof Reflect===_0x2ae183(0x204)&&typeof Reflect['metadata']===_0x2ae183(0x1e7))return Reflect[_0x2ae183(0x226)](_0x44416b,_0x23e097);},__param=this&&this['__param']||function(_0x2e81b2,_0x5643a6){return function(_0x2b4cdd,_0x1c965b){_0x5643a6(_0x2b4cdd,_0x1c965b,_0x2e81b2);};};function _0x2202(){const _0xd63977=['Res','eventkey','Controller','timestamp','VIEW','扫码登录轮询查询','echostr','Body','design:type','msgtype','getOwnPropertyDescriptor','verify','getQRCode','SCAN','Post','公众号静默登录','4769155EXQxwa','获取二维码','includes','fromusername','log','unsubscribe','function','loginByCode','get\x20通知>>>','https://mp.weixin.qq.com','__metadata','getQRSceneStr','2321EmuFwW','OfficialService','../../common/utils','notifyPost','getJsapiTicket','sceneStr:\x20','6bgpKzd','loginBySceneStr','sceneStr','genXmlMsgByConfig','Query','获取登录跳转地址','decorate','4108531iYNock','OfficialController','JwtAuthGuard','../../common/auth/jwtAuth.guard','__decorate','24510uGZiEn','defineProperty','formatUrl','./dto/getQrCode.dto','获取绑定二维码的sceneStr','object','公众号通知接口POST','xml:\x20','719441ZzRelg','prototype','扫码绑定轮询查询','ISDEV','7491087yRqXkL','scanBindWx','text','length','@nestjs/common','6lIXbuA','UseGuards','design:returntype','send','Req','officialBindAccountText','公众号通知接口GET','getQRSceneStrByBind','aotoPlay','official','Get','/cgi-bin/showqrcode?ticket=','event','TRUE','officialService','1509432CQlbzW','design:paramtypes','bindWxBySceneStr','officialScanLoginText','env','notify','status','metadata','ApiOperation','url','ApiTags','scan','GetQrCodeDto','507224dDOlRs','code','qrscene_','CLICK','success','2DfNolC'];_0x2202=function(){return _0xd63977;};return _0x2202();}Object[_0x309c1e(0x200)](exports,'__esModule',{'value':!![]}),exports[_0x309c1e(0x1fb)]=void 0x0;const jwtAuth_guard_1=require(_0x309c1e(0x1fd)),utils_1=require(_0x309c1e(0x1ef)),common_1=require(_0x309c1e(0x20f)),swagger_1=require('@nestjs/swagger'),getQrCode_dto_1=require(_0x309c1e(0x202)),official_service_1=require('./official.service');function _0x2366(_0x3d0bd8,_0x4b9501){const _0x22022d=_0x2202();return _0x2366=function(_0x236620,_0x17ae81){_0x236620=_0x236620-0x1d6;let _0x1bff29=_0x22022d[_0x236620];return _0x1bff29;},_0x2366(_0x3d0bd8,_0x4b9501);}let OfficialController=class OfficialController{constructor(_0x51107b){this['officialService']=_0x51107b;}async[_0x309c1e(0x224)](_0x39e67e,_0x140c16,_0x4f75b5){const _0x1c721d=_0x309c1e;console['log'](_0x1c721d(0x1e9),_0x140c16,_0x4f75b5);const _0x213400=await this[_0x1c721d(0x21e)][_0x1c721d(0x1dc)](_0x140c16['signature'],_0x140c16['nonce'],_0x140c16[_0x1c721d(0x235)]);return _0x213400?_0x140c16[_0x1c721d(0x1d7)]:'';}async[_0x309c1e(0x1f0)](_0x38a26d,_0x406cd2,_0x1be034,_0x44d835){const _0x970040=_0x309c1e,{xml:_0x30ce8d}=_0x1be034;console[_0x970040(0x1e5)](_0x970040(0x206),_0x30ce8d);if(_0x30ce8d[_0x970040(0x1da)][0x0]==_0x970040(0x21c)){if(_0x30ce8d[_0x970040(0x21c)][0x0]==_0x970040(0x236)||_0x30ce8d[_0x970040(0x21c)][0x0]==_0x970040(0x22f))return _0x44d835['status'](0xc8)[_0x970040(0x213)]('');if(_0x30ce8d[_0x970040(0x21c)][0x0]==_0x970040(0x1de)){console[_0x970040(0x1e5)]('扫码');const _0x126787=_0x30ce8d[_0x970040(0x233)][0x0];if(_0x126787[_0x970040(0x1e3)]('/')){this[_0x970040(0x21e)][_0x970040(0x20c)](_0x30ce8d[_0x970040(0x1e4)][0x0],_0x126787);const _0x1e003f=await this[_0x970040(0x21e)][_0x970040(0x1f6)](_0x30ce8d,'officialBindAccountText');return _0x44d835[_0x970040(0x225)](0xc8)[_0x970040(0x213)](_0x1e003f);}this[_0x970040(0x21e)]['scan'](_0x30ce8d[_0x970040(0x1e4)][0x0],_0x126787);const _0x19a2a5=await this[_0x970040(0x21e)][_0x970040(0x1f6)](_0x30ce8d,_0x970040(0x222));return _0x44d835['status'](0xc8)[_0x970040(0x213)](_0x19a2a5);}if(_0x30ce8d[_0x970040(0x21c)][0x0]=='subscribe'){console[_0x970040(0x1e5)]('订阅',_0x30ce8d[_0x970040(0x233)][0x0]);const _0x3b08c6=_0x30ce8d[_0x970040(0x233)][0x0]['split'](_0x970040(0x22e))[0x1];console[_0x970040(0x1e5)](_0x970040(0x1f2),_0x3b08c6);if(!_0x3b08c6){const _0x4175ea=await this[_0x970040(0x21e)][_0x970040(0x1f6)](_0x30ce8d,'officialSubscribeText');return _0x44d835[_0x970040(0x225)](0xc8)['send'](_0x4175ea);}if(_0x3b08c6[_0x970040(0x1e3)]('/')){this[_0x970040(0x21e)]['scanBindWx'](_0x30ce8d[_0x970040(0x1e4)][0x0],_0x3b08c6);const _0xc9ad4f=await this[_0x970040(0x21e)][_0x970040(0x1f6)](_0x30ce8d,_0x970040(0x215));return _0x44d835['status'](0xc8)['send'](_0xc9ad4f);}this[_0x970040(0x21e)][_0x970040(0x22a)](_0x30ce8d[_0x970040(0x1e4)][0x0],_0x3b08c6);const _0x570aef=await this['officialService'][_0x970040(0x1f6)](_0x30ce8d,'officialSubscribeText');return _0x44d835['status'](0xc8)[_0x970040(0x213)](_0x570aef);}if(_0x30ce8d[_0x970040(0x21c)][0x0]==_0x970040(0x1e6))return _0x44d835[_0x970040(0x225)](0xc8)['send']('');}if(_0x30ce8d[_0x970040(0x1da)][0x0]==_0x970040(0x20d)){const _0x28d3c6=await this[_0x970040(0x21e)][_0x970040(0x218)](_0x30ce8d['content'][0x0]),_0x2ed7bb=await this[_0x970040(0x21e)]['genXmlMsg'](_0x30ce8d,_0x28d3c6);return _0x44d835['status'](0xc8)[_0x970040(0x213)](_0x2ed7bb);}return _0x970040(0x230);}async[_0x309c1e(0x1ec)](){const _0x34376a=_0x309c1e;return this[_0x34376a(0x21e)][_0x34376a(0x1ec)]();}async['getQRSceneStrByBind'](_0x24cd57){const _0x4977fe=_0x309c1e;return this['officialService'][_0x4977fe(0x217)](_0x24cd57);}async['getQRCode'](_0xa55c15){const _0x57d891=_0x309c1e;if(process[_0x57d891(0x223)][_0x57d891(0x20a)]===_0x57d891(0x21d))return'';const _0x26af8b=await this[_0x57d891(0x21e)]['getQRCodeTicket'](_0xa55c15[_0x57d891(0x1f5)]),_0x1be59e=(0x0,utils_1[_0x57d891(0x201)])(process[_0x57d891(0x223)]['weChatMpUrl']||_0x57d891(0x1ea));return _0x1be59e+_0x57d891(0x21b)+encodeURIComponent(_0x26af8b);}async[_0x309c1e(0x1f4)](_0x5ea3ec,_0x5448c0){const _0x459178=_0x309c1e;return this[_0x459178(0x21e)][_0x459178(0x1f4)](_0x5ea3ec,_0x5448c0);}async[_0x309c1e(0x221)](_0x4e7ff1,_0x360564){const _0x16aa24=_0x309c1e;return this[_0x16aa24(0x21e)][_0x16aa24(0x221)](_0x4e7ff1,_0x360564[_0x16aa24(0x1f5)]);}async['getRedirectUrl'](_0x539a90){const _0x11f6d4=_0x309c1e;return this[_0x11f6d4(0x21e)]['getRedirectUrl'](_0x539a90[_0x11f6d4(0x228)]);}async[_0x309c1e(0x1f1)](_0x3f0d95){const _0x4077c6=_0x309c1e;return this['officialService']['getJsapiTicket'](_0x3f0d95[_0x4077c6(0x228)]);}async['loginByCode'](_0x25c1e5,_0x4625c5){const _0x546cd0=_0x309c1e;return this[_0x546cd0(0x21e)]['loginByCode'](_0x25c1e5,_0x4625c5[_0x546cd0(0x22d)]);}};__decorate([(0x0,common_1[_0x309c1e(0x21a)])(_0x309c1e(0x224)),(0x0,swagger_1[_0x309c1e(0x227)])({'summary':_0x309c1e(0x216)}),__param(0x0,(0x0,common_1[_0x309c1e(0x214)])()),__param(0x1,(0x0,common_1[_0x309c1e(0x1f7)])()),__param(0x2,(0x0,common_1['Body'])()),__metadata(_0x309c1e(0x1d9),Function),__metadata(_0x309c1e(0x220),[Object,Object,Object]),__metadata(_0x309c1e(0x212),Promise)],OfficialController[_0x309c1e(0x208)],_0x309c1e(0x224),null),__decorate([(0x0,common_1['Post'])('notify'),(0x0,swagger_1[_0x309c1e(0x227)])({'summary':_0x309c1e(0x205)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x309c1e(0x1f7)])()),__param(0x2,(0x0,common_1[_0x309c1e(0x1d8)])()),__param(0x3,(0x0,common_1[_0x309c1e(0x232)])()),__metadata(_0x309c1e(0x1d9),Function),__metadata(_0x309c1e(0x220),[Object,Object,Object,Object]),__metadata(_0x309c1e(0x212),Promise)],OfficialController[_0x309c1e(0x208)],_0x309c1e(0x1f0),null),__decorate([(0x0,common_1[_0x309c1e(0x1df)])(_0x309c1e(0x1ec)),(0x0,swagger_1['ApiOperation'])({'summary':'获取登录二维码sceneStr'}),__metadata(_0x309c1e(0x1d9),Function),__metadata(_0x309c1e(0x220),[]),__metadata(_0x309c1e(0x212),Promise)],OfficialController['prototype'],_0x309c1e(0x1ec),null),__decorate([(0x0,common_1[_0x309c1e(0x1df)])(_0x309c1e(0x217)),(0x0,swagger_1[_0x309c1e(0x227)])({'summary':_0x309c1e(0x203)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x309c1e(0x1fc)]),__param(0x0,(0x0,common_1[_0x309c1e(0x214)])()),__metadata(_0x309c1e(0x1d9),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x309c1e(0x212),Promise)],OfficialController[_0x309c1e(0x208)],_0x309c1e(0x217),null),__decorate([(0x0,common_1[_0x309c1e(0x21a)])(_0x309c1e(0x1dd)),(0x0,swagger_1[_0x309c1e(0x227)])({'summary':_0x309c1e(0x1e2)}),__param(0x0,(0x0,common_1[_0x309c1e(0x1f7)])()),__metadata(_0x309c1e(0x1d9),Function),__metadata('design:paramtypes',[getQrCode_dto_1[_0x309c1e(0x22b)]]),__metadata(_0x309c1e(0x212),Promise)],OfficialController['prototype'],_0x309c1e(0x1dd),null),__decorate([(0x0,common_1[_0x309c1e(0x1df)])('loginBySceneStr'),(0x0,swagger_1[_0x309c1e(0x227)])({'summary':_0x309c1e(0x1d6)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x309c1e(0x1d8)])()),__metadata(_0x309c1e(0x1d9),Function),__metadata('design:paramtypes',[Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x309c1e(0x208)],_0x309c1e(0x1f4),null),__decorate([(0x0,common_1[_0x309c1e(0x1df)])(_0x309c1e(0x221)),(0x0,swagger_1[_0x309c1e(0x227)])({'summary':_0x309c1e(0x209)}),(0x0,common_1[_0x309c1e(0x211)])(jwtAuth_guard_1[_0x309c1e(0x1fc)]),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x309c1e(0x1d8)])()),__metadata(_0x309c1e(0x1d9),Function),__metadata(_0x309c1e(0x220),[Object,getQrCode_dto_1[_0x309c1e(0x22b)]]),__metadata(_0x309c1e(0x212),Promise)],OfficialController['prototype'],_0x309c1e(0x221),null),__decorate([(0x0,common_1[_0x309c1e(0x1df)])('getRedirectUrl'),(0x0,swagger_1['ApiOperation'])({'summary':_0x309c1e(0x1f8)}),__param(0x0,(0x0,common_1[_0x309c1e(0x1d8)])()),__metadata('design:type',Function),__metadata(_0x309c1e(0x220),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x309c1e(0x208)],'getRedirectUrl',null),__decorate([(0x0,common_1[_0x309c1e(0x1df)])('getJsapiTicket'),(0x0,swagger_1['ApiOperation'])({'summary':'获取注册配置'}),__param(0x0,(0x0,common_1[_0x309c1e(0x1d8)])()),__metadata(_0x309c1e(0x1d9),Function),__metadata(_0x309c1e(0x220),[Object]),__metadata(_0x309c1e(0x212),Promise)],OfficialController[_0x309c1e(0x208)],_0x309c1e(0x1f1),null),__decorate([(0x0,common_1[_0x309c1e(0x1df)])(_0x309c1e(0x1e8)),(0x0,swagger_1[_0x309c1e(0x227)])({'summary':_0x309c1e(0x1e0)}),__param(0x0,(0x0,common_1[_0x309c1e(0x214)])()),__param(0x1,(0x0,common_1[_0x309c1e(0x1d8)])()),__metadata(_0x309c1e(0x1d9),Function),__metadata(_0x309c1e(0x220),[Object,Object]),__metadata(_0x309c1e(0x212),Promise)],OfficialController[_0x309c1e(0x208)],'loginByCode',null),OfficialController=__decorate([(0x0,swagger_1[_0x309c1e(0x229)])(_0x309c1e(0x219)),(0x0,common_1[_0x309c1e(0x234)])(_0x309c1e(0x219)),__metadata(_0x309c1e(0x220),[official_service_1[_0x309c1e(0x1ee)]])],OfficialController),exports[_0x309c1e(0x1fb)]=OfficialController;