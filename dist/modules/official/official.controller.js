'use strict';const _0x4e6cb2=_0x40ec;(function(_0x965284,_0x5f44ae){const _0x3ea411=_0x40ec,_0xeb20e8=_0x965284();while(!![]){try{const _0x30ff74=-parseInt(_0x3ea411(0x1a3))/0x1+parseInt(_0x3ea411(0x18f))/0x2+parseInt(_0x3ea411(0x1d1))/0x3*(-parseInt(_0x3ea411(0x1c7))/0x4)+-parseInt(_0x3ea411(0x1b9))/0x5*(-parseInt(_0x3ea411(0x1bd))/0x6)+-parseInt(_0x3ea411(0x196))/0x7*(-parseInt(_0x3ea411(0x1b8))/0x8)+parseInt(_0x3ea411(0x1c4))/0x9*(parseInt(_0x3ea411(0x1da))/0xa)+-parseInt(_0x3ea411(0x1d0))/0xb;if(_0x30ff74===_0x5f44ae)break;else _0xeb20e8['push'](_0xeb20e8['shift']());}catch(_0x2ab155){_0xeb20e8['push'](_0xeb20e8['shift']());}}}(_0x3417,0x43e80));var __decorate=this&&this['__decorate']||function(_0x25c3cb,_0x3976f1,_0x3f70a2,_0x5ec445){const _0x42bbf0=_0x40ec;var _0x412072=arguments['length'],_0x5bbac8=_0x412072<0x3?_0x3976f1:_0x5ec445===null?_0x5ec445=Object[_0x42bbf0(0x1d8)](_0x3976f1,_0x3f70a2):_0x5ec445,_0x5c3ddd;if(typeof Reflect===_0x42bbf0(0x19d)&&typeof Reflect[_0x42bbf0(0x1ce)]==='function')_0x5bbac8=Reflect[_0x42bbf0(0x1ce)](_0x25c3cb,_0x3976f1,_0x3f70a2,_0x5ec445);else{for(var _0x320a59=_0x25c3cb['length']-0x1;_0x320a59>=0x0;_0x320a59--)if(_0x5c3ddd=_0x25c3cb[_0x320a59])_0x5bbac8=(_0x412072<0x3?_0x5c3ddd(_0x5bbac8):_0x412072>0x3?_0x5c3ddd(_0x3976f1,_0x3f70a2,_0x5bbac8):_0x5c3ddd(_0x3976f1,_0x3f70a2))||_0x5bbac8;}return _0x412072>0x3&&_0x5bbac8&&Object[_0x42bbf0(0x1e3)](_0x3976f1,_0x3f70a2,_0x5bbac8),_0x5bbac8;},__metadata=this&&this[_0x4e6cb2(0x193)]||function(_0x1cc94b,_0x354ab6){const _0x2c84bd=_0x4e6cb2;if(typeof Reflect==='object'&&typeof Reflect[_0x2c84bd(0x1bc)]===_0x2c84bd(0x1dd))return Reflect[_0x2c84bd(0x1bc)](_0x1cc94b,_0x354ab6);},__param=this&&this[_0x4e6cb2(0x1b7)]||function(_0x5ec78f,_0x2f1bb5){return function(_0x9339b2,_0x8956bc){_0x2f1bb5(_0x9339b2,_0x8956bc,_0x5ec78f);};};Object[_0x4e6cb2(0x1e3)](exports,'__esModule',{'value':!![]}),exports[_0x4e6cb2(0x1b5)]=void 0x0;function _0x40ec(_0x20f73e,_0x445fee){const _0x34177e=_0x3417();return _0x40ec=function(_0x40ec12,_0x2dadbc){_0x40ec12=_0x40ec12-0x18a;let _0x4c02c2=_0x34177e[_0x40ec12];return _0x4c02c2;},_0x40ec(_0x20f73e,_0x445fee);}function _0x3417(){const _0x12e4d2=['genXmlMsg','send','design:returntype','getOwnPropertyDescriptor','log','5469450deQDzL','env','./official.service','function','GetQrCodeDto','获取注册配置','get\x20通知>>>','notifyPost','getQRSceneStrByBind','defineProperty','officialBindAccountText','official','status','./dto/getQrCode.dto','UseGuards','VIEW','https://mp.weixin.qq.com','ApiOperation','verify','bindWxBySceneStr','618724CYdAxX','weChatMpUrl','timestamp','qrscene_','__metadata','Res','Body','583912pWRbNJ','url','Post','includes','loginBySceneStr','OfficialService','formatUrl','object','Get','sceneStr','@nestjs/common','getQRSceneStr','ApiTags','6685oPhPmE','genXmlMsgByConfig','公众号静默登录','content','success','nonce','getQRCodeTicket','/cgi-bin/showqrcode?ticket=','event','Controller','code','scan','prototype','公众号通知接口GET','getJsapiTicket','subscribe','fromusername','Query','OfficialController','获取二维码','__param','8ojRjBS','47885yOAmfL','../../common/utils','JwtAuthGuard','metadata','156iKQqJU','notify','getRedirectUrl','officialScanLoginText','split','eventkey','officialService','9bclxZu','msgtype','scanBindWx','1072WmPNyt','loginByCode','@nestjs/swagger','design:paramtypes','Req','获取绑定二维码的sceneStr','officialSubscribeText','decorate','../../common/auth/jwtAuth.guard','5674152URmRFQ','4344QyXxkJ','aotoPlay','design:type','unsubscribe'];_0x3417=function(){return _0x12e4d2;};return _0x3417();}const jwtAuth_guard_1=require(_0x4e6cb2(0x1cf)),utils_1=require(_0x4e6cb2(0x1ba)),common_1=require(_0x4e6cb2(0x1a0)),swagger_1=require(_0x4e6cb2(0x1c9)),getQrCode_dto_1=require(_0x4e6cb2(0x1e7)),official_service_1=require(_0x4e6cb2(0x1dc));let OfficialController=class OfficialController{constructor(_0x2e8687){const _0x1cb04a=_0x4e6cb2;this[_0x1cb04a(0x1c3)]=_0x2e8687;}async['notify'](_0x4ad454,_0x679c1a,_0x217079){const _0x1905bb=_0x4e6cb2;console[_0x1905bb(0x1d9)](_0x1905bb(0x1e0),_0x679c1a,_0x217079);const _0x149252=await this[_0x1905bb(0x1c3)][_0x1905bb(0x18d)](_0x679c1a['signature'],_0x679c1a[_0x1905bb(0x1a8)],_0x679c1a[_0x1905bb(0x191)]);return _0x149252?_0x679c1a['echostr']:'';}async[_0x4e6cb2(0x1e1)](_0x9f8cb9,_0xfc2e54,_0x2f895f,_0x3ac889){const _0x19d46e=_0x4e6cb2,{xml:_0x53715e}=_0x2f895f;console['log']('xml:\x20',_0x53715e);if(_0x53715e[_0x19d46e(0x1c5)][0x0]=='event'){if(_0x53715e[_0x19d46e(0x1ab)][0x0]==_0x19d46e(0x18a)||_0x53715e[_0x19d46e(0x1ab)][0x0]=='CLICK')return _0x3ac889[_0x19d46e(0x1e6)](0xc8)[_0x19d46e(0x1d6)]('');if(_0x53715e[_0x19d46e(0x1ab)][0x0]=='SCAN'){console['log']('扫码');const _0x420db5=_0x53715e[_0x19d46e(0x1c2)][0x0];if(_0x420db5[_0x19d46e(0x199)]('/')){this[_0x19d46e(0x1c3)][_0x19d46e(0x1c6)](_0x53715e[_0x19d46e(0x1b3)][0x0],_0x420db5);const _0x4dc45d=await this[_0x19d46e(0x1c3)]['genXmlMsgByConfig'](_0x53715e,_0x19d46e(0x1e4));return _0x3ac889[_0x19d46e(0x1e6)](0xc8)[_0x19d46e(0x1d6)](_0x4dc45d);}this[_0x19d46e(0x1c3)][_0x19d46e(0x1ae)](_0x53715e[_0x19d46e(0x1b3)][0x0],_0x420db5);const _0xbb634e=await this['officialService'][_0x19d46e(0x1a4)](_0x53715e,_0x19d46e(0x1c0));return _0x3ac889['status'](0xc8)[_0x19d46e(0x1d6)](_0xbb634e);}if(_0x53715e['event'][0x0]==_0x19d46e(0x1b2)){console['log']('订阅',_0x53715e[_0x19d46e(0x1c2)][0x0]);const _0x29c9ff=_0x53715e[_0x19d46e(0x1c2)][0x0][_0x19d46e(0x1c1)](_0x19d46e(0x192))[0x1];console[_0x19d46e(0x1d9)]('sceneStr:\x20',_0x29c9ff);if(!_0x29c9ff){const _0x4bee29=await this['officialService'][_0x19d46e(0x1a4)](_0x53715e,_0x19d46e(0x1cd));return _0x3ac889[_0x19d46e(0x1e6)](0xc8)[_0x19d46e(0x1d6)](_0x4bee29);}if(_0x29c9ff[_0x19d46e(0x199)]('/')){this[_0x19d46e(0x1c3)][_0x19d46e(0x1c6)](_0x53715e['fromusername'][0x0],_0x29c9ff);const _0x40e656=await this[_0x19d46e(0x1c3)][_0x19d46e(0x1a4)](_0x53715e,_0x19d46e(0x1e4));return _0x3ac889[_0x19d46e(0x1e6)](0xc8)[_0x19d46e(0x1d6)](_0x40e656);}this['officialService'][_0x19d46e(0x1ae)](_0x53715e[_0x19d46e(0x1b3)][0x0],_0x29c9ff);const _0xbd1749=await this[_0x19d46e(0x1c3)][_0x19d46e(0x1a4)](_0x53715e,_0x19d46e(0x1cd));return _0x3ac889[_0x19d46e(0x1e6)](0xc8)[_0x19d46e(0x1d6)](_0xbd1749);}if(_0x53715e[_0x19d46e(0x1ab)][0x0]==_0x19d46e(0x1d4))return _0x3ac889[_0x19d46e(0x1e6)](0xc8)[_0x19d46e(0x1d6)]('');}if(_0x53715e[_0x19d46e(0x1c5)][0x0]=='text'){const _0xf8565=await this[_0x19d46e(0x1c3)][_0x19d46e(0x1d2)](_0x53715e[_0x19d46e(0x1a6)][0x0]),_0x46082c=await this[_0x19d46e(0x1c3)][_0x19d46e(0x1d5)](_0x53715e,_0xf8565);return _0x3ac889[_0x19d46e(0x1e6)](0xc8)['send'](_0x46082c);}return _0x19d46e(0x1a7);}async['getQRSceneStr'](){const _0x24b277=_0x4e6cb2;return this[_0x24b277(0x1c3)][_0x24b277(0x1a1)]();}async[_0x4e6cb2(0x1e2)](_0x3b9a71){const _0x537fd4=_0x4e6cb2;return this[_0x537fd4(0x1c3)][_0x537fd4(0x1e2)](_0x3b9a71);}async['getQRCode'](_0xb482c7){const _0x371cd3=_0x4e6cb2;if(process[_0x371cd3(0x1db)]['ISDEV']==='TRUE')return'';const _0x482e7b=await this[_0x371cd3(0x1c3)][_0x371cd3(0x1a9)](_0xb482c7[_0x371cd3(0x19f)]),_0x3b1162=(0x0,utils_1[_0x371cd3(0x19c)])(process[_0x371cd3(0x1db)][_0x371cd3(0x190)]||_0x371cd3(0x18b));return _0x3b1162+_0x371cd3(0x1aa)+encodeURIComponent(_0x482e7b);}async[_0x4e6cb2(0x19a)](_0x46210c,_0x26d226){const _0x163bb8=_0x4e6cb2;return this[_0x163bb8(0x1c3)][_0x163bb8(0x19a)](_0x46210c,_0x26d226);}async[_0x4e6cb2(0x18e)](_0xf74f67,_0x4871df){const _0x1c7305=_0x4e6cb2;return this[_0x1c7305(0x1c3)][_0x1c7305(0x18e)](_0xf74f67,_0x4871df[_0x1c7305(0x19f)]);}async[_0x4e6cb2(0x1bf)](_0x449f0c){const _0x577a0b=_0x4e6cb2;return this[_0x577a0b(0x1c3)][_0x577a0b(0x1bf)](_0x449f0c[_0x577a0b(0x197)]);}async[_0x4e6cb2(0x1b1)](_0x1015a5){const _0x27ec1e=_0x4e6cb2;return this['officialService'][_0x27ec1e(0x1b1)](_0x1015a5['url']);}async[_0x4e6cb2(0x1c8)](_0x1130f0,_0x34f1d0){const _0x7106c2=_0x4e6cb2;return this[_0x7106c2(0x1c3)]['loginByCode'](_0x1130f0,_0x34f1d0[_0x7106c2(0x1ad)]);}};__decorate([(0x0,common_1[_0x4e6cb2(0x19e)])(_0x4e6cb2(0x1be)),(0x0,swagger_1[_0x4e6cb2(0x18c)])({'summary':_0x4e6cb2(0x1b0)}),__param(0x0,(0x0,common_1[_0x4e6cb2(0x1cb)])()),__param(0x1,(0x0,common_1[_0x4e6cb2(0x1b4)])()),__param(0x2,(0x0,common_1[_0x4e6cb2(0x195)])()),__metadata(_0x4e6cb2(0x1d3),Function),__metadata(_0x4e6cb2(0x1ca),[Object,Object,Object]),__metadata(_0x4e6cb2(0x1d7),Promise)],OfficialController[_0x4e6cb2(0x1af)],_0x4e6cb2(0x1be),null),__decorate([(0x0,common_1[_0x4e6cb2(0x198)])(_0x4e6cb2(0x1be)),(0x0,swagger_1[_0x4e6cb2(0x18c)])({'summary':'公众号通知接口POST'}),__param(0x0,(0x0,common_1[_0x4e6cb2(0x1cb)])()),__param(0x1,(0x0,common_1[_0x4e6cb2(0x1b4)])()),__param(0x2,(0x0,common_1['Body'])()),__param(0x3,(0x0,common_1[_0x4e6cb2(0x194)])()),__metadata(_0x4e6cb2(0x1d3),Function),__metadata(_0x4e6cb2(0x1ca),[Object,Object,Object,Object]),__metadata(_0x4e6cb2(0x1d7),Promise)],OfficialController[_0x4e6cb2(0x1af)],_0x4e6cb2(0x1e1),null),__decorate([(0x0,common_1[_0x4e6cb2(0x198)])(_0x4e6cb2(0x1a1)),(0x0,swagger_1[_0x4e6cb2(0x18c)])({'summary':'获取登录二维码sceneStr'}),__metadata('design:type',Function),__metadata('design:paramtypes',[]),__metadata(_0x4e6cb2(0x1d7),Promise)],OfficialController[_0x4e6cb2(0x1af)],_0x4e6cb2(0x1a1),null),__decorate([(0x0,common_1[_0x4e6cb2(0x198)])('getQRSceneStrByBind'),(0x0,swagger_1[_0x4e6cb2(0x18c)])({'summary':_0x4e6cb2(0x1cc)}),(0x0,common_1[_0x4e6cb2(0x1e8)])(jwtAuth_guard_1[_0x4e6cb2(0x1bb)]),__param(0x0,(0x0,common_1['Req'])()),__metadata(_0x4e6cb2(0x1d3),Function),__metadata(_0x4e6cb2(0x1ca),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x4e6cb2(0x1af)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1['Get'])('getQRCode'),(0x0,swagger_1[_0x4e6cb2(0x18c)])({'summary':_0x4e6cb2(0x1b6)}),__param(0x0,(0x0,common_1[_0x4e6cb2(0x1b4)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[getQrCode_dto_1[_0x4e6cb2(0x1de)]]),__metadata(_0x4e6cb2(0x1d7),Promise)],OfficialController['prototype'],'getQRCode',null),__decorate([(0x0,common_1['Post'])(_0x4e6cb2(0x19a)),(0x0,swagger_1[_0x4e6cb2(0x18c)])({'summary':'扫码登录轮询查询'}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x4e6cb2(0x195)])()),__metadata(_0x4e6cb2(0x1d3),Function),__metadata('design:paramtypes',[Object,Object]),__metadata(_0x4e6cb2(0x1d7),Promise)],OfficialController[_0x4e6cb2(0x1af)],_0x4e6cb2(0x19a),null),__decorate([(0x0,common_1[_0x4e6cb2(0x198)])(_0x4e6cb2(0x18e)),(0x0,swagger_1['ApiOperation'])({'summary':'扫码绑定轮询查询'}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x4e6cb2(0x1cb)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x4e6cb2(0x1d3),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x4e6cb2(0x1de)]]),__metadata('design:returntype',Promise)],OfficialController[_0x4e6cb2(0x1af)],_0x4e6cb2(0x18e),null),__decorate([(0x0,common_1[_0x4e6cb2(0x198)])(_0x4e6cb2(0x1bf)),(0x0,swagger_1['ApiOperation'])({'summary':'获取登录跳转地址'}),__param(0x0,(0x0,common_1[_0x4e6cb2(0x195)])()),__metadata(_0x4e6cb2(0x1d3),Function),__metadata(_0x4e6cb2(0x1ca),[Object]),__metadata(_0x4e6cb2(0x1d7),Promise)],OfficialController[_0x4e6cb2(0x1af)],'getRedirectUrl',null),__decorate([(0x0,common_1[_0x4e6cb2(0x198)])(_0x4e6cb2(0x1b1)),(0x0,swagger_1['ApiOperation'])({'summary':_0x4e6cb2(0x1df)}),__param(0x0,(0x0,common_1[_0x4e6cb2(0x195)])()),__metadata('design:type',Function),__metadata(_0x4e6cb2(0x1ca),[Object]),__metadata(_0x4e6cb2(0x1d7),Promise)],OfficialController[_0x4e6cb2(0x1af)],_0x4e6cb2(0x1b1),null),__decorate([(0x0,common_1[_0x4e6cb2(0x198)])('loginByCode'),(0x0,swagger_1[_0x4e6cb2(0x18c)])({'summary':_0x4e6cb2(0x1a5)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x4e6cb2(0x195)])()),__metadata(_0x4e6cb2(0x1d3),Function),__metadata(_0x4e6cb2(0x1ca),[Object,Object]),__metadata(_0x4e6cb2(0x1d7),Promise)],OfficialController[_0x4e6cb2(0x1af)],_0x4e6cb2(0x1c8),null),OfficialController=__decorate([(0x0,swagger_1[_0x4e6cb2(0x1a2)])(_0x4e6cb2(0x1e5)),(0x0,common_1[_0x4e6cb2(0x1ac)])('official'),__metadata(_0x4e6cb2(0x1ca),[official_service_1[_0x4e6cb2(0x19b)]])],OfficialController),exports[_0x4e6cb2(0x1b5)]=OfficialController;