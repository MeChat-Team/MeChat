'use strict';const _0x520919=_0x428c;(function(_0xbc7db3,_0x129f7a){const _0x3f938e=_0x428c,_0x5aede1=_0xbc7db3();while(!![]){try{const _0x3797c1=-parseInt(_0x3f938e(0x167))/0x1+-parseInt(_0x3f938e(0x166))/0x2*(parseInt(_0x3f938e(0x15b))/0x3)+-parseInt(_0x3f938e(0x134))/0x4+parseInt(_0x3f938e(0x15a))/0x5*(-parseInt(_0x3f938e(0x164))/0x6)+parseInt(_0x3f938e(0x13c))/0x7+-parseInt(_0x3f938e(0x146))/0x8*(-parseInt(_0x3f938e(0x14b))/0x9)+parseInt(_0x3f938e(0x13e))/0xa*(parseInt(_0x3f938e(0x142))/0xb);if(_0x3797c1===_0x129f7a)break;else _0x5aede1['push'](_0x5aede1['shift']());}catch(_0x28330e){_0x5aede1['push'](_0x5aede1['shift']());}}}(_0x3d48,0x7d33e));function _0x3d48(){const _0x1cc39c=['officialSubscribeText','text','officialBindAccountText','includes','design:type','official','Controller','prototype','TRUE','./official.service','../../common/utils','../../common/auth/jwtAuth.guard','length','Post','msgtype','公众号通知接口GET','bindWxBySceneStr','getQRSceneStrByBind','getQRCode','unsubscribe','getQRCodeTicket','getOwnPropertyDescriptor','notifyPost','OfficialController','GetQrCodeDto','getJsapiTicket','/cgi-bin/showqrcode?ticket=','__metadata','公众号通知接口POST','获取二维码','3768992OEDPXT','metadata','__param','officialService','loginByCode','getQRSceneStr','qrscene_','@nestjs/common','3707473AkUxvl','get\x20通知>>>','26020SGiwmJ','split','send','__esModule','9218hCfZpK','echostr','status','获取绑定二维码的sceneStr','1628936qeommc','nonce','genXmlMsgByConfig','Query','Req','9pwPPsl','object','notify','Get','signature','fromusername','scanBindWx','获取登录二维码sceneStr','design:returntype','./dto/getQrCode.dto','function','loginBySceneStr','url','SCAN','UseGuards','560llNyGN','9vCongB','formatUrl','eventkey','__decorate','sceneStr','ApiOperation','Body','decorate','content','19032dWpniy','获取注册配置','263852LFYtKS','707612JBSccf','officialScanLoginText','VIEW','扫码绑定轮询查询','env','code','log','getRedirectUrl','aotoPlay','design:paramtypes','JwtAuthGuard','event','scan','defineProperty'];_0x3d48=function(){return _0x1cc39c;};return _0x3d48();}var __decorate=this&&this[_0x520919(0x15e)]||function(_0x30e4dd,_0x491061,_0x377c25,_0x35b97e){const _0x4fe19a=_0x520919;var _0x32f8ac=arguments[_0x4fe19a(0x181)],_0x10bcc9=_0x32f8ac<0x3?_0x491061:_0x35b97e===null?_0x35b97e=Object[_0x4fe19a(0x18a)](_0x491061,_0x377c25):_0x35b97e,_0x299447;if(typeof Reflect===_0x4fe19a(0x14c)&&typeof Reflect['decorate']==='function')_0x10bcc9=Reflect[_0x4fe19a(0x162)](_0x30e4dd,_0x491061,_0x377c25,_0x35b97e);else{for(var _0x38934d=_0x30e4dd[_0x4fe19a(0x181)]-0x1;_0x38934d>=0x0;_0x38934d--)if(_0x299447=_0x30e4dd[_0x38934d])_0x10bcc9=(_0x32f8ac<0x3?_0x299447(_0x10bcc9):_0x32f8ac>0x3?_0x299447(_0x491061,_0x377c25,_0x10bcc9):_0x299447(_0x491061,_0x377c25))||_0x10bcc9;}return _0x32f8ac>0x3&&_0x10bcc9&&Object[_0x4fe19a(0x174)](_0x491061,_0x377c25,_0x10bcc9),_0x10bcc9;},__metadata=this&&this[_0x520919(0x131)]||function(_0x139395,_0x5cecad){const _0x545181=_0x520919;if(typeof Reflect==='object'&&typeof Reflect[_0x545181(0x135)]===_0x545181(0x155))return Reflect['metadata'](_0x139395,_0x5cecad);},__param=this&&this[_0x520919(0x136)]||function(_0x2b46aa,_0x3218bd){return function(_0x3b6f2a,_0x208fa8){_0x3218bd(_0x3b6f2a,_0x208fa8,_0x2b46aa);};};Object['defineProperty'](exports,_0x520919(0x141),{'value':!![]}),exports[_0x520919(0x12d)]=void 0x0;const jwtAuth_guard_1=require(_0x520919(0x180)),utils_1=require(_0x520919(0x17f)),common_1=require(_0x520919(0x13b)),swagger_1=require('@nestjs/swagger'),getQrCode_dto_1=require(_0x520919(0x154)),official_service_1=require(_0x520919(0x17e));function _0x428c(_0x398d7c,_0x5694a3){const _0x3d48d1=_0x3d48();return _0x428c=function(_0x428c9b,_0xfc5260){_0x428c9b=_0x428c9b-0x12c;let _0x30afff=_0x3d48d1[_0x428c9b];return _0x30afff;},_0x428c(_0x398d7c,_0x5694a3);}let OfficialController=class OfficialController{constructor(_0x2c40cb){const _0x7cd386=_0x520919;this[_0x7cd386(0x137)]=_0x2c40cb;}async[_0x520919(0x14d)](_0x27393b,_0x27638b,_0x3c29d8){const _0x547a90=_0x520919;console[_0x547a90(0x16d)](_0x547a90(0x13d),_0x27638b,_0x3c29d8);const _0x302b37=await this[_0x547a90(0x137)]['verify'](_0x27638b[_0x547a90(0x14f)],_0x27638b[_0x547a90(0x147)],_0x27638b['timestamp']);return _0x302b37?_0x27638b[_0x547a90(0x143)]:'';}async['notifyPost'](_0x4d0069,_0x47a1b0,_0x2616bd,_0x59f4dd){const _0x1d222c=_0x520919,{xml:_0x5bd67e}=_0x2616bd;console[_0x1d222c(0x16d)]('xml:\x20',_0x5bd67e);if(_0x5bd67e[_0x1d222c(0x183)][0x0]==_0x1d222c(0x172)){if(_0x5bd67e['event'][0x0]==_0x1d222c(0x169)||_0x5bd67e['event'][0x0]=='CLICK')return _0x59f4dd[_0x1d222c(0x144)](0xc8)[_0x1d222c(0x140)]('');if(_0x5bd67e[_0x1d222c(0x172)][0x0]==_0x1d222c(0x158)){console['log']('扫码');const _0x1c1bab=_0x5bd67e[_0x1d222c(0x15d)][0x0];if(_0x1c1bab[_0x1d222c(0x178)]('/')){this[_0x1d222c(0x137)]['scanBindWx'](_0x5bd67e[_0x1d222c(0x150)][0x0],_0x1c1bab);const _0x1ff1f5=await this[_0x1d222c(0x137)][_0x1d222c(0x148)](_0x5bd67e,_0x1d222c(0x177));return _0x59f4dd[_0x1d222c(0x144)](0xc8)[_0x1d222c(0x140)](_0x1ff1f5);}this[_0x1d222c(0x137)][_0x1d222c(0x173)](_0x5bd67e[_0x1d222c(0x150)][0x0],_0x1c1bab);const _0x608023=await this[_0x1d222c(0x137)][_0x1d222c(0x148)](_0x5bd67e,_0x1d222c(0x168));return _0x59f4dd['status'](0xc8)[_0x1d222c(0x140)](_0x608023);}if(_0x5bd67e[_0x1d222c(0x172)][0x0]=='subscribe'){console[_0x1d222c(0x16d)]('订阅',_0x5bd67e['eventkey'][0x0]);const _0x3c36e7=_0x5bd67e[_0x1d222c(0x15d)][0x0][_0x1d222c(0x13f)](_0x1d222c(0x13a))[0x1];console[_0x1d222c(0x16d)]('sceneStr:\x20',_0x3c36e7);if(!_0x3c36e7){const _0x4a7d66=await this[_0x1d222c(0x137)][_0x1d222c(0x148)](_0x5bd67e,_0x1d222c(0x175));return _0x59f4dd['status'](0xc8)[_0x1d222c(0x140)](_0x4a7d66);}if(_0x3c36e7[_0x1d222c(0x178)]('/')){this[_0x1d222c(0x137)][_0x1d222c(0x151)](_0x5bd67e[_0x1d222c(0x150)][0x0],_0x3c36e7);const _0x297059=await this[_0x1d222c(0x137)][_0x1d222c(0x148)](_0x5bd67e,_0x1d222c(0x177));return _0x59f4dd['status'](0xc8)[_0x1d222c(0x140)](_0x297059);}this['officialService'][_0x1d222c(0x173)](_0x5bd67e['fromusername'][0x0],_0x3c36e7);const _0x4e00ac=await this['officialService'][_0x1d222c(0x148)](_0x5bd67e,_0x1d222c(0x175));return _0x59f4dd['status'](0xc8)['send'](_0x4e00ac);}if(_0x5bd67e[_0x1d222c(0x172)][0x0]==_0x1d222c(0x188))return _0x59f4dd['status'](0xc8)[_0x1d222c(0x140)]('');}if(_0x5bd67e['msgtype'][0x0]==_0x1d222c(0x176)){const _0xeacf7f=await this[_0x1d222c(0x137)][_0x1d222c(0x16f)](_0x5bd67e[_0x1d222c(0x163)][0x0]),_0x3bd74e=await this[_0x1d222c(0x137)]['genXmlMsg'](_0x5bd67e,_0xeacf7f);return _0x59f4dd[_0x1d222c(0x144)](0xc8)['send'](_0x3bd74e);}return'success';}async['getQRSceneStr'](){const _0x2a82fe=_0x520919;return this[_0x2a82fe(0x137)]['getQRSceneStr']();}async['getQRSceneStrByBind'](_0x2827ff){const _0x4990d9=_0x520919;return this['officialService'][_0x4990d9(0x186)](_0x2827ff);}async[_0x520919(0x187)](_0x42de00){const _0x3c706c=_0x520919;if(process[_0x3c706c(0x16b)]['ISDEV']===_0x3c706c(0x17d))return'';const _0x47340f=await this[_0x3c706c(0x137)][_0x3c706c(0x189)](_0x42de00[_0x3c706c(0x15f)]),_0x185118=(0x0,utils_1[_0x3c706c(0x15c)])(process[_0x3c706c(0x16b)]['weChatMpUrl']||'https://mp.weixin.qq.com');return _0x185118+_0x3c706c(0x130)+encodeURIComponent(_0x47340f);}async[_0x520919(0x156)](_0x135d6b,_0x1598fe){const _0x57b60d=_0x520919;return this[_0x57b60d(0x137)][_0x57b60d(0x156)](_0x135d6b,_0x1598fe);}async['bindWxBySceneStr'](_0x2b3083,_0x50e333){const _0x214a85=_0x520919;return this[_0x214a85(0x137)][_0x214a85(0x185)](_0x2b3083,_0x50e333[_0x214a85(0x15f)]);}async[_0x520919(0x16e)](_0xa2e14b){const _0x58b2e9=_0x520919;return this[_0x58b2e9(0x137)][_0x58b2e9(0x16e)](_0xa2e14b[_0x58b2e9(0x157)]);}async['getJsapiTicket'](_0x58a98b){const _0x11807a=_0x520919;return this[_0x11807a(0x137)]['getJsapiTicket'](_0x58a98b['url']);}async[_0x520919(0x138)](_0x4f04ff,_0x27dad6){const _0x5880fc=_0x520919;return this[_0x5880fc(0x137)][_0x5880fc(0x138)](_0x4f04ff,_0x27dad6[_0x5880fc(0x16c)]);}};__decorate([(0x0,common_1[_0x520919(0x14e)])(_0x520919(0x14d)),(0x0,swagger_1['ApiOperation'])({'summary':_0x520919(0x184)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x520919(0x149)])()),__param(0x2,(0x0,common_1[_0x520919(0x161)])()),__metadata(_0x520919(0x179),Function),__metadata(_0x520919(0x170),[Object,Object,Object]),__metadata(_0x520919(0x153),Promise)],OfficialController['prototype'],_0x520919(0x14d),null),__decorate([(0x0,common_1[_0x520919(0x182)])(_0x520919(0x14d)),(0x0,swagger_1[_0x520919(0x160)])({'summary':_0x520919(0x132)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x520919(0x149)])()),__param(0x2,(0x0,common_1[_0x520919(0x161)])()),__param(0x3,(0x0,common_1['Res'])()),__metadata(_0x520919(0x179),Function),__metadata(_0x520919(0x170),[Object,Object,Object,Object]),__metadata(_0x520919(0x153),Promise)],OfficialController[_0x520919(0x17c)],_0x520919(0x12c),null),__decorate([(0x0,common_1[_0x520919(0x182)])(_0x520919(0x139)),(0x0,swagger_1[_0x520919(0x160)])({'summary':_0x520919(0x152)}),__metadata(_0x520919(0x179),Function),__metadata('design:paramtypes',[]),__metadata(_0x520919(0x153),Promise)],OfficialController['prototype'],'getQRSceneStr',null),__decorate([(0x0,common_1[_0x520919(0x182)])(_0x520919(0x186)),(0x0,swagger_1[_0x520919(0x160)])({'summary':_0x520919(0x145)}),(0x0,common_1[_0x520919(0x159)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x520919(0x14a)])()),__metadata(_0x520919(0x179),Function),__metadata(_0x520919(0x170),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x520919(0x17c)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1[_0x520919(0x14e)])(_0x520919(0x187)),(0x0,swagger_1[_0x520919(0x160)])({'summary':_0x520919(0x133)}),__param(0x0,(0x0,common_1[_0x520919(0x149)])()),__metadata('design:type',Function),__metadata(_0x520919(0x170),[getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x520919(0x153),Promise)],OfficialController[_0x520919(0x17c)],'getQRCode',null),__decorate([(0x0,common_1[_0x520919(0x182)])(_0x520919(0x156)),(0x0,swagger_1[_0x520919(0x160)])({'summary':'扫码登录轮询查询'}),__param(0x0,(0x0,common_1[_0x520919(0x14a)])()),__param(0x1,(0x0,common_1[_0x520919(0x161)])()),__metadata('design:type',Function),__metadata(_0x520919(0x170),[Object,Object]),__metadata(_0x520919(0x153),Promise)],OfficialController['prototype'],_0x520919(0x156),null),__decorate([(0x0,common_1[_0x520919(0x182)])(_0x520919(0x185)),(0x0,swagger_1[_0x520919(0x160)])({'summary':_0x520919(0x16a)}),(0x0,common_1[_0x520919(0x159)])(jwtAuth_guard_1[_0x520919(0x171)]),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x520919(0x161)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x520919(0x12e)]]),__metadata(_0x520919(0x153),Promise)],OfficialController[_0x520919(0x17c)],'bindWxBySceneStr',null),__decorate([(0x0,common_1[_0x520919(0x182)])(_0x520919(0x16e)),(0x0,swagger_1[_0x520919(0x160)])({'summary':'获取登录跳转地址'}),__param(0x0,(0x0,common_1[_0x520919(0x161)])()),__metadata(_0x520919(0x179),Function),__metadata(_0x520919(0x170),[Object]),__metadata(_0x520919(0x153),Promise)],OfficialController[_0x520919(0x17c)],_0x520919(0x16e),null),__decorate([(0x0,common_1[_0x520919(0x182)])(_0x520919(0x12f)),(0x0,swagger_1[_0x520919(0x160)])({'summary':_0x520919(0x165)}),__param(0x0,(0x0,common_1[_0x520919(0x161)])()),__metadata(_0x520919(0x179),Function),__metadata(_0x520919(0x170),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x520919(0x17c)],_0x520919(0x12f),null),__decorate([(0x0,common_1[_0x520919(0x182)])(_0x520919(0x138)),(0x0,swagger_1[_0x520919(0x160)])({'summary':'公众号静默登录'}),__param(0x0,(0x0,common_1[_0x520919(0x14a)])()),__param(0x1,(0x0,common_1[_0x520919(0x161)])()),__metadata('design:type',Function),__metadata(_0x520919(0x170),[Object,Object]),__metadata(_0x520919(0x153),Promise)],OfficialController[_0x520919(0x17c)],'loginByCode',null),OfficialController=__decorate([(0x0,swagger_1['ApiTags'])(_0x520919(0x17a)),(0x0,common_1[_0x520919(0x17b)])(_0x520919(0x17a)),__metadata(_0x520919(0x170),[official_service_1['OfficialService']])],OfficialController),exports[_0x520919(0x12d)]=OfficialController;