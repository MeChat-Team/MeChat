'use strict';function _0x1ba2(){const _0x3d7663=['151410WJStIM','includes','获取绑定二维码的sceneStr','object','https://mp.weixin.qq.com','officialSubscribeText','13968lInyBO','__metadata','公众号静默登录','./dto/getQrCode.dto','subscribe','verify','scan','unsubscribe','Req','status','__param','getRedirectUrl','916590nBRCSp','loginBySceneStr','official','getQRSceneStr','../../common/utils','formatUrl','@nestjs/common','eventkey','1019473CvJQHw','content','获取注册配置','aotoPlay','Query','@nestjs/swagger','function','officialBindAccountText','signature','__esModule','1368384GOHYzY','send','defineProperty','fromusername','loginByCode','../../common/auth/jwtAuth.guard','ISDEV','genXmlMsg','获取二维码','140VmFiaA','扫码绑定轮询查询','getJsapiTicket','officialScanLoginText','prototype','GetQrCodeDto','getQRCode','440HmpXoG','5pYzqno','./official.service','get\x20通知>>>','url','8648238wDuGwX','getQRCodeTicket','officialService','6530zgTWEM','ApiTags','bindWxBySceneStr','getQRSceneStrByBind','getOwnPropertyDescriptor','scanBindWx','code','length','5fCyXCT','env','UseGuards','design:returntype','text','Body','77688CRHZvU','log','decorate','8CmPPMJ','ApiOperation','Get','OfficialController','notifyPost','/cgi-bin/showqrcode?ticket=','Post','msgtype','metadata','event','design:type','扫码登录轮询查询','VIEW','genXmlMsgByConfig','sceneStr','xml:\x20','公众号通知接口POST','notify','OfficialService','35IlkiQA','JwtAuthGuard','design:paramtypes'];_0x1ba2=function(){return _0x3d7663;};return _0x1ba2();}const _0x10d8e5=_0x1f0b;(function(_0x538167,_0x29849a){const _0x3f643a=_0x1f0b,_0x2dc62a=_0x538167();while(!![]){try{const _0x322148=-parseInt(_0x3f643a(0x208))/0x1*(parseInt(_0x3f643a(0x1d3))/0x2)+-parseInt(_0x3f643a(0x1e5))/0x3*(parseInt(_0x3f643a(0x220))/0x4)+parseInt(_0x3f643a(0x217))/0x5*(parseInt(_0x3f643a(0x20c))/0x6)+-parseInt(_0x3f643a(0x1d0))/0x7*(-parseInt(_0x3f643a(0x1f7))/0x8)+-parseInt(_0x3f643a(0x1d9))/0x9*(parseInt(_0x3f643a(0x20f))/0xa)+-parseInt(_0x3f643a(0x207))/0xb*(parseInt(_0x3f643a(0x21d))/0xc)+parseInt(_0x3f643a(0x1ed))/0xd*(parseInt(_0x3f643a(0x200))/0xe);if(_0x322148===_0x29849a)break;else _0x2dc62a['push'](_0x2dc62a['shift']());}catch(_0x24338d){_0x2dc62a['push'](_0x2dc62a['shift']());}}}(_0x1ba2,0xc7e86));var __decorate=this&&this['__decorate']||function(_0x1b65a9,_0x5b0ac0,_0x3df667,_0x53fad7){const _0x3b7d73=_0x1f0b;var _0x1d36ec=arguments['length'],_0x52ae0b=_0x1d36ec<0x3?_0x5b0ac0:_0x53fad7===null?_0x53fad7=Object[_0x3b7d73(0x213)](_0x5b0ac0,_0x3df667):_0x53fad7,_0x1b9714;if(typeof Reflect===_0x3b7d73(0x1d6)&&typeof Reflect[_0x3b7d73(0x21f)]==='function')_0x52ae0b=Reflect[_0x3b7d73(0x21f)](_0x1b65a9,_0x5b0ac0,_0x3df667,_0x53fad7);else{for(var _0x44dcaf=_0x1b65a9[_0x3b7d73(0x216)]-0x1;_0x44dcaf>=0x0;_0x44dcaf--)if(_0x1b9714=_0x1b65a9[_0x44dcaf])_0x52ae0b=(_0x1d36ec<0x3?_0x1b9714(_0x52ae0b):_0x1d36ec>0x3?_0x1b9714(_0x5b0ac0,_0x3df667,_0x52ae0b):_0x1b9714(_0x5b0ac0,_0x3df667))||_0x52ae0b;}return _0x1d36ec>0x3&&_0x52ae0b&&Object[_0x3b7d73(0x1f9)](_0x5b0ac0,_0x3df667,_0x52ae0b),_0x52ae0b;},__metadata=this&&this[_0x10d8e5(0x1da)]||function(_0x4edae4,_0xcb2c51){const _0x679bd=_0x10d8e5;if(typeof Reflect===_0x679bd(0x1d6)&&typeof Reflect['metadata']===_0x679bd(0x1f3))return Reflect[_0x679bd(0x228)](_0x4edae4,_0xcb2c51);},__param=this&&this[_0x10d8e5(0x1e3)]||function(_0x3d5fcc,_0x3e8d88){return function(_0x2d77b3,_0x5b3b94){_0x3e8d88(_0x2d77b3,_0x5b3b94,_0x3d5fcc);};};Object['defineProperty'](exports,_0x10d8e5(0x1f6),{'value':!![]}),exports[_0x10d8e5(0x223)]=void 0x0;const jwtAuth_guard_1=require(_0x10d8e5(0x1fc)),utils_1=require(_0x10d8e5(0x1e9)),common_1=require(_0x10d8e5(0x1eb)),swagger_1=require(_0x10d8e5(0x1f2)),getQrCode_dto_1=require(_0x10d8e5(0x1dc)),official_service_1=require(_0x10d8e5(0x209));let OfficialController=class OfficialController{constructor(_0x109302){const _0x1394e1=_0x10d8e5;this[_0x1394e1(0x20e)]=_0x109302;}async[_0x10d8e5(0x1ce)](_0x239722,_0x41ba34,_0x39d5ba){const _0x1a7922=_0x10d8e5;console[_0x1a7922(0x21e)](_0x1a7922(0x20a),_0x41ba34,_0x39d5ba);const _0x152d05=await this['officialService'][_0x1a7922(0x1de)](_0x41ba34[_0x1a7922(0x1f5)],_0x41ba34['nonce'],_0x41ba34['timestamp']);return _0x152d05?_0x41ba34['echostr']:'';}async[_0x10d8e5(0x224)](_0x505d6a,_0x1dfa25,_0x46d76d,_0x526960){const _0x3aead6=_0x10d8e5,{xml:_0x4077a3}=_0x46d76d;console[_0x3aead6(0x21e)](_0x3aead6(0x22f),_0x4077a3);if(_0x4077a3[_0x3aead6(0x227)][0x0]==_0x3aead6(0x229)){if(_0x4077a3[_0x3aead6(0x229)][0x0]==_0x3aead6(0x22c)||_0x4077a3['event'][0x0]=='CLICK')return _0x526960['status'](0xc8)[_0x3aead6(0x1f8)]('');if(_0x4077a3[_0x3aead6(0x229)][0x0]=='SCAN'){console[_0x3aead6(0x21e)]('扫码');const _0x319614=_0x4077a3[_0x3aead6(0x1ec)][0x0];if(_0x319614[_0x3aead6(0x1d4)]('/')){this[_0x3aead6(0x20e)][_0x3aead6(0x214)](_0x4077a3[_0x3aead6(0x1fa)][0x0],_0x319614);const _0x3592ca=await this[_0x3aead6(0x20e)][_0x3aead6(0x22d)](_0x4077a3,'officialBindAccountText');return _0x526960[_0x3aead6(0x1e2)](0xc8)[_0x3aead6(0x1f8)](_0x3592ca);}this['officialService'][_0x3aead6(0x1df)](_0x4077a3[_0x3aead6(0x1fa)][0x0],_0x319614);const _0x4e57ea=await this['officialService'][_0x3aead6(0x22d)](_0x4077a3,_0x3aead6(0x203));return _0x526960[_0x3aead6(0x1e2)](0xc8)[_0x3aead6(0x1f8)](_0x4e57ea);}if(_0x4077a3[_0x3aead6(0x229)][0x0]==_0x3aead6(0x1dd)){console[_0x3aead6(0x21e)]('订阅',_0x4077a3[_0x3aead6(0x1ec)][0x0]);const _0x3f5ff2=_0x4077a3[_0x3aead6(0x1ec)][0x0]['split']('qrscene_')[0x1];console['log']('sceneStr:\x20',_0x3f5ff2);if(!_0x3f5ff2){const _0x8b509e=await this[_0x3aead6(0x20e)][_0x3aead6(0x22d)](_0x4077a3,_0x3aead6(0x1d8));return _0x526960['status'](0xc8)[_0x3aead6(0x1f8)](_0x8b509e);}if(_0x3f5ff2[_0x3aead6(0x1d4)]('/')){this[_0x3aead6(0x20e)]['scanBindWx'](_0x4077a3[_0x3aead6(0x1fa)][0x0],_0x3f5ff2);const _0x131a07=await this['officialService'][_0x3aead6(0x22d)](_0x4077a3,_0x3aead6(0x1f4));return _0x526960[_0x3aead6(0x1e2)](0xc8)['send'](_0x131a07);}this['officialService']['scan'](_0x4077a3['fromusername'][0x0],_0x3f5ff2);const _0x140507=await this[_0x3aead6(0x20e)]['genXmlMsgByConfig'](_0x4077a3,_0x3aead6(0x1d8));return _0x526960[_0x3aead6(0x1e2)](0xc8)[_0x3aead6(0x1f8)](_0x140507);}if(_0x4077a3['event'][0x0]==_0x3aead6(0x1e0))return _0x526960[_0x3aead6(0x1e2)](0xc8)[_0x3aead6(0x1f8)]('');}if(_0x4077a3[_0x3aead6(0x227)][0x0]==_0x3aead6(0x21b)){const _0x1cae97=await this[_0x3aead6(0x20e)][_0x3aead6(0x1f0)](_0x4077a3[_0x3aead6(0x1ee)][0x0]),_0x5aa8f9=await this[_0x3aead6(0x20e)][_0x3aead6(0x1fe)](_0x4077a3,_0x1cae97);return _0x526960[_0x3aead6(0x1e2)](0xc8)['send'](_0x5aa8f9);}return'success';}async[_0x10d8e5(0x1e8)](){const _0x551ee4=_0x10d8e5;return this[_0x551ee4(0x20e)][_0x551ee4(0x1e8)]();}async[_0x10d8e5(0x212)](_0x1126a6){const _0x591696=_0x10d8e5;return this['officialService'][_0x591696(0x212)](_0x1126a6);}async[_0x10d8e5(0x206)](_0x441259){const _0x4d0d90=_0x10d8e5;if(process[_0x4d0d90(0x218)][_0x4d0d90(0x1fd)]==='TRUE')return'';const _0x4f7acc=await this[_0x4d0d90(0x20e)][_0x4d0d90(0x20d)](_0x441259['sceneStr']),_0x5f13c1=(0x0,utils_1[_0x4d0d90(0x1ea)])(process[_0x4d0d90(0x218)]['weChatMpUrl']||_0x4d0d90(0x1d7));return _0x5f13c1+_0x4d0d90(0x225)+encodeURIComponent(_0x4f7acc);}async[_0x10d8e5(0x1e6)](_0x37abe5,_0x21cc81){const _0x381841=_0x10d8e5;return this[_0x381841(0x20e)]['loginBySceneStr'](_0x37abe5,_0x21cc81);}async['bindWxBySceneStr'](_0x9bafef,_0x2c3436){const _0x509f23=_0x10d8e5;return this[_0x509f23(0x20e)][_0x509f23(0x211)](_0x9bafef,_0x2c3436[_0x509f23(0x22e)]);}async[_0x10d8e5(0x1e4)](_0x3fec99){const _0x3f8bf3=_0x10d8e5;return this[_0x3f8bf3(0x20e)][_0x3f8bf3(0x1e4)](_0x3fec99[_0x3f8bf3(0x20b)]);}async[_0x10d8e5(0x202)](_0x39a48a){const _0x215397=_0x10d8e5;return this[_0x215397(0x20e)][_0x215397(0x202)](_0x39a48a[_0x215397(0x20b)]);}async['loginByCode'](_0x4920c6,_0x3216ef){const _0x1731b3=_0x10d8e5;return this[_0x1731b3(0x20e)][_0x1731b3(0x1fb)](_0x4920c6,_0x3216ef[_0x1731b3(0x215)]);}};function _0x1f0b(_0x25311c,_0x156b9b){const _0x1ba29f=_0x1ba2();return _0x1f0b=function(_0x1f0b06,_0x3bab1d){_0x1f0b06=_0x1f0b06-0x1ce;let _0x25cc1c=_0x1ba29f[_0x1f0b06];return _0x25cc1c;},_0x1f0b(_0x25311c,_0x156b9b);}__decorate([(0x0,common_1[_0x10d8e5(0x222)])('notify'),(0x0,swagger_1['ApiOperation'])({'summary':'公众号通知接口GET'}),__param(0x0,(0x0,common_1[_0x10d8e5(0x1e1)])()),__param(0x1,(0x0,common_1[_0x10d8e5(0x1f1)])()),__param(0x2,(0x0,common_1[_0x10d8e5(0x21c)])()),__metadata(_0x10d8e5(0x22a),Function),__metadata(_0x10d8e5(0x1d2),[Object,Object,Object]),__metadata(_0x10d8e5(0x21a),Promise)],OfficialController[_0x10d8e5(0x204)],_0x10d8e5(0x1ce),null),__decorate([(0x0,common_1[_0x10d8e5(0x226)])('notify'),(0x0,swagger_1[_0x10d8e5(0x221)])({'summary':_0x10d8e5(0x230)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x10d8e5(0x1f1)])()),__param(0x2,(0x0,common_1[_0x10d8e5(0x21c)])()),__param(0x3,(0x0,common_1['Res'])()),__metadata('design:type',Function),__metadata(_0x10d8e5(0x1d2),[Object,Object,Object,Object]),__metadata(_0x10d8e5(0x21a),Promise)],OfficialController[_0x10d8e5(0x204)],'notifyPost',null),__decorate([(0x0,common_1[_0x10d8e5(0x226)])(_0x10d8e5(0x1e8)),(0x0,swagger_1[_0x10d8e5(0x221)])({'summary':'获取登录二维码sceneStr'}),__metadata(_0x10d8e5(0x22a),Function),__metadata(_0x10d8e5(0x1d2),[]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x10d8e5(0x1e8),null),__decorate([(0x0,common_1['Post'])(_0x10d8e5(0x212)),(0x0,swagger_1[_0x10d8e5(0x221)])({'summary':_0x10d8e5(0x1d5)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x10d8e5(0x1d1)]),__param(0x0,(0x0,common_1[_0x10d8e5(0x1e1)])()),__metadata(_0x10d8e5(0x22a),Function),__metadata(_0x10d8e5(0x1d2),[Object]),__metadata(_0x10d8e5(0x21a),Promise)],OfficialController[_0x10d8e5(0x204)],_0x10d8e5(0x212),null),__decorate([(0x0,common_1[_0x10d8e5(0x222)])(_0x10d8e5(0x206)),(0x0,swagger_1['ApiOperation'])({'summary':_0x10d8e5(0x1ff)}),__param(0x0,(0x0,common_1[_0x10d8e5(0x1f1)])()),__metadata(_0x10d8e5(0x22a),Function),__metadata(_0x10d8e5(0x1d2),[getQrCode_dto_1[_0x10d8e5(0x205)]]),__metadata(_0x10d8e5(0x21a),Promise)],OfficialController[_0x10d8e5(0x204)],_0x10d8e5(0x206),null),__decorate([(0x0,common_1[_0x10d8e5(0x226)])('loginBySceneStr'),(0x0,swagger_1['ApiOperation'])({'summary':_0x10d8e5(0x22b)}),__param(0x0,(0x0,common_1[_0x10d8e5(0x1e1)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x10d8e5(0x22a),Function),__metadata('design:paramtypes',[Object,Object]),__metadata(_0x10d8e5(0x21a),Promise)],OfficialController['prototype'],_0x10d8e5(0x1e6),null),__decorate([(0x0,common_1['Post'])('bindWxBySceneStr'),(0x0,swagger_1[_0x10d8e5(0x221)])({'summary':_0x10d8e5(0x201)}),(0x0,common_1[_0x10d8e5(0x219)])(jwtAuth_guard_1[_0x10d8e5(0x1d1)]),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x10d8e5(0x21c)])()),__metadata(_0x10d8e5(0x22a),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x10d8e5(0x205)]]),__metadata('design:returntype',Promise)],OfficialController[_0x10d8e5(0x204)],'bindWxBySceneStr',null),__decorate([(0x0,common_1['Post'])('getRedirectUrl'),(0x0,swagger_1[_0x10d8e5(0x221)])({'summary':'获取登录跳转地址'}),__param(0x0,(0x0,common_1[_0x10d8e5(0x21c)])()),__metadata(_0x10d8e5(0x22a),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x10d8e5(0x21a),Promise)],OfficialController['prototype'],_0x10d8e5(0x1e4),null),__decorate([(0x0,common_1['Post'])(_0x10d8e5(0x202)),(0x0,swagger_1[_0x10d8e5(0x221)])({'summary':_0x10d8e5(0x1ef)}),__param(0x0,(0x0,common_1[_0x10d8e5(0x21c)])()),__metadata(_0x10d8e5(0x22a),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x10d8e5(0x21a),Promise)],OfficialController[_0x10d8e5(0x204)],'getJsapiTicket',null),__decorate([(0x0,common_1[_0x10d8e5(0x226)])('loginByCode'),(0x0,swagger_1[_0x10d8e5(0x221)])({'summary':_0x10d8e5(0x1db)}),__param(0x0,(0x0,common_1[_0x10d8e5(0x1e1)])()),__param(0x1,(0x0,common_1[_0x10d8e5(0x21c)])()),__metadata(_0x10d8e5(0x22a),Function),__metadata(_0x10d8e5(0x1d2),[Object,Object]),__metadata(_0x10d8e5(0x21a),Promise)],OfficialController[_0x10d8e5(0x204)],_0x10d8e5(0x1fb),null),OfficialController=__decorate([(0x0,swagger_1[_0x10d8e5(0x210)])(_0x10d8e5(0x1e7)),(0x0,common_1['Controller'])(_0x10d8e5(0x1e7)),__metadata(_0x10d8e5(0x1d2),[official_service_1[_0x10d8e5(0x1cf)]])],OfficialController),exports[_0x10d8e5(0x223)]=OfficialController;