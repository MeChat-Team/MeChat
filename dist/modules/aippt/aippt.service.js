'use strict';const _0x4ab4b3=_0x1dcc;function _0x2977(){const _0x51b99a=['generateContent','18CkbMVr','lang','HttpService','configService','defineProperty','apiBaseUrl','4wXBOvJ','__esModule','mergeMap','destroy','dataUrl','@nestjs/common','no-cache','data','get','toString','next','metadata','object','design:paramtypes','toPromise','44322EQHXER','781832GHWBFX','61735TUmUDj','generateOutline','pipe','map','/ppt/asyncPptInfo','outlineMarkdown','300470tZZGmM','keep-alive','startsWith','5624jIaaPl','235XXvOoK','error','handleSSEStream','stream','rxjs','end','post','Failed\x20to\x20parse\x20remaining\x20SSE\x20data:','Observable','length','split','35DNguyQ','httpService','@nestjs/axios','subject','__metadata','trim','__decorate','/ppt/generateOutline','apiToken','Failed\x20to\x20parse\x20SSE\x20data:','611955tRnPcn','decorate','text/event-stream','1683924DBuYxu','prompt','DOCMEE_API_URL','pop','Injectable','function','rxjs/operators','data:\x20','slice','DOCMEE_API_TOKEN'];_0x2977=function(){return _0x51b99a;};return _0x2977();}(function(_0x3e5d8c,_0x4d9f6a){const _0x2d27b7=_0x1dcc,_0x3c4c80=_0x3e5d8c();while(!![]){try{const _0x3eba42=parseInt(_0x2d27b7(0x139))/0x1*(-parseInt(_0x2d27b7(0x128))/0x2)+parseInt(_0x2d27b7(0x158))/0x3+parseInt(_0x2d27b7(0x142))/0x4*(parseInt(_0x2d27b7(0x143))/0x5)+parseInt(_0x2d27b7(0x137))/0x6*(parseInt(_0x2d27b7(0x14e))/0x7)+parseInt(_0x2d27b7(0x138))/0x8*(-parseInt(_0x2d27b7(0x166))/0x9)+-parseInt(_0x2d27b7(0x13f))/0xa+parseInt(_0x2d27b7(0x15b))/0xb;if(_0x3eba42===_0x4d9f6a)break;else _0x3c4c80['push'](_0x3c4c80['shift']());}catch(_0x277310){_0x3c4c80['push'](_0x3c4c80['shift']());}}}(_0x2977,0x1b207));var __decorate=this&&this[_0x4ab4b3(0x154)]||function(_0x194f0e,_0x3ef425,_0x4b56c4,_0x1da5f4){const _0x493103=_0x4ab4b3;var _0x553b91=arguments[_0x493103(0x14c)],_0x5ebb0b=_0x553b91<0x3?_0x3ef425:_0x1da5f4===null?_0x1da5f4=Object['getOwnPropertyDescriptor'](_0x3ef425,_0x4b56c4):_0x1da5f4,_0x29bae;if(typeof Reflect===_0x493103(0x134)&&typeof Reflect[_0x493103(0x159)]===_0x493103(0x160))_0x5ebb0b=Reflect[_0x493103(0x159)](_0x194f0e,_0x3ef425,_0x4b56c4,_0x1da5f4);else{for(var _0x252753=_0x194f0e[_0x493103(0x14c)]-0x1;_0x252753>=0x0;_0x252753--)if(_0x29bae=_0x194f0e[_0x252753])_0x5ebb0b=(_0x553b91<0x3?_0x29bae(_0x5ebb0b):_0x553b91>0x3?_0x29bae(_0x3ef425,_0x4b56c4,_0x5ebb0b):_0x29bae(_0x3ef425,_0x4b56c4))||_0x5ebb0b;}return _0x553b91>0x3&&_0x5ebb0b&&Object[_0x493103(0x126)](_0x3ef425,_0x4b56c4,_0x5ebb0b),_0x5ebb0b;},__metadata=this&&this[_0x4ab4b3(0x152)]||function(_0x4ea5e4,_0x5737e7){const _0x4168b2=_0x4ab4b3;if(typeof Reflect===_0x4168b2(0x134)&&typeof Reflect['metadata']===_0x4168b2(0x160))return Reflect[_0x4168b2(0x133)](_0x4ea5e4,_0x5737e7);};Object['defineProperty'](exports,_0x4ab4b3(0x129),{'value':!![]}),exports['AipptService']=void 0x0;const common_1=require(_0x4ab4b3(0x12d)),rxjs_1=require(_0x4ab4b3(0x147)),config_1=require('@nestjs/config'),axios_1=require(_0x4ab4b3(0x150)),operators_1=require(_0x4ab4b3(0x161));function _0x1dcc(_0x1eb91e,_0x22ee7f){const _0x29771f=_0x2977();return _0x1dcc=function(_0x1dcc0b,_0x4bb553){_0x1dcc0b=_0x1dcc0b-0x123;let _0x2e8a62=_0x29771f[_0x1dcc0b];return _0x2e8a62;},_0x1dcc(_0x1eb91e,_0x22ee7f);}let AipptService=class AipptService{constructor(_0x3dc19d,_0x31d088){const _0x482d12=_0x4ab4b3;this[_0x482d12(0x125)]=_0x3dc19d,this['httpService']=_0x31d088,this[_0x482d12(0x156)]=this[_0x482d12(0x125)]['get'](_0x482d12(0x164)),this[_0x482d12(0x127)]=this['configService'][_0x482d12(0x130)](_0x482d12(0x15d));}[_0x4ab4b3(0x145)](_0x2406cb){const _0xddf095=_0x4ab4b3;return new rxjs_1[(_0xddf095(0x14b))](_0x26a781=>{const _0x3a084c=_0xddf095;let _0x520072='';return _0x2406cb['on'](_0x3a084c(0x12f),_0x4ef739=>{const _0x13a0d0=_0x3a084c;_0x520072+=_0x4ef739[_0x13a0d0(0x131)]();const _0x18572c=_0x520072[_0x13a0d0(0x14d)]('\x0a');_0x520072=_0x18572c[_0x13a0d0(0x15e)]()||'';for(const _0x120845 of _0x18572c){if(_0x120845[_0x13a0d0(0x153)]()&&_0x120845[_0x13a0d0(0x141)](_0x13a0d0(0x162)))try{const _0x3246df=JSON['parse'](_0x120845[_0x13a0d0(0x163)](0x6));_0x26a781[_0x13a0d0(0x132)](_0x3246df);}catch(_0x310c3d){console[_0x13a0d0(0x144)](_0x13a0d0(0x157),_0x310c3d);}}}),_0x2406cb['on'](_0x3a084c(0x148),()=>{const _0x26a4fc=_0x3a084c;if(_0x520072['trim']())try{const _0x3130d2=JSON['parse'](_0x520072[_0x26a4fc(0x163)](0x6));_0x26a781['next'](_0x3130d2);}catch(_0x4b16f6){console[_0x26a4fc(0x144)](_0x26a4fc(0x14a),_0x4b16f6);}_0x26a781['complete']();}),_0x2406cb['on'](_0x3a084c(0x144),_0x1062e4=>{const _0x25af72=_0x3a084c;_0x26a781[_0x25af72(0x144)](_0x1062e4);}),()=>{const _0xfce5a2=_0x3a084c;_0x2406cb[_0xfce5a2(0x12b)]();};});}[_0x4ab4b3(0x13a)](_0x3d84a2){const _0x151e4e=_0x4ab4b3,_0xfc2d73=this[_0x151e4e(0x127)]+_0x151e4e(0x155),_0x1cefa2={'stream':!![],'length':_0x3d84a2['length'],'lang':_0x3d84a2[_0x151e4e(0x123)],'prompt':_0x3d84a2[_0x151e4e(0x15c)],'subject':_0x3d84a2[_0x151e4e(0x151)],'dataUrl':_0x3d84a2[_0x151e4e(0x12c)]};return this[_0x151e4e(0x14f)][_0x151e4e(0x149)](_0xfc2d73,_0x1cefa2,{'headers':{'Authorization':this[_0x151e4e(0x156)],'Accept':_0x151e4e(0x15a),'Cache-Control':_0x151e4e(0x12e),'Connection':_0x151e4e(0x140)},'responseType':'stream'})[_0x151e4e(0x13b)]((0x0,operators_1[_0x151e4e(0x13c)])(_0x5257f3=>_0x5257f3[_0x151e4e(0x12f)]),(0x0,operators_1[_0x151e4e(0x12a)])(_0x30b77c=>this['handleSSEStream'](_0x30b77c)));}[_0x4ab4b3(0x165)](_0x5d3e50){const _0x12542e=_0x4ab4b3,_0x54654c=this[_0x12542e(0x127)]+'/ppt/generateContent';return this[_0x12542e(0x14f)][_0x12542e(0x149)](_0x54654c,{'templateId':_0x5d3e50['templateId'],'outlineMarkdown':_0x5d3e50[_0x12542e(0x13e)],'asyncGenPptx':!![],'prompt':_0x5d3e50[_0x12542e(0x15c)],'dataUrl':_0x5d3e50[_0x12542e(0x12c)]},{'headers':{'Authorization':this['apiToken'],'Accept':_0x12542e(0x15a),'Cache-Control':'no-cache','Connection':'keep-alive'},'responseType':_0x12542e(0x146)})[_0x12542e(0x13b)]((0x0,operators_1[_0x12542e(0x13c)])(_0x6417b4=>_0x6417b4['data']),(0x0,operators_1[_0x12542e(0x12a)])(_0x4bfc3c=>this['handleSSEStream'](_0x4bfc3c)));}async['asyncPptInfo'](_0x4a69dc){const _0x1a5ae1=_0x4ab4b3,_0x27c467=this[_0x1a5ae1(0x127)]+_0x1a5ae1(0x13d),_0x5b94c1=await this[_0x1a5ae1(0x14f)]['get'](_0x27c467,{'params':{'pptId':_0x4a69dc},'headers':{'Authorization':this['apiToken']}})[_0x1a5ae1(0x136)]();return _0x5b94c1['data'];}};AipptService=__decorate([(0x0,common_1[_0x4ab4b3(0x15f)])(),__metadata(_0x4ab4b3(0x135),[config_1['ConfigService'],axios_1[_0x4ab4b3(0x124)]])],AipptService),exports['AipptService']=AipptService;