'use strict';function _0x179d(){const _0x193900=['metadata','亲爱的用户,请登录后继续操作,我们正在等您的到来！','../../modules/auth/auth.service','jsonwebtoken','design:paramtypes','canActivate','switchToHttp','HttpStatus','authService','createTokenFromFingerprint','@nestjs/passport','970055awfGiM','getRequest','340bQBWnz','666922udiKqI','slice','getOwnPropertyDescriptor','RedisCacheService','__decorate','UNAUTHORIZED','GlobalConfigService','7438230MivuqY','25899xXLkAe','6XzgCZD','verify','2PecWSF','validateToken','defineProperty','12138xNwmoP','Bearer','__metadata','split','user','@nestjs/common','jwt','@nestjs/core','decorate','moduleRef','1992xhgjTG','7252170okPfsn','fingerprint','headers','get','authorization','JwtAuthGuard','err:\x20','UnauthorizedException','__esModule','globalConfigService','function','redisCacheService','18757343mGHzVW','HttpException','length','x-website-domain','getJwtSecret','Injectable','ModuleRef','handleRequest','AuthGuard','object','AuthService'];_0x179d=function(){return _0x193900;};return _0x179d();}const _0x388e15=_0x7e23;(function(_0x46c448,_0x1a6a1c){const _0x4654e9=_0x7e23,_0x5be4a3=_0x46c448();while(!![]){try{const _0x32f1aa=-parseInt(_0x4654e9(0xf0))/0x1*(parseInt(_0x4654e9(0xe5))/0x2)+parseInt(_0x4654e9(0xed))/0x3*(parseInt(_0x4654e9(0xe4))/0x4)+parseInt(_0x4654e9(0xe2))/0x5*(-parseInt(_0x4654e9(0xee))/0x6)+parseInt(_0x4654e9(0xb5))/0x7*(parseInt(_0x4654e9(0xbf))/0x8)+-parseInt(_0x4654e9(0xec))/0x9+-parseInt(_0x4654e9(0xc0))/0xa+parseInt(_0x4654e9(0xcc))/0xb;if(_0x32f1aa===_0x1a6a1c)break;else _0x5be4a3['push'](_0x5be4a3['shift']());}catch(_0x19fafe){_0x5be4a3['push'](_0x5be4a3['shift']());}}}(_0x179d,0x6fdb4));var __decorate=this&&this[_0x388e15(0xe9)]||function(_0x5e0c73,_0x15fefa,_0x32a3e4,_0x452b19){const _0x4f5e01=_0x388e15;var _0x419988=arguments['length'],_0x5e7017=_0x419988<0x3?_0x15fefa:_0x452b19===null?_0x452b19=Object[_0x4f5e01(0xe7)](_0x15fefa,_0x32a3e4):_0x452b19,_0x4e0f39;if(typeof Reflect===_0x4f5e01(0xd5)&&typeof Reflect[_0x4f5e01(0xbd)]==='function')_0x5e7017=Reflect['decorate'](_0x5e0c73,_0x15fefa,_0x32a3e4,_0x452b19);else{for(var _0x50627a=_0x5e0c73[_0x4f5e01(0xce)]-0x1;_0x50627a>=0x0;_0x50627a--)if(_0x4e0f39=_0x5e0c73[_0x50627a])_0x5e7017=(_0x419988<0x3?_0x4e0f39(_0x5e7017):_0x419988>0x3?_0x4e0f39(_0x15fefa,_0x32a3e4,_0x5e7017):_0x4e0f39(_0x15fefa,_0x32a3e4))||_0x5e7017;}return _0x419988>0x3&&_0x5e7017&&Object[_0x4f5e01(0xf2)](_0x15fefa,_0x32a3e4,_0x5e7017),_0x5e7017;},__metadata=this&&this[_0x388e15(0xb7)]||function(_0xeb65b,_0x32bfba){const _0x1c576e=_0x388e15;if(typeof Reflect===_0x1c576e(0xd5)&&typeof Reflect[_0x1c576e(0xd7)]===_0x1c576e(0xca))return Reflect[_0x1c576e(0xd7)](_0xeb65b,_0x32bfba);};function _0x7e23(_0x53a910,_0x482e1c){const _0x179d14=_0x179d();return _0x7e23=function(_0x7e23c9,_0x4dfa5d){_0x7e23c9=_0x7e23c9-0xb5;let _0x50ead4=_0x179d14[_0x7e23c9];return _0x50ead4;},_0x7e23(_0x53a910,_0x482e1c);}Object[_0x388e15(0xf2)](exports,_0x388e15(0xc8),{'value':!![]}),exports[_0x388e15(0xc5)]=void 0x0;const globalConfig_service_1=require('../../modules/globalConfig/globalConfig.service'),redisCache_service_1=require('../../modules/redisCache/redisCache.service'),common_1=require(_0x388e15(0xba)),core_1=require(_0x388e15(0xbc)),passport_1=require(_0x388e15(0xe1)),jwt=require(_0x388e15(0xda)),auth_service_1=require(_0x388e15(0xd9));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x388e15(0xd4)])(_0x388e15(0xbb)){constructor(_0x52666e,_0x57ac25,_0x203e12,_0x20c7f2){const _0x45de78=_0x388e15;super(),this[_0x45de78(0xcb)]=_0x52666e,this[_0x45de78(0xbe)]=_0x57ac25,this[_0x45de78(0xc9)]=_0x203e12,this[_0x45de78(0xdf)]=_0x20c7f2;}async[_0x388e15(0xdc)](_0x86843d){const _0x56d786=_0x388e15;!this['redisCacheService']&&(this[_0x56d786(0xcb)]=this[_0x56d786(0xbe)][_0x56d786(0xc3)](redisCache_service_1['RedisCacheService'],{'strict':![]}));const _0x38365b=_0x86843d[_0x56d786(0xdd)]()[_0x56d786(0xe3)](),_0x2cc22f=_0x38365b[_0x56d786(0xc2)][_0x56d786(0xcf)],_0x3037d7=this['extractToken'](_0x38365b);return _0x38365b[_0x56d786(0xb9)]=await this['validateToken'](_0x3037d7),await this['redisCacheService']['checkTokenAuth'](_0x3037d7,_0x38365b),!![];}['extractToken'](_0x3e7d61){const _0x3d547c=_0x388e15;if(!_0x3e7d61[_0x3d547c(0xc2)][_0x3d547c(0xc4)]){if(_0x3e7d61['headers'][_0x3d547c(0xc1)]){let _0x4d0212=_0x3e7d61[_0x3d547c(0xc2)][_0x3d547c(0xc1)];_0x4d0212>0x7fffffff&&(_0x4d0212=_0x4d0212['toString']()[_0x3d547c(0xe6)](-0x9),_0x4d0212=Number(String(Number(_0x4d0212))));const _0x280332=this['authService'][_0x3d547c(0xe0)](_0x4d0212);return _0x280332;}return null;}const _0xcd248a=_0x3e7d61[_0x3d547c(0xc2)][_0x3d547c(0xc4)][_0x3d547c(0xb8)]('\x20');if(_0xcd248a['length']!==0x2||_0xcd248a[0x0]!==_0x3d547c(0xb6))return null;return _0xcd248a[0x1];}async[_0x388e15(0xf1)](_0x4c4e7d){const _0x3cd8e8=_0x388e15;try{const _0x3d7940=await this[_0x3cd8e8(0xcb)][_0x3cd8e8(0xd0)](),_0x198eb3=await jwt[_0x3cd8e8(0xef)](_0x4c4e7d,_0x3d7940);return _0x198eb3;}catch(_0x2e884d){throw new common_1[(_0x3cd8e8(0xcd))](_0x3cd8e8(0xd8),common_1[_0x3cd8e8(0xde)][_0x3cd8e8(0xea)]);}}[_0x388e15(0xd3)](_0x495b76,_0x100a93,_0x3bad7b){const _0x12a04e=_0x388e15;if(_0x495b76||!_0x100a93){console['log'](_0x12a04e(0xc6),_0x495b76);throw _0x495b76||new common_1[(_0x12a04e(0xc7))]();}return _0x100a93;}};JwtAuthGuard=__decorate([(0x0,common_1[_0x388e15(0xd1)])(),__metadata(_0x388e15(0xdb),[redisCache_service_1[_0x388e15(0xe8)],core_1[_0x388e15(0xd2)],globalConfig_service_1[_0x388e15(0xeb)],auth_service_1[_0x388e15(0xd6)]])],JwtAuthGuard),exports['JwtAuthGuard']=JwtAuthGuard;