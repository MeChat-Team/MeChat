'use strict';function _0x536e(_0xdee5f6,_0x12cf1a){const _0x50f5b0=_0x50f5();return _0x536e=function(_0x536e11,_0x4ca0b0){_0x536e11=_0x536e11-0x1ec;let _0x8e88c=_0x50f5b0[_0x536e11];return _0x8e88c;},_0x536e(_0xdee5f6,_0x12cf1a);}const _0x4edf45=_0x536e;(function(_0x5ccf49,_0x48fb1c){const _0x2d90fb=_0x536e,_0xfd18c7=_0x5ccf49();while(!![]){try{const _0x1a8c51=parseInt(_0x2d90fb(0x224))/0x1+parseInt(_0x2d90fb(0x1ed))/0x2*(-parseInt(_0x2d90fb(0x21b))/0x3)+-parseInt(_0x2d90fb(0x221))/0x4+-parseInt(_0x2d90fb(0x1f0))/0x5*(parseInt(_0x2d90fb(0x1fa))/0x6)+parseInt(_0x2d90fb(0x1fc))/0x7+-parseInt(_0x2d90fb(0x1f2))/0x8*(parseInt(_0x2d90fb(0x1ef))/0x9)+parseInt(_0x2d90fb(0x1fb))/0xa;if(_0x1a8c51===_0x48fb1c)break;else _0xfd18c7['push'](_0xfd18c7['shift']());}catch(_0x4fa20c){_0xfd18c7['push'](_0xfd18c7['shift']());}}}(_0x50f5,0xe8320));var __decorate=this&&this[_0x4edf45(0x227)]||function(_0x14762f,_0xb5e227,_0x3c9fb0,_0x17687e){const _0x3955ae=_0x4edf45;var _0x4ffc8a=arguments[_0x3955ae(0x21a)],_0x347cdc=_0x4ffc8a<0x3?_0xb5e227:_0x17687e===null?_0x17687e=Object[_0x3955ae(0x203)](_0xb5e227,_0x3c9fb0):_0x17687e,_0x5e85f3;if(typeof Reflect==='object'&&typeof Reflect[_0x3955ae(0x211)]===_0x3955ae(0x1f5))_0x347cdc=Reflect[_0x3955ae(0x211)](_0x14762f,_0xb5e227,_0x3c9fb0,_0x17687e);else{for(var _0x10fdb8=_0x14762f[_0x3955ae(0x21a)]-0x1;_0x10fdb8>=0x0;_0x10fdb8--)if(_0x5e85f3=_0x14762f[_0x10fdb8])_0x347cdc=(_0x4ffc8a<0x3?_0x5e85f3(_0x347cdc):_0x4ffc8a>0x3?_0x5e85f3(_0xb5e227,_0x3c9fb0,_0x347cdc):_0x5e85f3(_0xb5e227,_0x3c9fb0))||_0x347cdc;}return _0x4ffc8a>0x3&&_0x347cdc&&Object[_0x3955ae(0x200)](_0xb5e227,_0x3c9fb0,_0x347cdc),_0x347cdc;},__metadata=this&&this[_0x4edf45(0x202)]||function(_0x10d952,_0x5d732f){const _0x4fc382=_0x4edf45;if(typeof Reflect===_0x4fc382(0x212)&&typeof Reflect['metadata']===_0x4fc382(0x1f5))return Reflect[_0x4fc382(0x228)](_0x10d952,_0x5d732f);};Object[_0x4edf45(0x200)](exports,_0x4edf45(0x209),{'value':!![]}),exports[_0x4edf45(0x1f1)]=void 0x0;const globalConfig_service_1=require(_0x4edf45(0x1ec)),redisCache_service_1=require(_0x4edf45(0x1fd)),common_1=require(_0x4edf45(0x20a)),core_1=require(_0x4edf45(0x201)),passport_1=require(_0x4edf45(0x223)),jwt=require('jsonwebtoken'),auth_service_1=require(_0x4edf45(0x20e));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x4edf45(0x205)])('jwt'){constructor(_0x312028,_0x37e04f,_0x1dd82a,_0x19a5ed){const _0x291e24=_0x4edf45;super(),this[_0x291e24(0x20f)]=_0x312028,this['moduleRef']=_0x37e04f,this['globalConfigService']=_0x1dd82a,this[_0x291e24(0x222)]=_0x19a5ed;}async[_0x4edf45(0x1ff)](_0x472bac){const _0x1d57a7=_0x4edf45;!this[_0x1d57a7(0x20f)]&&(this[_0x1d57a7(0x20f)]=this[_0x1d57a7(0x1f9)][_0x1d57a7(0x21f)](redisCache_service_1[_0x1d57a7(0x217)],{'strict':![]}));const _0x539d42=_0x472bac[_0x1d57a7(0x214)]()[_0x1d57a7(0x1fe)](),_0x442518=_0x539d42[_0x1d57a7(0x213)][_0x1d57a7(0x20d)],_0x87e002=this[_0x1d57a7(0x208)](_0x539d42);return _0x539d42[_0x1d57a7(0x1f3)]=await this[_0x1d57a7(0x204)](_0x87e002),await this['redisCacheService'][_0x1d57a7(0x1f6)](_0x87e002,_0x539d42),!![];}[_0x4edf45(0x208)](_0x437c0e){const _0x2351bc=_0x4edf45;if(!_0x437c0e[_0x2351bc(0x213)][_0x2351bc(0x1f8)]){if(_0x437c0e[_0x2351bc(0x213)][_0x2351bc(0x1f7)]){let _0x2bc648=_0x437c0e[_0x2351bc(0x213)]['fingerprint'];_0x2bc648>0x7fffffff&&(_0x2bc648=_0x2bc648[_0x2351bc(0x219)]()[_0x2351bc(0x210)](-0x9),_0x2bc648=Number(String(Number(_0x2bc648))));const _0xe990b4=this[_0x2351bc(0x222)][_0x2351bc(0x21c)](_0x2bc648);return _0xe990b4;}return null;}const _0x2ce267=_0x437c0e['headers'][_0x2351bc(0x1f8)][_0x2351bc(0x21d)]('\x20');if(_0x2ce267[_0x2351bc(0x21a)]!==0x2||_0x2ce267[0x0]!=='Bearer')return null;return _0x2ce267[0x1];}async['validateToken'](_0x41d4da){const _0x306aaa=_0x4edf45;try{const _0x43941a=await this[_0x306aaa(0x20f)][_0x306aaa(0x207)](),_0x32546e=await jwt[_0x306aaa(0x20b)](_0x41d4da,_0x43941a);return _0x32546e;}catch(_0x3531d9){throw new common_1[(_0x306aaa(0x215))]('亲爱的用户,请登录后继续操作,我们正在等您的到来！',common_1[_0x306aaa(0x220)][_0x306aaa(0x206)]);}}['handleRequest'](_0xa0363f,_0x3c541b,_0x1d80fc){const _0x54f14b=_0x4edf45;if(_0xa0363f||!_0x3c541b){console[_0x54f14b(0x225)](_0x54f14b(0x1ee),_0xa0363f);throw _0xa0363f||new common_1[(_0x54f14b(0x226))]();}return _0x3c541b;}};JwtAuthGuard=__decorate([(0x0,common_1[_0x4edf45(0x218)])(),__metadata(_0x4edf45(0x21e),[redisCache_service_1['RedisCacheService'],core_1[_0x4edf45(0x1f4)],globalConfig_service_1[_0x4edf45(0x216)],auth_service_1[_0x4edf45(0x20c)]])],JwtAuthGuard),exports['JwtAuthGuard']=JwtAuthGuard;function _0x50f5(){const _0x12e4d7=['headers','switchToHttp','HttpException','GlobalConfigService','RedisCacheService','Injectable','toString','length','315bKaRKO','createTokenFromFingerprint','split','design:paramtypes','get','HttpStatus','2527568HFqCYo','authService','@nestjs/passport','517374lCeyeK','log','UnauthorizedException','__decorate','metadata','../../modules/globalConfig/globalConfig.service','27332ZaauXj','err:\x20','29430gSKrGp','5cHvlAK','JwtAuthGuard','1952LrUEHa','user','ModuleRef','function','checkTokenAuth','fingerprint','authorization','moduleRef','5283282LdNVZa','33721110ZlqVBp','5647852TOgoPX','../../modules/redisCache/redisCache.service','getRequest','canActivate','defineProperty','@nestjs/core','__metadata','getOwnPropertyDescriptor','validateToken','AuthGuard','UNAUTHORIZED','getJwtSecret','extractToken','__esModule','@nestjs/common','verify','AuthService','x-website-domain','../../modules/auth/auth.service','redisCacheService','slice','decorate','object'];_0x50f5=function(){return _0x12e4d7;};return _0x50f5();}