'use strict';const _0x462e92=_0x4548;(function(_0x5353b1,_0x5d36af){const _0x5359d8=_0x4548,_0x45768a=_0x5353b1();while(!![]){try{const _0x27613a=parseInt(_0x5359d8(0xcf))/0x1+-parseInt(_0x5359d8(0xa8))/0x2+parseInt(_0x5359d8(0xa7))/0x3*(-parseInt(_0x5359d8(0xd7))/0x4)+-parseInt(_0x5359d8(0xb1))/0x5*(-parseInt(_0x5359d8(0xd8))/0x6)+-parseInt(_0x5359d8(0xca))/0x7*(parseInt(_0x5359d8(0xb2))/0x8)+-parseInt(_0x5359d8(0xc4))/0x9*(parseInt(_0x5359d8(0xb0))/0xa)+parseInt(_0x5359d8(0xd1))/0xb*(parseInt(_0x5359d8(0xad))/0xc);if(_0x27613a===_0x5d36af)break;else _0x45768a['push'](_0x45768a['shift']());}catch(_0x5a84b1){_0x45768a['push'](_0x45768a['shift']());}}}(_0xfbd8,0xacd7e));var __decorate=this&&this['__decorate']||function(_0xece27d,_0x55ec5c,_0xf9c942,_0x306481){const _0x2920a7=_0x4548;var _0x21e164=arguments[_0x2920a7(0xb6)],_0xf305f2=_0x21e164<0x3?_0x55ec5c:_0x306481===null?_0x306481=Object['getOwnPropertyDescriptor'](_0x55ec5c,_0xf9c942):_0x306481,_0x154ae8;if(typeof Reflect===_0x2920a7(0xcd)&&typeof Reflect[_0x2920a7(0xd4)]===_0x2920a7(0xb7))_0xf305f2=Reflect['decorate'](_0xece27d,_0x55ec5c,_0xf9c942,_0x306481);else{for(var _0xd251ea=_0xece27d[_0x2920a7(0xb6)]-0x1;_0xd251ea>=0x0;_0xd251ea--)if(_0x154ae8=_0xece27d[_0xd251ea])_0xf305f2=(_0x21e164<0x3?_0x154ae8(_0xf305f2):_0x21e164>0x3?_0x154ae8(_0x55ec5c,_0xf9c942,_0xf305f2):_0x154ae8(_0x55ec5c,_0xf9c942))||_0xf305f2;}return _0x21e164>0x3&&_0xf305f2&&Object[_0x2920a7(0xbb)](_0x55ec5c,_0xf9c942,_0xf305f2),_0xf305f2;},__metadata=this&&this['__metadata']||function(_0x44b3b5,_0x376e78){const _0x1b9f31=_0x4548;if(typeof Reflect===_0x1b9f31(0xcd)&&typeof Reflect[_0x1b9f31(0xd2)]===_0x1b9f31(0xb7))return Reflect[_0x1b9f31(0xd2)](_0x44b3b5,_0x376e78);};Object[_0x462e92(0xbb)](exports,'__esModule',{'value':!![]}),exports[_0x462e92(0xc7)]=void 0x0;function _0xfbd8(){const _0x35017d=['authorization','52HXfpSV','3622206qujsrb','canActivate','user','294669qopISV','483412UokMQD','design:paramtypes','AuthGuard','err:\x20','@nestjs/core','24krFBBh','redisCacheService','getRequest','13201230DfueJX','5mNlojs','2832cKwuaR','toString','globalConfigService','checkTokenAuth','length','function','slice','get','log','defineProperty','../../modules/globalConfig/globalConfig.service','@nestjs/passport','moduleRef','亲爱的用户,请登录后继续操作,我们正在等您的到来！','extractToken','UnauthorizedException','jsonwebtoken','headers','9OEpfcs','createTokenFromFingerprint','jwt','JwtAuthGuard','fingerprint','validateToken','27622TQulVM','switchToHttp','Bearer','object','getJwtSecret','1251543NmJSyl','@nestjs/common','16985837bJqINs','metadata','split','decorate','UNAUTHORIZED'];_0xfbd8=function(){return _0x35017d;};return _0xfbd8();}const globalConfig_service_1=require(_0x462e92(0xbc)),redisCache_service_1=require('../../modules/redisCache/redisCache.service'),common_1=require(_0x462e92(0xd0)),core_1=require(_0x462e92(0xac)),passport_1=require(_0x462e92(0xbd)),jwt=require(_0x462e92(0xc2)),auth_service_1=require('../../modules/auth/auth.service');function _0x4548(_0x236f28,_0x4c1661){const _0xfbd87b=_0xfbd8();return _0x4548=function(_0x45487b,_0x5d97e6){_0x45487b=_0x45487b-0xa7;let _0x45a6ca=_0xfbd87b[_0x45487b];return _0x45a6ca;},_0x4548(_0x236f28,_0x4c1661);}let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x462e92(0xaa)])(_0x462e92(0xc6)){constructor(_0x38b967,_0x25401a,_0x497694,_0x12cf51){const _0xe0f47=_0x462e92;super(),this[_0xe0f47(0xae)]=_0x38b967,this[_0xe0f47(0xbe)]=_0x25401a,this[_0xe0f47(0xb4)]=_0x497694,this['authService']=_0x12cf51;}async[_0x462e92(0xd9)](_0x308b53){const _0x5d4f8a=_0x462e92;!this[_0x5d4f8a(0xae)]&&(this[_0x5d4f8a(0xae)]=this['moduleRef'][_0x5d4f8a(0xb9)](redisCache_service_1['RedisCacheService'],{'strict':![]}));const _0x218e34=_0x308b53[_0x5d4f8a(0xcb)]()[_0x5d4f8a(0xaf)](),_0x8259bc=_0x218e34[_0x5d4f8a(0xc3)]['x-website-domain'],_0x3ae046=this[_0x5d4f8a(0xc0)](_0x218e34);return _0x218e34[_0x5d4f8a(0xda)]=await this[_0x5d4f8a(0xc9)](_0x3ae046),await this[_0x5d4f8a(0xae)][_0x5d4f8a(0xb5)](_0x3ae046,_0x218e34),!![];}[_0x462e92(0xc0)](_0x1fcb37){const _0x4f5f7a=_0x462e92;if(!_0x1fcb37[_0x4f5f7a(0xc3)][_0x4f5f7a(0xd6)]){if(_0x1fcb37['headers'][_0x4f5f7a(0xc8)]){let _0x5cc11b=_0x1fcb37[_0x4f5f7a(0xc3)]['fingerprint'];_0x5cc11b>0x7fffffff&&(_0x5cc11b=_0x5cc11b[_0x4f5f7a(0xb3)]()[_0x4f5f7a(0xb8)](-0x9),_0x5cc11b=Number(String(Number(_0x5cc11b))));const _0x4ed0d9=this['authService'][_0x4f5f7a(0xc5)](_0x5cc11b);return _0x4ed0d9;}return null;}const _0x3ec9df=_0x1fcb37[_0x4f5f7a(0xc3)][_0x4f5f7a(0xd6)][_0x4f5f7a(0xd3)]('\x20');if(_0x3ec9df[_0x4f5f7a(0xb6)]!==0x2||_0x3ec9df[0x0]!==_0x4f5f7a(0xcc))return null;return _0x3ec9df[0x1];}async[_0x462e92(0xc9)](_0x2404c5){const _0x549f08=_0x462e92;try{const _0x26f70d=await this[_0x549f08(0xae)][_0x549f08(0xce)](),_0x3ede45=await jwt['verify'](_0x2404c5,_0x26f70d);return _0x3ede45;}catch(_0x392ae4){throw new common_1['HttpException'](_0x549f08(0xbf),common_1['HttpStatus'][_0x549f08(0xd5)]);}}['handleRequest'](_0x56c9a9,_0x4f05e5,_0x160561){const _0x322739=_0x462e92;if(_0x56c9a9||!_0x4f05e5){console[_0x322739(0xba)](_0x322739(0xab),_0x56c9a9);throw _0x56c9a9||new common_1[(_0x322739(0xc1))]();}return _0x4f05e5;}};JwtAuthGuard=__decorate([(0x0,common_1['Injectable'])(),__metadata(_0x462e92(0xa9),[redisCache_service_1['RedisCacheService'],core_1['ModuleRef'],globalConfig_service_1['GlobalConfigService'],auth_service_1['AuthService']])],JwtAuthGuard),exports['JwtAuthGuard']=JwtAuthGuard;