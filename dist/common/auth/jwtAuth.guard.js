'use strict';const _0x4b2ded=_0x4731;(function(_0x18da93,_0x429714){const _0x41dda2=_0x4731,_0x5e17cb=_0x18da93();while(!![]){try{const _0x54fe1b=parseInt(_0x41dda2(0xd7))/0x1+parseInt(_0x41dda2(0xcf))/0x2*(-parseInt(_0x41dda2(0xfa))/0x3)+parseInt(_0x41dda2(0xca))/0x4*(-parseInt(_0x41dda2(0xc5))/0x5)+-parseInt(_0x41dda2(0xc9))/0x6+-parseInt(_0x41dda2(0xd5))/0x7+-parseInt(_0x41dda2(0xc4))/0x8*(parseInt(_0x41dda2(0xf9))/0x9)+parseInt(_0x41dda2(0xdc))/0xa*(parseInt(_0x41dda2(0xea))/0xb);if(_0x54fe1b===_0x429714)break;else _0x5e17cb['push'](_0x5e17cb['shift']());}catch(_0x1ddca8){_0x5e17cb['push'](_0x5e17cb['shift']());}}}(_0x2cf8,0x9b181));function _0x2cf8(){const _0x320cef=['Bearer','length','@nestjs/common','48030govORN','AuthService','RedisCacheService','Injectable','switchToHttp','getJwtSecret','4504654YOpmck','moduleRef','1074119VPygFg','__esModule','slice','fingerprint','x-website-domain','10hknwSm','authService','@nestjs/core','get','HttpException','__metadata','user','redisCacheService','headers','verify','UnauthorizedException','toString','decorate','checkTokenAuth','25623609sYbVkn','object','亲爱的用户,请登录后继续操作,我们正在等您的到来！','jwt','../../modules/auth/auth.service','UNAUTHORIZED','getRequest','GlobalConfigService','metadata','function','AuthGuard','../../modules/redisCache/redisCache.service','authorization','split','log','1825371pxcVit','18nXRvCD','extractToken','handleRequest','getOwnPropertyDescriptor','../../modules/globalConfig/globalConfig.service','8YRrcGi','5HyHEMh','jsonwebtoken','design:paramtypes','JwtAuthGuard','5716698yCjfEM','3300236sJCDcf','globalConfigService'];_0x2cf8=function(){return _0x320cef;};return _0x2cf8();}var __decorate=this&&this['__decorate']||function(_0x206342,_0x11f5c9,_0x316666,_0x8f73){const _0x2e09a8=_0x4731;var _0x353e08=arguments[_0x2e09a8(0xcd)],_0x30a46e=_0x353e08<0x3?_0x11f5c9:_0x8f73===null?_0x8f73=Object[_0x2e09a8(0xfd)](_0x11f5c9,_0x316666):_0x8f73,_0x36fb9e;if(typeof Reflect===_0x2e09a8(0xeb)&&typeof Reflect[_0x2e09a8(0xe8)]==='function')_0x30a46e=Reflect[_0x2e09a8(0xe8)](_0x206342,_0x11f5c9,_0x316666,_0x8f73);else{for(var _0x3c66a7=_0x206342[_0x2e09a8(0xcd)]-0x1;_0x3c66a7>=0x0;_0x3c66a7--)if(_0x36fb9e=_0x206342[_0x3c66a7])_0x30a46e=(_0x353e08<0x3?_0x36fb9e(_0x30a46e):_0x353e08>0x3?_0x36fb9e(_0x11f5c9,_0x316666,_0x30a46e):_0x36fb9e(_0x11f5c9,_0x316666))||_0x30a46e;}return _0x353e08>0x3&&_0x30a46e&&Object['defineProperty'](_0x11f5c9,_0x316666,_0x30a46e),_0x30a46e;},__metadata=this&&this[_0x4b2ded(0xe1)]||function(_0x2c139f,_0x3718f4){const _0x50998c=_0x4b2ded;if(typeof Reflect===_0x50998c(0xeb)&&typeof Reflect[_0x50998c(0xf2)]===_0x50998c(0xf3))return Reflect[_0x50998c(0xf2)](_0x2c139f,_0x3718f4);};Object['defineProperty'](exports,_0x4b2ded(0xd8),{'value':!![]}),exports[_0x4b2ded(0xc8)]=void 0x0;const globalConfig_service_1=require(_0x4b2ded(0xfe)),redisCache_service_1=require(_0x4b2ded(0xf5)),common_1=require(_0x4b2ded(0xce)),core_1=require(_0x4b2ded(0xde)),passport_1=require('@nestjs/passport'),jwt=require(_0x4b2ded(0xc6)),auth_service_1=require(_0x4b2ded(0xee));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x4b2ded(0xf4)])(_0x4b2ded(0xed)){constructor(_0x21a837,_0x5e6dbd,_0xe5e747,_0x268b1b){const _0xb2f89f=_0x4b2ded;super(),this['redisCacheService']=_0x21a837,this['moduleRef']=_0x5e6dbd,this[_0xb2f89f(0xcb)]=_0xe5e747,this['authService']=_0x268b1b;}async['canActivate'](_0x2aea6c){const _0x2feae2=_0x4b2ded;!this['redisCacheService']&&(this[_0x2feae2(0xe3)]=this[_0x2feae2(0xd6)][_0x2feae2(0xdf)](redisCache_service_1[_0x2feae2(0xd1)],{'strict':![]}));const _0x4b2f1c=_0x2aea6c[_0x2feae2(0xd3)]()[_0x2feae2(0xf0)](),_0x377ecf=_0x4b2f1c[_0x2feae2(0xe4)][_0x2feae2(0xdb)],_0xc040a6=this[_0x2feae2(0xfb)](_0x4b2f1c);return _0x4b2f1c[_0x2feae2(0xe2)]=await this['validateToken'](_0xc040a6),await this[_0x2feae2(0xe3)][_0x2feae2(0xe9)](_0xc040a6,_0x4b2f1c),!![];}[_0x4b2ded(0xfb)](_0x355e74){const _0x2d636f=_0x4b2ded;if(!_0x355e74[_0x2d636f(0xe4)][_0x2d636f(0xf6)]){if(_0x355e74[_0x2d636f(0xe4)][_0x2d636f(0xda)]){let _0x343a0d=_0x355e74['headers'][_0x2d636f(0xda)];_0x343a0d>0x7fffffff&&(_0x343a0d=_0x343a0d[_0x2d636f(0xe7)]()[_0x2d636f(0xd9)](-0x9),_0x343a0d=Number(String(Number(_0x343a0d))));const _0x376665=this[_0x2d636f(0xdd)]['createTokenFromFingerprint'](_0x343a0d);return _0x376665;}return null;}const _0x4eff0b=_0x355e74['headers'][_0x2d636f(0xf6)][_0x2d636f(0xf7)]('\x20');if(_0x4eff0b['length']!==0x2||_0x4eff0b[0x0]!==_0x2d636f(0xcc))return null;return _0x4eff0b[0x1];}async['validateToken'](_0x378fd2){const _0x47210d=_0x4b2ded;try{const _0x580269=await this['redisCacheService'][_0x47210d(0xd4)](),_0x206491=await jwt[_0x47210d(0xe5)](_0x378fd2,_0x580269);return _0x206491;}catch(_0x576789){throw new common_1[(_0x47210d(0xe0))](_0x47210d(0xec),common_1['HttpStatus'][_0x47210d(0xef)]);}}[_0x4b2ded(0xfc)](_0x326d21,_0x476695,_0x3bccac){const _0x35e03d=_0x4b2ded;if(_0x326d21||!_0x476695){console[_0x35e03d(0xf8)]('err:\x20',_0x326d21);throw _0x326d21||new common_1[(_0x35e03d(0xe6))]();}return _0x476695;}};function _0x4731(_0x5767d5,_0x103ada){const _0x2cf832=_0x2cf8();return _0x4731=function(_0x4731aa,_0x18084f){_0x4731aa=_0x4731aa-0xc4;let _0xc550a1=_0x2cf832[_0x4731aa];return _0xc550a1;},_0x4731(_0x5767d5,_0x103ada);}JwtAuthGuard=__decorate([(0x0,common_1[_0x4b2ded(0xd2)])(),__metadata(_0x4b2ded(0xc7),[redisCache_service_1[_0x4b2ded(0xd1)],core_1['ModuleRef'],globalConfig_service_1[_0x4b2ded(0xf1)],auth_service_1[_0x4b2ded(0xd0)]])],JwtAuthGuard),exports[_0x4b2ded(0xc8)]=JwtAuthGuard;