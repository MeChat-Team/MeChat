import{W as o,k as se,r as k,c as s,w as C,o as ae,R as f,S as W,a2 as r,V as c,K as a,j as g,U as B,a6 as h,a3 as m,a4 as S,z as le}from"./vue-24971718.js";import{I as x,l as re,_ as ce,S as ue,M as de,d as y,g as ke}from"./menu-c99e2e5c.js";import{u as fe,l as ge,e as he,k as me,a as ve,t as u}from"./index-024c691e.js";import{u as ye}from"./useBasicLayout-259ce701.js";import{d as xe,x as we}from"./naive-ui-95c9585a.js";const be=x("calendar",!1,function(e){return o("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[o("path",{d:"M5 19H43V40C43 41.1046 42.1046 42 41 42H7C5.89543 42 5 41.1046 5 40V19Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M5 9C5 7.89543 5.89543 7 7 7H41C42.1046 7 43 7.89543 43 9V19H5V9Z",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M16 4V12",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M32 4V12",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M28 34H34",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M14 34H20",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M28 26H34",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M14 26H20",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),je=x("commodity",!1,function(e){return o("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[o("path",{d:"M9.78101 9.75193C9.90612 8.75107 10.7569 8 11.7656 8H36.2344C37.2431 8 38.0939 8.75107 38.219 9.75193L41.719 37.7519C41.8682 38.9456 40.9374 40 39.7344 40H8.26556C7.06257 40 6.1318 38.9456 6.28101 37.7519L9.78101 9.75193Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M15 18C15 18 17 22 24 22C31 22 33 18 33 18",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Ce=x("delete-themes",!0,function(e){return o("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 15H40L37 44H11L8 15Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M20.002 25.0024V35.0026",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap},null),o("path",{d:"M28.0024 24.9995V34.9972",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap},null),o("path",{d:"M12 14.9999L28.3242 3L36 15",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Le=x("logout",!0,function(e){return o("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[o("path",{d:"M23.9917 6H6V42H24",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M33 33L42 24L33 15",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M16 23.9917H42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),D=x("user",!1,function(e){return o("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[o("circle",{cx:"24",cy:"12",r:"8",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M42 44C42 34.0589 33.9411 26 24 26C14.0589 26 6 34.0589 6 44",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Me={class:"h-11 px-1 flex flex items-center"},Te={class:"h-full flex items-center"},Ne={class:"w-[26px] h-[26px] rounded-full bg-primary-600 flex items-center justify-center overflow-hidden shadow-sm border border-gray-300"},ze=["src"],We={class:"py-1"},_e=se({__name:"relative",setup(e){var V;const L=fe(),M=ge(),w=he(),d=me(),l=ve(),I=k(null),_=k(null),P=k(null),U=s(()=>{var i;return Number((i=l.globalConfig)==null?void 0:i.signInStatus)===1}),G=s(()=>w.theme==="dark"),T=s(()=>l.userBalance),N=s(()=>d.currentPlugin),A=xe(),O=k(0),R=k(0),$=k(0),Z=k(0),q=k(0),F=k(0),{isMobile:b}=ye(),j=s(()=>l.isLogin);s(()=>l.globalConfig.clientLogoPath||re),s(()=>l.globalConfig.clientHomePath||"/"),(V=l.globalConfig)!=null&&V.siteName;const E=s(()=>l.globalConfig.model3Name||u("chat.ordinaryPoints")),J=s(()=>l.globalConfig.model4Name)||u("chat.advancedPoints"),K=s(()=>l.globalConfig.drawMjName)||u("chat.drawingPoints");s(()=>Number(l.globalConfig.pluginFirst)===1),s(()=>Number(l.globalConfig.isHidePlugin)===1);const z=s(()=>l.userInfo.avatar);s(()=>w.siderCollapsed),k("chat");const H=s(()=>l.globalConfig);s(()=>{var i,t;return((i=H.value)==null?void 0:i.companyName)&&((t=H.value)==null?void 0:t.filingNumber)});const p=s(()=>d.groupList.find(t=>t.uuid===d.active)),Q=s(()=>{var i;try{return JSON.parse(((i=p.value)==null?void 0:i.config)||"{}")}catch{return{}}}),X=s(()=>d==null?void 0:d.activeModelDeductType);s(()=>{var v;const i=((v=N==null?void 0:N.value)==null?void 0:v.deductType)||Q.value.deductType||X.value;let t,n;switch(i){case 1:t=T.value.sumModel3Count||0,n=E.value;break;case 2:t=T.value.sumModel4Count||0,n=J.value;break;case 3:t=T.value.sumDrawMjCount||0,n=K.value;break;default:t=0,n=u("chat.points")}return t>99999&&(t="不限",n="次数"),{remainingPoints:t,buttonText:n}});async function Y(){await ee(),M.replace({path:"user-center"})}async function ee(){return new Promise(i=>{setTimeout(()=>{l.isLogin||M.replace({path:"login"}),i()},100)})}function Be(){const i=G.value?"light":"dark";w.setTheme(i)}async function te(){A.warning({title:u("chat.clearConversation"),content:u("chat.clearAllNonFavoriteConversations"),positiveText:u("common.confirm"),negativeText:u("common.cancel"),onPositiveClick:async()=>{await d.delAllGroup(),await d.addNewChatGroup()}})}function oe(){j.value?l.logOut():l.setLoginDialog(!0)}function ne(){if(!j.value){l.setLoginDialog(!0);return}L.updateSignInDialog(!0)}function ie(){l.logOut(),M.replace("/")}return s(()=>b.value?{position:"fixed",zIndex:50}:{}),s(()=>b.value?{paddingBottom:"env(safe-area-inset-bottom)"}:{}),C(b,i=>{w.setSiderCollapsed(i)},{immediate:!0,flush:"post"}),C(()=>l.userBalance.useModel3Token,(i,t)=>{var n;O.value=t||0,R.value=i||0,(n=I.value)==null||n.play()},{immediate:!0,flush:"post"}),C(()=>l.userBalance.useModel4Token,(i,t)=>{var n;$.value=t||0,Z.value=i||0,(n=_.value)==null||n.play()},{immediate:!0,flush:"post"}),C(()=>l.userBalance.useDrawMjToken,(i,t)=>{var n;q.value=t||0,F.value=i||0,(n=P.value)==null||n.play()},{immediate:!0,flush:"post"}),ae(()=>{d.queryPlugins(),d.queryMyGroup()}),(i,t)=>(f(),W("div",Me,[r("div",{class:"w-8 h-8 mr-2 rounded-xl hover:bg-[#f0f0f0] flex items-center justify-center",onClick:t[0]||(t[0]=n=>a(L).updateNoticeDialog(!0))},[o(a(we),{trigger:"hover"},{trigger:c(()=>[o(a(ce),{icon:"tabler:bell",class:"text-[22px]"})]),default:c(()=>[t[4]||(t[4]=g(" 网站公告 "))]),_:1})]),j.value?(f(),B(a(ke),{key:0,as:"div",class:"relative inline-block text-left"},{default:c(()=>[r("div",Te,[o(a(ue),{class:"inline-flex h-full w-full justify-center items-center gap-x-1.5 rounded-md pr-3 text-sm font-semibold dark:text-gray-400 text-gray-700"},{default:c(()=>[r("div",Ne,[z.value?(f(),W("img",{key:0,src:z.value,class:"w-full h-full object-cover"},null,8,ze)):h("",!0),z.value?h("",!0):(f(),B(a(D),{key:1,theme:"outline",size:"20",class:"text-white"}))])]),_:1})]),o(le,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:c(()=>[o(a(de),{class:"absolute w-[228px] right-0 mb-2 p-1 origin-bottom-right divide-y divide-gray-100 rounded-2xl bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none dark:bg-gray-800 dark:text-gray-400 text-gray-900 z-50"},{default:c(()=>[r("div",We,[o(a(y),{class:"rounded-2xl"},{default:c(({active:n})=>[r("a",{href:"#",class:m([[n?"bg-gray-100  dark:bg-gray-700":"","group flex items-center justify-start px-2 py-2 text-sm whitespace-nowrap"],"dark:border-b-gray-800"]),onClick:te},[o(a(Ce),{theme:"outline",size:"16",class:"mr-2"}),g(" "+S(a(u)("chat.clear")),1)],2)]),_:1}),t[7]||(t[7]=r("div",{class:"px-2"},[r("div",{class:"border-b border-b-gray-100"})],-1)),o(a(y),{class:"rounded-2xl"},{default:c(({active:n})=>[r("a",{href:"#",class:m([n?"bg-gray-100  dark:bg-gray-700":"","group flex items-center justify-start px-2 py-2 text-sm whitespace-nowrap"]),onClick:t[1]||(t[1]=v=>a(L).updateGoodsDialog(!0))},[o(a(je),{theme:"outline",size:"16",class:"mr-2"}),g(" "+S(a(u)("chat.pointsMall")),1)],2)]),_:1}),h("",!0),U.value?(f(),B(a(y),{key:1,class:"rounded-2xl"},{default:c(({active:n})=>[r("a",{href:"#",class:m([n?"bg-gray-100  dark:bg-gray-700":"","group flex items-center justify-start px-2 py-2 text-sm whitespace-nowrap"]),onClick:ne},[o(a(be),{theme:"outline",size:"16",class:"mr-2"}),g(" "+S(a(u)("chat.signInReward")),1)],2)]),_:1})):h("",!0),o(a(y),{class:"rounded-2xl"},{default:c(({active:n})=>[r("a",{href:"#",class:m([n?"bg-gray-100  dark:bg-gray-700":"","group flex items-center justify-start px-2 py-2 text-sm whitespace-nowrap"]),onClick:t[2]||(t[2]=v=>Y())},[o(a(D),{theme:"outline",size:"16",class:"mr-2"}),t[5]||(t[5]=g(" 个人中心 "))],2)]),_:1}),t[8]||(t[8]=r("div",{class:"px-2"},[r("div",{class:"border-t border-t-gray-100"})],-1)),o(a(y),{class:"rounded-2xl dark:border-t-gray-800"},{default:c(({active:n})=>[r("a",{href:"#",class:m([n?"bg-gray-100  dark:bg-gray-700":"","group flex items-center justify-start px-2 py-2 text-sm whitespace-nowrap"]),onClick:t[3]||(t[3]=v=>ie())},[o(a(Le),{theme:"outline",size:"16",class:"mr-2"}),t[6]||(t[6]=g(" 退出登录 "))],2)]),_:1})])]),_:1})]),_:1})]),_:1})):h("",!0),j.value?h("",!0):(f(),W("div",{key:1,onClick:oe,class:"flex items-center justify-center cursor-pointer"},[r("button",{type:"button",style:{"text-align":"center"},class:m([[a(b)?"text-xs w-12   h-8":"w-[72px] h-9  "],"inline-flex flex justify-center rounded-xl items-center bg-[#232629] text-[#ffffff]"])},t[9]||(t[9]=[r("span",null,"登录",-1)]),2)]))]))}});export{_e as _};
