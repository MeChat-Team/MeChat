import{k as W,r as y,c,w as X,i as N,o as Y,R as o,S as d,a2 as a,K as l,W as f,V as u,U as h,a6 as g,j as I,a8 as _,a4 as C,z as Z,F as ee,a7 as te}from"./vue-cbfd7fa1.js";import{d as se}from"./appStore-ca261899.js";import{d as ae,e as le,j as oe,m as re,F as ie}from"./index-bada37e0.js";import{u as ne}from"./useBasicLayout-5485175e.js";import{_ as ce}from"./relative.vue_vue_type_script_setup_true_lang-f1704e45.js";import{_ as S}from"./index.vue_vue_type_script_setup_true_lang-e4d8aab3.js";import{E as B}from"./naive-ui-8add5bf4.js";import{S as F,g as V,M as de,b as ue}from"./menu-b9522a75.js";import{R as fe}from"./Right-cc034a51.js";import{C as me}from"./CheckOne-6d4df2ce.js";import"./vueuse-motion-6e187fab.js";import"./logo-63e5ee5a.js";import"./index-e53e2518.js";const ve={class:"sticky top-0 left-0 right-0 z-30 dark:border-neutral-800 h-14 select-none"},pe={class:"relative flex items-center justify-center min-w-0 h-full"},ye={class:"flex w-full h-full items-center px-4"},he={key:0,class:"flex items-center pr-2"},ge={key:0,class:"flex items-center justify-center"},xe={class:"flex justify-between items-center h-full w-full"},we={class:"py-1"},_e={class:"flex items-center"},ke={class:"py-1"},be=["onClick"],Ce={class:"w-7 h-7 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden select-none"},Me=["src"],ze={key:1,class:"text-sm font-medium select-none"},Te={class:"flex flex-col flex-1 select-none"},je={href:"#",class:"text-sm select-none"},Ae={key:0,class:"text-xs text-gray-400 line-clamp-1 max-w-60 mr-2 select-none"},Ne={class:"ml-auto"},Ie={key:1,class:"w-4 h-4"},Se={class:"flex items-center h-full font-semibold"},Qe=W({__name:"index",emits:["export","toggleUsingContext","clear","scrollBtn"],setup(Be,{emit:Fe}){const M=ae(),m=le(),z=y([]),T=y(null);c(()=>m.groupList);const k=c(()=>M.siderCollapsed),H=c(()=>m.active),x=c(()=>m.currentPlugin),{isMobile:v}=ne(),b=y(!1),n=c(()=>m.getChatByGroupInfo());c(()=>m.chatList);const p=c(()=>{var e;const t=(e=n.value)==null?void 0:e.config;if(!t)return{};try{return JSON.parse(t)}catch{return{}}}),L=c(()=>{var t,e;return String(((e=(t=p==null?void 0:p.value)==null?void 0:t.modelInfo)==null?void 0:e.model)??"")}),U=c(()=>{var t;return((t=n==null?void 0:n.value)==null?void 0:t.appId)||0});let D=y({}),P=y([]);X(U,t=>{t?O(t):T.value=null},{immediate:!0});async function O(t){const e=await se({id:t});T.value=e.data}const $=c(()=>{var t,e,s,r;return((t=n==null?void 0:n.value)==null?void 0:t.appId)&&(((e=p.value.modelInfo)==null?void 0:e.isFixedModel)===1||((s=p.value.modelInfo)==null?void 0:s.isGPTs)===1)||x.value&&((r=x==null?void 0:x.value)==null?void 0:r.deductType)!==0});N("createNewChatGroup",()=>Promise.resolve());function G(){M.setSiderCollapsed(!k.value)}function q(){oe.push("/ModelMenu")}async function R(t){var A;const{modelInfo:e,fileInfo:s}=m.activeConfig,{isGPTs:r,isFixedModel:w,modelName:i}=e,Q={modelInfo:{keyType:t.keyType,modelName:((A=n==null?void 0:n.value)!=null&&A.appId?i:t.label)||"",model:t.value,deductType:t.deductType,deduct:t.deduct,isFileUpload:t.isFileUpload,modelAvatar:t.modelAvatar||"",isGPTs:r,isFixedModel:w},fileInfo:s||{}},K={groupId:H.value,config:JSON.stringify(Q)};await re(K),await m.queryMyGroup()}const j=y(!1);async function E(){const t=await ie();if(!t.success)return;const{modelMaps:e,modelTypeList:s}=t.data;D.value=e,P.value=s;const r=Object.values(e).flat(),w=r.filter(i=>i.keyType==1&&i.modelOrder<=10);r.length>w.length&&(j.value=!0),z.value=w.map(i=>({label:i.modelName,value:i.model,deductType:i.deductType,keyType:i.keyType,deduct:i.deduct,isFileUpload:i.isFileUpload,modelAvatar:i.modelAvatar,modelDescription:i.modelDescription}))}const J=N("createNewChatGroup",()=>Promise.resolve());return Y(()=>{setTimeout(()=>{E()},500)}),(t,e)=>(o(),d("header",ve,[a("div",pe,[a("div",ye,[k.value?(o(),d("div",he,[a("button",{class:"flex items-center justify-center w-5 h-full dark:text-gray-400 text-gray-500",onClick:G},[l(v)?(o(),h(l(B),{key:1,class:"text-[#262626]",size:"24"},{default:u(()=>e[5]||(e[5]=[a("svg",{t:"1735279906826",class:"icon",viewBox:"0 0 1088 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1466",width:"200",height:"200"},[a("path",{d:"M854.592 160c58.24 0 105.408 47.168 105.408 105.408v493.184c0 58.24-47.168 105.408-105.408 105.408H233.408C175.168 864 128 816.832 128 758.592V265.408c0-58.24 47.168-105.408 105.408-105.408h621.184z m-378.368 64H271.04C227.392 224 192 259.392 192 303.04v417.92c0 43.648 35.392 79.04 79.04 79.04h205.184v-576z m340.736 0H535.68v576h281.216c43.648 0 79.04-35.392 79.04-79.04v-417.92c0-43.648-35.392-79.04-79.04-79.04zM423.552 443.456v54.848h-158.08v-54.848h158.08z m0-146.304V352h-158.08v-54.848h158.08z","p-id":"1467"})],-1)])),_:1})):(o(),d("div",ge,[f(l(B),{class:"text-[#262626]",size:"23"},{default:u(()=>e[4]||(e[4]=[a("svg",{t:"1735279906826",class:"icon",viewBox:"0 0 1088 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1466",width:"200",height:"200"},[a("path",{d:"M854.592 160c58.24 0 105.408 47.168 105.408 105.408v493.184c0 58.24-47.168 105.408-105.408 105.408H233.408C175.168 864 128 816.832 128 758.592V265.408c0-58.24 47.168-105.408 105.408-105.408h621.184z m-378.368 64H271.04C227.392 224 192 259.392 192 303.04v417.92c0 43.648 35.392 79.04 79.04 79.04h205.184v-576z m340.736 0H535.68v576h281.216c43.648 0 79.04-35.392 79.04-79.04v-417.92c0-43.648-35.392-79.04-79.04-79.04zM423.552 443.456v54.848h-158.08v-54.848h158.08z m0-146.304V352h-158.08v-54.848h158.08z","p-id":"1467"})],-1)])),_:1})]))])])):g("",!0),a("div",xe,[$.value?(o(),h(l(V),{key:0,as:"div",class:"relative flex-1 flex ele-drag items-center justify-between h-full"},{default:u(()=>[a("div",null,[a("div",we,[f(l(F),{class:"inline-flex w-full justify-center gap-x-1.5 rounded-md px-3 py-2 text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-800 dark:text-gray-400 text-gray-700"},{default:u(()=>{var s,r;return[I(_(((s=x.value)==null?void 0:s.pluginName)||((r=n.value)==null?void 0:r.title)||"新对话"),1)]}),_:1})])])]),_:1})):(o(),h(l(V),{key:1,as:"div",class:"relative flex-1 flex ele-drag items-center h-full justify-between"},{default:u(()=>[a("div",null,[a("div",{class:C([[l(v)?"w-56":"w-60"],"py-1 flex items-center"])},[f(l(F),{class:C([[l(v)?"text-xs px-1 py-2":"text-sm px-3 py-2"],"inline-flex justify-center gap-x-1.5 rounded-md font-semibold hover:bg-gray-50 dark:hover:bg-gray-750 dark:text-gray-400 text-gray-500"]),onMouseover:e[0]||(e[0]=s=>b.value=!0),onMouseleave:e[1]||(e[1]=s=>b.value=!1)},{default:u(()=>{var s,r;return[I(_(((r=(s=p.value)==null?void 0:s.modelInfo)==null?void 0:r.modelName)||"新对话")+" ",1),b.value||l(v)?(o(),h(l(fe),{key:0,size:"20",class:C(["justify-center items-center",{"text-base font-bold":l(v),"text-sm":!l(v)}])},null,8,["class"])):g("",!0)]}),_:1},8,["class"]),k.value?(o(),d("div",{key:0,onClick:e[2]||(e[2]=s=>l(J)()),class:"ml-1 h-8 w-20 border border-[#c2d6f8] hover:border-[#bad2f8] hover:text-[#ffffff] text-xs text-[#0057ff] py-1.5 pl-2 pr-2.5 hover:bg-[#5a91fc] flex justify-between rounded-2xl"},[a("div",_e,[f(l(S),{icon:"icon-park-outline:plus",class:"w-4 h-4 mr-1"}),e[6]||(e[6]=a("span",{class:""}," 新对话 ",-1))]),e[7]||(e[7]=a("div",{class:"flex items-center"},null,-1))])):g("",!0)],2)]),f(Z,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:u(()=>[f(l(de),{class:"absolute top-full z-10 origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 dark:bg-gray-750 dark:text-gray-400 text-gray-900 overflow-y-auto",style:{maxHeight:"60vh"}},{default:u(()=>[a("div",ke,[(o(!0),d(ee,null,te(z.value,(s,r)=>(o(),h(l(ue),{key:r},{default:u(()=>[a("div",{class:"flex items-center space-x-4 mx-2 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-md select-none",onClick:w=>R(s)},[a("div",Ce,[s.modelAvatar?(o(),d("img",{key:0,src:s.modelAvatar,alt:"app cover",class:"w-full h-full object-cover"},null,8,Me)):(o(),d("span",ze,_(s.label.charAt(0)),1))]),a("div",Te,[a("a",je,_(s.label),1),s.modelDescription?(o(),d("div",Ae,_(s.modelDescription),1)):g("",!0)]),a("div",Ne,[L.value===s.value?(o(),h(l(me),{key:0,theme:"filled",size:"16",class:"dark:text-gray-500"})):(o(),d("div",Ie))])],8,be)]),_:2},1024))),128)),j.value?(o(),d("div",{key:0,onClick:q,class:"flex justify-between items-center space-x-4 mx-2 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-md select-none"},[e[8]||(e[8]=a("div",null,"模型更多",-1)),f(l(S),{icon:"icon-park-outline:right",class:"w-4 h-4 mr-2"})])):g("",!0)])]),_:1})]),_:1})]),_:1})),a("div",Se,[f(ce)]),g("",!0)])])])]))}});export{Qe as default};
