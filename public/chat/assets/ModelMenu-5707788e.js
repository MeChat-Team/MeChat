import{W as c,k as K,r as h,c as i,o as Q,U as C,V as u,z as X,R as r,a2 as e,a4 as m,K as n,l as Y,a9 as ee,S as d,a6 as x,a7 as te,F as se,A as le,a8 as f,aa as A,j as L,m as k}from"./vue-3af3b332.js";import{M as oe}from"./appStore-865d3c88.js";import{c as ae,d as re,u as ne,e as de,t as ie,j as P,m as ce}from"./index-64a301ad.js";import{t as ue,S as fe}from"./main-9659b9e9.js";import{T as pe}from"./TopBar-e33084af.js";import{u as me}from"./useBasicLayout-2b2b4d99.js";import{l as ge}from"./logo-63e5ee5a.js";import{e as he,f as xe,r as N,s as ke,t as I}from"./naive-ui-7701070e.js";import{I as ve}from"./index-3d816091.js";import{u as ye}from"./index-8fc91aff.js";import{_ as be}from"./_plugin-vue_export-helper-c27b6911.js";import"./vueuse-motion-b8c5571c.js";import"./relative.vue_vue_type_script_setup_true_lang-450ce482.js";import"./index.vue_vue_type_script_setup_true_lang-1ba99b02.js";import"./menu-9d7b0f63.js";const we=ve("transfer-data",!0,function(o){return c("svg",{width:o.size,height:o.size,viewBox:"0 0 48 48",fill:"none"},[c("path",{d:"M10 8L4 14L10 20",stroke:o.colors[0],"stroke-width":o.strokeWidth,"stroke-linecap":o.strokeLinecap,"stroke-linejoin":o.strokeLinejoin},null),c("path",{d:"M38 28L44 34L38 40",stroke:o.colors[0],"stroke-width":o.strokeWidth,"stroke-linecap":o.strokeLinecap,"stroke-linejoin":o.strokeLinejoin},null),c("path",{d:"M4 14H44",stroke:o.colors[0],"stroke-width":o.strokeWidth,"stroke-linecap":o.strokeLinecap,"stroke-linejoin":o.strokeLinejoin},null),c("path",{d:"M4 34H44",stroke:o.colors[0],"stroke-width":o.strokeWidth,"stroke-linecap":o.strokeLinecap,"stroke-linejoin":o.strokeLinejoin},null)])}),_e={class:"flex justify-center h-full flex-col items-center"},Me={class:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background"},Te={class:"pl-3 flex items-center pointer-events-none"},Ce=["placeholder"],Le={key:0,class:"h-1"},je=["onClick"],Ae={class:"flex-1"},Ne={class:"flex items-center"},Ie={key:0,class:"flex-shrink-0 mr-1.5 dark:ring-gray-400 rounded-full"},Fe=["src"],Se={class:"text-white text-sm"},Be={class:"flex-grow flex flex-col"},ze={class:"flex items-center my-1"},Ue={class:"font-medium text-base dark:text-gray-400 text-[#000000] pr-2 overflow-hidden text-ellipsis"},We={class:"bg-[#eeeeee] rounded-md flex items-center justify-center text-xs h-5 px-[7px] text-[#7A808A]"},De={key:2,class:"flex"},Ge={class:""},Pe={class:"text-sm text-[#595959] py-1 pl-1.5"},Re={class:"flex justify-end"},Ve={key:0,class:"flex flex-row text-sm items-center px-2 pr-1 py-1 w-full rounded-md border transition-all bg-secondary/5 hover:bg-secondary/10"},Ee={key:1,class:"flex flex-row text-sm items-center p-1 w-full rounded-md border transition-all bg-secondary/5 hover:bg-secondary/10"},He={key:0,class:"flex w-full h-full justify-between items-center"},Oe={class:"font-semibold"},qe={class:"px-2 h-full rounded-md flex items-center justify-center text-xs bg-[#e5ebf7] text-[#418ac6]"},Je={key:1,class:"flex w-full h-full justify-between items-center"},Ze={class:"font-semibold"},$e={class:"px-2 h-full rounded-md flex items-center justify-center text-xs bg-[#e5ebf7] text-[#418ac6]"},Ke={key:1,class:"h-6"},Qe=K({__name:"ModelMenu",props:{visible:{type:Boolean}},setup(o){const{isMobile:p}=me();ae(),he();const F=ye(),v=h("");i(()=>F.catId);const y=h([]),R=h([]);i(()=>F.mineApps),h([]),h(0);const b=i(()=>{var t;const a=(t=M.value)==null?void 0:t.config;if(!a)return{};try{return JSON.parse(a)}catch{return{}}});async function V(){const t=(await oe()).data.modelMaps;let s=[];for(let l in t)Array.isArray(t[l])&&(s=s.concat(t[l]));const g=s.filter(l=>l.keyType==1);y.value=g.map(l=>({label:l.modelName,value:l.model,maxModelTokens:l.maxModelTokens,deductType:l.deductType,keyType:l.keyType,isTokenBased:l.isTokenBased,deduct:l.deduct,tokenFeeRatio:l.tokenFeeRatio,isFileUpload:l.isFileUpload,modelAvatar:l.modelAvatar,modelDescription:l.modelDescription})),R.value=y.value.filter(l=>l.keyType==1)}const E=i(()=>{if(v.value){const a=v.value.toLowerCase();return y.value.filter(t=>ue.match(t.label,a))}return y.value});function H(){const a=["bg-blue-300","bg-red-300","bg-green-300","bg-yellow-300","bg-purple-300","bg-pink-300"];return a[Math.floor(Math.random()*a.length)]}h(null),i(()=>O.siderCollapsed);const O=re(),w=ne(),j=i(()=>w.globalConfig.clientLogoPath||ge),S=i(()=>w.globalConfig.drawMjName||"绘画积分"),B=i(()=>w.globalConfig.model3Name||"普通积分"),z=i(()=>w.globalConfig.model4Name||"高级积分");Q(()=>{V()});const _=de(),M=i(()=>_.getChatByGroupInfo()),q=i(()=>_.active),J=xe();async function Z(a){var W,D,G;if(a.label==((D=(W=b==null?void 0:b.value)==null?void 0:W.modelInfo)==null?void 0:D.modelName))return P.push("/chat");const{modelInfo:t,fileInfo:s}=_.activeConfig,{isGPTs:g,isFixedModel:l,modelName:U}=t,T={modelInfo:{keyType:a.keyType,modelName:((G=M==null?void 0:M.value)!=null&&G.appId?U:a.label)||"",model:a.value,deductType:a.deductType,deduct:a.deduct,isFileUpload:a.isFileUpload,modelAvatar:a.modelAvatar||"",isGPTs:g,isFixedModel:l},fileInfo:s||{}},$={groupId:q.value,config:JSON.stringify(T)};await ce($),await _.queryMyGroup(),P.push("/chat"),J.info({content:"切换模型",meta:()=>k("div",{class:"flex items-center justify-center "},[k(we,{size:"16",fill:"#7b7b83"}),k("span",{style:"font-size: 14px;",class:"px-1 "},"已经切换至模型"),k(I,{size:20,round:!0,src:T.modelInfo.modelAvatar?T.modelInfo.modelAvatar:j.value}),k("span",{style:" font-size: 14px;",class:"px-1 "},T.modelInfo.modelName)]),duration:2500,keepAliveOnHover:!0})}return(a,t)=>(r(),C(X,{name:"modal-fade"},{default:u(()=>[e("div",_e,[c(pe,{class:"px-4"}),e("div",{class:m(["bg-white dark:bg-gray-900 flex flex-1 flex-col",[n(p)?"w-full h9full   ":" w-full h-full  rounded-lg"]])},[e("div",{class:m([[n(p)?"w-full   ":"pb-2.5 "],"flex flex-1 flex-col"])},[e("div",{class:m([[n(p)?" px-3  ":" px-7 mb-2.5"],"flex h-10 w-full"])},[e("div",Me,[e("div",Te,[c(n(fe),{theme:"outline",size:"18",class:"text-[#18181b]"})]),Y(e("input",{id:"search-field","onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),class:"z-1 w-full rounded-xl dark:bg-gray-800 font-normal outline-0 delay-100 text-base pl-2 pr-9 dark:text-gray-400",placeholder:n(ie)("app.searchAppModelQuickFind"),type:"search",name:"search"},null,8,Ce),[[ee,v.value]])])],2),e("div",{class:m([[n(p)?" px-3  ":"px-7 "],"w-full flex flex-1 overflow-y-auto flex-grow items-start"])},[c(le,{name:"list",tag:"div",class:m(["w-full grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-3 grid gap-2.5",[n(p)?"  max-h-[85vh]":"h-[60vh] grid-cols-2   "]]),style:{"align-content":"start"}},{default:u(()=>[n(p)?(r(),d("div",Le)):x("",!0),(r(!0),d(se,null,te(E.value,s=>{var g,l;return r(),d("div",{key:s.id,onClick:U=>Z(s),class:m([s.label==((l=(g=b.value)==null?void 0:g.modelInfo)==null?void 0:l.modelName)?"border-2 border-[#595959]":"border border-[#d6d6db] hover:border-[#c9c9cf]","rounded-xl flex flex-col px-3 py-3 dark:bg-[gray-800] hover:bg-[#fafafa] dark:hover:bg-gray-700"])},[e("div",Ae,[e("div",Ne,[s.modelAvatar?(r(),d("div",Ie,[e("img",{src:s.modelAvatar,class:"rounded-full w-6 h-6",alt:"app-image"},null,8,Fe)])):(r(),d("div",{key:1,class:m(["mr-1.5",[H(),"flex-shrink-0  dark:ring-gray-400 rounded-full w-6 h-6 flex items-center justify-center"]])},[e("span",Se,f(s.label.slice(0,2)),1)],2)),e("div",Be,[e("div",ze,[e("span",Ue,f(s.label),1),e("span",We,f(s.maxModelTokens*1/1024)+"k ",1)])]),s.isFileUpload!==0?(r(),d("div",De,[s.isFileUpload==2?(r(),C(n(N),{key:0,trigger:"click","show-arrow":!1},{trigger:u(()=>[(r(),d("svg",{onClick:t[1]||(t[1]=A(()=>{},["stop"])),xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-eye w-5 h-5 p-1 rounded-md ml-1 text-blue-600 bg-blue-500/20"},t[4]||(t[4]=[e("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)])))]),default:u(()=>[t[5]||(t[5]=L(" 支持视觉模型 "))]),_:1})):x("",!0),s.isFileUpload==1?(r(),C(n(N),{key:1,trigger:"click","show-arrow":!1},{trigger:u(()=>[(r(),d("svg",{onClick:t[2]||(t[2]=A(()=>{},["stop"])),xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-globe w-5 h-5 p-1 rounded-md ml-1 text-green-600 bg-green-500/20"},t[6]||(t[6]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"},null,-1),e("path",{d:"M2 12h20"},null,-1)])))]),default:u(()=>[t[7]||(t[7]=L(" 联网搜索 "))]),_:1})):x("",!0),s.isFileUpload==3?(r(),C(n(N),{key:2,trigger:"click","show-arrow":!1},{trigger:u(()=>[(r(),d("svg",{onClick:t[3]||(t[3]=A(()=>{},["stop"])),xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-sparkles w-5 h-5 p-1 rounded-md ml-1 text-purple-600 bg-purple-500/20"},t[8]||(t[8]=[e("path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"},null,-1),e("path",{d:"M5 3v4"},null,-1),e("path",{d:"M19 17v4"},null,-1),e("path",{d:"M3 5h4"},null,-1),e("path",{d:"M17 19h4"},null,-1)])))]),default:u(()=>[t[9]||(t[9]=L(" 支持任意文件 "))]),_:1})):x("",!0)])):x("",!0)]),e("div",Ge,[e("div",Pe,[c(n(ke),{"line-clamp":8},{default:u(()=>[L(f(s.modelDescription),1)]),_:2},1024)])])]),e("div",Re,[s.deduct==0?(r(),d("div",Ve,t[10]||(t[10]=[e("span",{class:"flex-grow"},"免费",-1),e("span",{class:"text-2xs ml-1 px-1.5 bg-input/40 select-none rounded-md"},"FREE",-1)]))):(r(),d("div",Ee,[s.isTokenBased?(r(),d("div",He,[e("div",null,[c(n(I),{style:{backgroundColor:"#e5ebf7"},class:"p-1 bg-[#ffffff] mr-2",round:"",size:20,src:j.value},null,8,["src"]),e("span",Oe,f(s.deduct),1)]),e("div",qe,f(s.deductType==1?B.value:s.deductType==2?z.value:S.value)+" / "+f(s.tokenFeeRatio)+" Tokens ",1)])):(r(),d("div",Je,[e("div",null,[c(n(I),{style:{backgroundColor:"#e5ebf7"},class:"p-1 bg-[#ffffff] mr-2",round:"",size:20,src:j.value},null,8,["src"]),e("span",Ze,f(s.deduct),1)]),e("div",$e,f(s.deductType==1?B.value:s.deductType==2?z.value:S.value)+" / 次 ",1)]))]))])],10,je)}),128)),n(p)?(r(),d("div",Ke)):x("",!0)]),_:1},8,["class"])],2)],2)],2)])]),_:1}))}});const pt=be(Qe,[["__scopeId","data-v-2e06b6c6"]]);export{pt as default};
