import{W as o,k as se,r as k,c as s,w as j,o as ae,R as f,S as z,a2 as r,V as c,K as l,j as g,U as B,a6 as h,a3 as v,a4 as S,z as le}from"./vue-24971718.js";import{I as w,l as re,_ as ce,S as ue,M as de,d as y,g as ke}from"./menu-70a3c7ae.js";import{u as fe,k as ge,e as he,j as me,a as ve,t as u}from"./index-160165ed.js";import{u as ye}from"./useBasicLayout-259ce701.js";import{d as we,x as xe}from"./naive-ui-0755ea39.js";const be=w("calendar",!1,function(e){return o("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[o("path",{d:"M5 19H43V40C43 41.1046 42.1046 42 41 42H7C5.89543 42 5 41.1046 5 40V19Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M5 9C5 7.89543 5.89543 7 7 7H41C42.1046 7 43 7.89543 43 9V19H5V9Z",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M16 4V12",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M32 4V12",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M28 34H34",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M14 34H20",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M28 26H34",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M14 26H20",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),je=w("commodity",!1,function(e){return o("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[o("path",{d:"M9.78101 9.75193C9.90612 8.75107 10.7569 8 11.7656 8H36.2344C37.2431 8 38.0939 8.75107 38.219 9.75193L41.719 37.7519C41.8682 38.9456 40.9374 40 39.7344 40H8.26556C7.06257 40 6.1318 38.9456 6.28101 37.7519L9.78101 9.75193Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M15 18C15 18 17 22 24 22C31 22 33 18 33 18",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Le=w("delete-themes",!0,function(e){return o("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[o("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 15H40L37 44H11L8 15Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M20.002 25.0024V35.0026",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap},null),o("path",{d:"M28.0024 24.9995V34.9972",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap},null),o("path",{d:"M12 14.9999L28.3242 3L36 15",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Ce=w("logout",!0,function(e){return o("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[o("path",{d:"M23.9917 6H6V42H24",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M33 33L42 24L33 15",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M16 23.9917H42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),D=w("user",!1,function(e){return o("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[o("circle",{cx:"24",cy:"12",r:"8",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),o("path",{d:"M42 44C42 34.0589 33.9411 26 24 26C14.0589 26 6 34.0589 6 44",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Me={class:"h-11 px-1 flex flex items-center"},Te={class:"h-full flex items-center"},Ne={class:"w-[26px] h-[26px] rounded-full bg-primary-600 flex items-center justify-center overflow-hidden shadow-sm border border-gray-300"},We=["src"],ze={class:"py-1"},_e=se({__name:"relative",setup(e){var V;const L=fe(),C=ge(),x=he(),d=me(),a=ve(),I=k(null),_=k(null),P=k(null),U=s(()=>{var i;return Number((i=a.globalConfig)==null?void 0:i.signInStatus)===1}),A=s(()=>x.theme==="dark"),M=s(()=>a.userBalance),T=s(()=>d.currentPlugin),G=we(),O=k(0),R=k(0),$=k(0),Z=k(0),q=k(0),F=k(0),{isMobile:N}=ye(),b=s(()=>a.isLogin);s(()=>a.globalConfig.clientLogoPath||re),s(()=>a.globalConfig.clientHomePath||"/"),(V=a.globalConfig)!=null&&V.siteName;const p=s(()=>a.globalConfig.model3Name||u("chat.ordinaryPoints")),E=s(()=>a.globalConfig.model4Name)||u("chat.advancedPoints"),J=s(()=>a.globalConfig.drawMjName)||u("chat.drawingPoints");s(()=>Number(a.globalConfig.pluginFirst)===1),s(()=>Number(a.globalConfig.isHidePlugin)===1);const W=s(()=>a.userInfo.avatar);s(()=>x.siderCollapsed),k("chat");const H=s(()=>a.globalConfig);s(()=>{var i,t;return((i=H.value)==null?void 0:i.companyName)&&((t=H.value)==null?void 0:t.filingNumber)});const K=s(()=>d.groupList.find(t=>t.uuid===d.active)),Q=s(()=>{var i;try{return JSON.parse(((i=K.value)==null?void 0:i.config)||"{}")}catch{return{}}}),X=s(()=>d==null?void 0:d.activeModelDeductType);s(()=>{var m;const i=((m=T==null?void 0:T.value)==null?void 0:m.deductType)||Q.value.deductType||X.value;let t,n;switch(i){case 1:t=M.value.sumModel3Count||0,n=p.value;break;case 2:t=M.value.sumModel4Count||0,n=E.value;break;case 3:t=M.value.sumDrawMjCount||0,n=J.value;break;default:t=0,n=u("chat.points")}return t>99999&&(t="不限",n="次数"),{remainingPoints:t,buttonText:n}});async function Y(){await ee(),C.replace({path:"user-center"})}async function ee(){return new Promise(i=>{setTimeout(()=>{a.isLogin||C.replace({path:"login"}),i()},100)})}function Be(){const i=A.value?"light":"dark";x.setTheme(i)}async function te(){G.warning({title:u("chat.clearConversation"),content:u("chat.clearAllNonFavoriteConversations"),positiveText:u("common.confirm"),negativeText:u("common.cancel"),onPositiveClick:async()=>{await d.delAllGroup(),await d.addNewChatGroup()}})}function oe(){b.value?a.logOut():a.setLoginDialog(!0)}function ne(){if(!b.value){a.setLoginDialog(!0);return}L.updateSignInDialog(!0)}function ie(){a.logOut(),C.replace("/")}return s(()=>N.value?{position:"fixed",zIndex:50}:{}),s(()=>N.value?{paddingBottom:"env(safe-area-inset-bottom)"}:{}),j(N,i=>{x.setSiderCollapsed(i)},{immediate:!0,flush:"post"}),j(()=>a.userBalance.useModel3Token,(i,t)=>{var n;O.value=t||0,R.value=i||0,(n=I.value)==null||n.play()},{immediate:!0,flush:"post"}),j(()=>a.userBalance.useModel4Token,(i,t)=>{var n;$.value=t||0,Z.value=i||0,(n=_.value)==null||n.play()},{immediate:!0,flush:"post"}),j(()=>a.userBalance.useDrawMjToken,(i,t)=>{var n;q.value=t||0,F.value=i||0,(n=P.value)==null||n.play()},{immediate:!0,flush:"post"}),ae(()=>{d.queryPlugins(),d.queryMyGroup()}),(i,t)=>(f(),z("div",Me,[r("div",{class:"w-8 h-8 mr-2 rounded-xl hover:bg-[#f0f0f0] flex items-center justify-center",onClick:t[0]||(t[0]=n=>l(L).updateNoticeDialog(!0))},[o(l(xe),{trigger:"hover"},{trigger:c(()=>[o(l(ce),{icon:"tabler:bell",class:"text-[22px]"})]),default:c(()=>[t[4]||(t[4]=g(" 网站公告 "))]),_:1})]),b.value?(f(),B(l(ke),{key:0,as:"div",class:"relative inline-block text-left"},{default:c(()=>[r("div",Te,[o(l(ue),{class:"inline-flex h-full w-full justify-center items-center gap-x-1.5 rounded-md pr-3 text-sm font-semibold dark:text-gray-400 text-gray-700"},{default:c(()=>[r("div",Ne,[W.value?(f(),z("img",{key:0,src:W.value,class:"w-full h-full object-cover"},null,8,We)):h("",!0),W.value?h("",!0):(f(),B(l(D),{key:1,theme:"outline",size:"20",class:"text-white"}))])]),_:1})]),o(le,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:c(()=>[o(l(de),{class:"absolute w-[228px] right-0 mb-2 p-1 origin-bottom-right divide-y divide-gray-100 rounded-2xl bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none dark:bg-gray-800 dark:text-gray-400 text-gray-900 z-50"},{default:c(()=>[r("div",ze,[o(l(y),{class:"rounded-2xl"},{default:c(({active:n})=>[r("a",{href:"#",class:v([[n?"bg-gray-100  dark:bg-gray-700":"","group flex items-center justify-start px-2 py-2 text-sm whitespace-nowrap"],"dark:border-b-gray-800"]),onClick:te},[o(l(Le),{theme:"outline",size:"16",class:"mr-2"}),g(" "+S(l(u)("chat.clear")),1)],2)]),_:1}),t[7]||(t[7]=r("div",{class:"px-2"},[r("div",{class:"border-b border-b-gray-100"})],-1)),o(l(y),{class:"rounded-2xl"},{default:c(({active:n})=>[r("a",{href:"#",class:v([n?"bg-gray-100  dark:bg-gray-700":"","group flex items-center justify-start px-2 py-2 text-sm whitespace-nowrap"]),onClick:t[1]||(t[1]=m=>l(L).updateGoodsDialog(!0))},[o(l(je),{theme:"outline",size:"16",class:"mr-2"}),g(" "+S(l(u)("chat.pointsMall")),1)],2)]),_:1}),h("",!0),U.value?(f(),B(l(y),{key:1,class:"rounded-2xl"},{default:c(({active:n})=>[r("a",{href:"#",class:v([n?"bg-gray-100  dark:bg-gray-700":"","group flex items-center justify-start px-2 py-2 text-sm whitespace-nowrap"]),onClick:ne},[o(l(be),{theme:"outline",size:"16",class:"mr-2"}),g(" "+S(l(u)("chat.signInReward")),1)],2)]),_:1})):h("",!0),o(l(y),{class:"rounded-2xl"},{default:c(({active:n})=>[r("a",{href:"#",class:v([n?"bg-gray-100  dark:bg-gray-700":"","group flex items-center justify-start px-2 py-2 text-sm whitespace-nowrap"]),onClick:t[2]||(t[2]=m=>Y())},[o(l(D),{theme:"outline",size:"16",class:"mr-2"}),t[5]||(t[5]=g(" 个人中心 "))],2)]),_:1}),t[8]||(t[8]=r("div",{class:"px-2"},[r("div",{class:"border-t border-t-gray-100"})],-1)),o(l(y),{class:"rounded-2xl dark:border-t-gray-800"},{default:c(({active:n})=>[r("a",{href:"#",class:v([n?"bg-gray-100  dark:bg-gray-700":"","group flex items-center justify-start px-2 py-2 text-sm whitespace-nowrap"]),onClick:t[3]||(t[3]=m=>ie())},[o(l(Ce),{theme:"outline",size:"16",class:"mr-2"}),t[6]||(t[6]=g(" 退出登录 "))],2)]),_:1})])]),_:1})]),_:1})]),_:1})):h("",!0),b.value?h("",!0):(f(),z("div",{key:1,onClick:oe,class:"flex items-center justify-center cursor-pointer"},t[9]||(t[9]=[r("button",{type:"button",class:"inline-flex h-9 justify-center rounded-xl items-center bg-[#232629] px-5 py-2.5 text-[#ffffff] w-full"},[r("span",null,"登录")],-1)])))]))}});export{_e as _};
