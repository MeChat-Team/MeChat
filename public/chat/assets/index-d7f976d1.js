import{W as C,r as _,c as s,k as J,i as ce,o as fe,w as O,m as ve,F as Z,R as n,S as h,a2 as e,af as Le,U as D,K as o,a6 as w,V as T,j as ue,a8 as I,a7 as pe,l as xe,a9 as Te,a4 as K,z as De,aa as je,H as ye,v as ze}from"./vue-3af3b332.js";import{l as Ae}from"./logo-63e5ee5a.js";import{a as be,e as ae,t as M,b as we,d as _e,u as Ce,c as Se}from"./index-64a301ad.js";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang-1ba99b02.js";import{u as Ne}from"./useBasicLayout-2b2b4d99.js";import{v as de,e as Pe,K as Ge,d as Ee,p as Oe,L as Ue}from"./naive-ui-7701070e.js";import{A as Be,i as Ke,s as He,o as We,E as Fe,T as qe,a as ke,S as Re,M as Ze,b as re,g as Je}from"./menu-9d7b0f63.js";import{I as Qe}from"./index-3d816091.js";import{u as Xe}from"./index-8fc91aff.js";import"./vueuse-motion-b8c5571c.js";import"./appStore-865d3c88.js";const Ye=Qe("application-two",!1,function(t){return C("svg",{width:t.size,height:t.size,viewBox:"0 0 48 48",fill:"none"},[C("circle",{cx:"34.5",cy:"13.5",r:"6.5",fill:t.colors[1],stroke:t.colors[0],"stroke-width":t.strokeWidth},null),C("circle",{cx:"34.5",cy:"34.5",r:"6.5",fill:t.colors[1],stroke:t.colors[0],"stroke-width":t.strokeWidth},null),C("circle",{cx:"13.5",cy:"13.5",r:"6.5",fill:t.colors[1],stroke:t.colors[0],"stroke-width":t.strokeWidth},null),C("circle",{cx:"13.5",cy:"34.5",r:"6.5",fill:t.colors[1],stroke:t.colors[0],"stroke-width":t.strokeWidth},null)])});function et(t,u,f){let i=_(f==null?void 0:f.value),l=s(()=>t.value!==void 0);return[s(()=>l.value?t.value:i.value),function(r){return l.value||(i.value=r),u==null?void 0:u(r)}]}var $e=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))($e||{});let tt=J({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup(t,{slots:u,attrs:f}){return()=>{var i;let{features:l,...r}=t,A={"aria-hidden":(l&2)===2?!0:(i=r["aria-hidden"])!=null?i:void 0,hidden:(l&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(l&4)===4&&(l&2)!==2&&{display:"none"}}};return Be({ourProps:A,theirProps:r,slot:{},attrs:f,slots:u,name:"Hidden"})}}});function at(t){var u,f;let i=(u=t==null?void 0:t.form)!=null?u:t.closest("form");if(i){for(let l of i.elements)if(l!==t&&(l.tagName==="INPUT"&&l.type==="submit"||l.tagName==="BUTTON"&&l.type==="submit"||l.nodeName==="INPUT"&&l.type==="image")){l.click();return}(f=i.requestSubmit)==null||f.call(i)}}let ot=Symbol("GroupContext"),lt=J({name:"Switch",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"button"},modelValue:{type:Boolean,default:void 0},defaultChecked:{type:Boolean,optional:!0},form:{type:String,optional:!0},name:{type:String,optional:!0},value:{type:String,optional:!0},id:{type:String,default:null},disabled:{type:Boolean,default:!1},tabIndex:{type:Number,default:0}},inheritAttrs:!1,setup(t,{emit:u,attrs:f,slots:i,expose:l}){var r;let A=(r=t.id)!=null?r:`headlessui-switch-${Ke()}`,$=ce(ot,null),[b,N]=et(s(()=>t.modelValue),d=>u("update:modelValue",d),s(()=>t.defaultChecked));function j(){N(!b.value)}let y=_(null),S=$===null?y:$.switchRef,G=He(s(()=>({as:t.as,type:f.type})),S);l({el:S,$el:S});function U(d){d.preventDefault(),j()}function E(d){d.key===ke.Space?(d.preventDefault(),j()):d.key===ke.Enter&&at(d.currentTarget)}function g(d){d.preventDefault()}let c=s(()=>{var d,z;return(z=(d=We(S))==null?void 0:d.closest)==null?void 0:z.call(d,"form")});return fe(()=>{O([c],()=>{if(!c.value||t.defaultChecked===void 0)return;function d(){N(t.defaultChecked)}return c.value.addEventListener("reset",d),()=>{var z;(z=c.value)==null||z.removeEventListener("reset",d)}},{immediate:!0})}),()=>{let{name:d,value:z,form:m,tabIndex:x,...L}=t,W={checked:b.value},q={id:A,ref:S,role:"switch",type:G.value,tabIndex:x===-1?0:x,"aria-checked":b.value,"aria-labelledby":$==null?void 0:$.labelledby.value,"aria-describedby":$==null?void 0:$.describedby.value,onClick:U,onKeyup:E,onKeypress:g};return ve(Z,[d!=null&&b.value!=null?ve(tt,Fe({features:$e.Hidden,as:"input",type:"checkbox",hidden:!0,readOnly:!0,checked:b.value,form:m,disabled:L.disabled,name:d,value:z})):null,Be({ourProps:q,theirProps:{...f,...qe(L,["modelValue","defaultChecked"])},slot:W,attrs:f,slots:i,name:"Switch"})])}}});function st(t,u){let f;return(...i)=>{const l=()=>{clearTimeout(f),t(...i)};clearTimeout(f),f=setTimeout(l,u)}}function nt(t,u){return n(),h("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})])}function rt(t,u){return n(),h("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})])}const it={class:"flex items-center"},ct={class:"ml-1"},ut={class:"flex items-center text-[#c2c3c5]"},dt={key:0,class:"pb-4 pl-5"},ft=["onClick"],pt={class:"flex items-center"},gt=["onUpdate:modelValue","onKeypress"],mt={key:1,class:"flex-1 text-[13px] truncate max-w-48"},ht={key:0,class:"absolute z-10 right-2"},vt={class:"py-1"},yt=["onClick"],kt=["onClick"],xt=["onClick"],ie=J({__name:"ListItem",props:{dataSources:{},title:{},stype:{},isIntelligent:{type:Boolean}},emits:["update","delete","sticky","select"],setup(t,{emit:u}){const f=be(),i=t,l=u,r=i.dataSources,A=ae();async function $(g){l("select",g)}function b(g,c,d){d==null||d.stopPropagation(),g.isEdit=c}async function N(g,c){c==null||c.stopPropagation(),await A.updateGroupInfo({isSticky:!g.isSticky,groupId:g.uuid})}async function j(g,c){c==null||c.stopPropagation(),l("delete",g)}const y=st(j,600);async function S(g){const{uuid:c,title:d}=g;g.isEdit=!1,await A.updateGroupInfo({groupId:c,title:d})}async function G(g,c){c==null||c.stopPropagation(),c.key==="Enter"&&S(g)}function U(g){return f.path==="/discover"?!1:A.active===g}function E(){l("subassembly")}return(g,c)=>{var z;const d=Le("focus");return n(),h(Z,null,[e("div",{onClick:E,class:"mt-0.5 p-2 hover:bg-[#e9eaec] mt-1.5 flex justify-between rounded-xl"},[e("div",it,[i.stype==1?(n(),D(o(H),{key:0,icon:"icon-park-outline:message-unread",class:"w-4 h-4 mr-2"})):w("",!0),i.stype==2?(n(),D(o(H),{key:1,icon:"icon-park-outline:text-message",class:"w-4 h-4 mr-2"})):w("",!0),i.stype==3?(n(),D(o(de),{key:2,size:16,class:"mr-2"},{default:T(()=>c[0]||(c[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor","fill-rule":"evenodd",d:"M18.498 9.197a.514.514 0 0 0 .512-.454c.24-1.433.452-2.168.907-2.625.454-.455 1.186-.666 2.612-.906.26-.031.467-.24.467-.513a.513.513 0 0 0-.47-.513c-1.423-.242-2.155-.454-2.61-.91-.454-.455-.666-1.19-.906-2.621a.514.514 0 0 0-.512-.458.52.52 0 0 0-.515.456c-.24 1.432-.452 2.168-.907 2.624-.454.455-1.185.667-2.607.909a.514.514 0 0 0-.473.513.52.52 0 0 0 .47.512c1.425.24 2.157.447 2.61.9.455.454.666 1.19.907 2.634a.52.52 0 0 0 .515.452m1.594 10.19V11.03a6.5 6.5 0 0 1-2 .155v8.202L13.72 15.19a2 2 0 0 0-2.77 0L6.092 19.85V4.197h6.02c.054-.704.22-1.377.481-2h-6.5a2 2 0 0 0-2 2V19.85c0 1.762 2.113 2.663 3.384 1.442l4.857-4.661 4.373 4.198c1.271 1.22 3.385.32 3.385-1.443","clip-rule":"evenodd"})],-1)])),_:1})):w("",!0),e("div",null,[ue(I(i.title)+" ",1),e("span",ct,"("+I((z=o(r))==null?void 0:z.length)+")",1)])]),e("div",ut,[g.isIntelligent?(n(),D(o(H),{key:0,icon:"icon-park-outline:down",class:"w-4 h-4 mr-2"})):(n(),D(o(H),{key:1,icon:"icon-park-outline:right",class:"w-4 h-4 mr-2"}))])]),g.isIntelligent?(n(),h("div",dt,[(n(!0),h(Z,null,pe(o(r),m=>(n(),h("div",{key:`${m.uuid}`},[e("div",{class:K(["relative flex items-center mt-1.5 gap-3 px-3 py-2 break-all rounded-xl cursor-pointer hover:bg-[#e9eaec] group dark:hover:bg-gray-800 font-medium text-sm",U(m.uuid)?["111111111111","bg-[#ffffff]","font-semibold","text-[#000000D9]","dark:bg-gray-800","dark:text-white"]:["text-[#00000080]","11222222222111","dark:bg-gray-900","dark:text-gray-400"]]),onClick:x=>$(m)},[e("div",pt,[m.isEdit?xe((n(),h("input",{key:0,"onUpdate:modelValue":x=>m.title=x,type:"text",class:"bg-transparent border border-gray-200 dark:border-gray-400 px-1 shadow-none flex-1 truncate",onKeypress:x=>G(m,x)},null,40,gt)),[[Te,m.title],[d]]):(n(),h("span",mt,I(m.title),1)),m.isEdit?(n(),D(o(nt),{key:2,class:"h-5 w-5 ml-2","aria-hidden":"true",onClick:x=>S(m)},null,8,["onClick"])):w("",!0)]),U(m.uuid)?(n(),h("div",ht,[m.isEdit?w("",!0):(n(),D(o(Je),{key:0,as:"div",class:"relative inline-block text-left"},{default:T(()=>[C(o(Re),{class:"p-1"},{default:T(()=>[C(o(rt),{class:K([U(m.uuid)?["font-semibold","text-[#000000D9]"]:[],"h-5 w-5"]),"aria-hidden":"true"},null,8,["class"])]),_:2},1024),C(De,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:T(()=>[C(o(Ze),{class:"absolute right-0 z-10 mt-1.5 w-32 text-gray-700 dark:text-gray-400 origin-top-right text-b rounded-xl bg-[#e9eaec] shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none bg-primary-100 dark:bg-gray-800"},{default:T(()=>[e("div",vt,[C(o(re),{as:"template"},{default:T(({active:x})=>[e("button",{class:K([x?"flex items-center bg-gray-100 dark:bg-gray-700 ":"flex items-center ","block w-full px-4 py-2 text-left text-sm"]),onClick:L=>b(m,!0,L)},I(o(M)("chat.rename")),11,yt)]),_:2},1024),C(o(re),{as:"template"},{default:T(({active:x})=>[e("button",{class:K([x?"flex items-end mr-3 bg-gray-100 dark:bg-gray-700":"flex items-end ","block w-full px-4 py-2 text-left text-sm"]),onClick:L=>N(m,L)},I(m.isSticky?o(M)("chat.unfavorite"):o(M)("chat.favoriteConversations")),11,kt)]),_:2},1024),C(o(re),{as:"template"},{default:T(({active:x})=>[e("button",{class:K([x?"flex items-center bg-gray-100 dark:bg-gray-700":"flex items-center ","block w-full px-4 py-2 text-left text-sm"]),onClick:L=>o(y)(m,L)},I(o(M)("chat.deleteConversation")),11,xt)]),_:2},1024)])]),_:2},1024)]),_:2},1024)]),_:2},1024))])):w("",!0)],10,ft)]))),128))])):w("",!0)],64)}}}),bt={class:"flex flex-col text-sm"},wt={key:0,class:"flex flex-col items-center mt-4 items-center text-neutral-300"},_t={class:"flex items-center"},Ct={class:"flex items-center"},St={class:"flex text-[#c2c3c5] items-center"},Nt={key:4,class:"text-[#00000080] text-[13px]"},Bt=["onClick"],$t={class:"w-5 h-5 rounded-full mr-2 bg-gray-200 flex items-center justify-center overflow-hidden"},Vt=["src"],Mt={key:1,class:"text-sm font-medium"};const It=J({__name:"List",setup(t){const u=_(!1),f=_(!1),i=_(!1),{isMobile:l}=Ne(),r=we(),A=be(),$=_e(),b=ae(),N=Ce(),j=Pe(),y=_(100),S=Xe(),G=_(!1),U=_(!1),E=_(!1),g=s(()=>b.groupList),c=s(()=>b.groupKeyWord);O(g,()=>y.value=y.value+1),O(c,()=>y.value=y.value+1);const d=s(()=>b.isStreamIn!==void 0?b.isStreamIn:!1);s(()=>N.isLogin);const z=ce("createNewChatGroup",async a=>{}),m=s(()=>S.mineApps);function x(a){const B=new Date(a).getTime()+8*60*60*1e3;return new Date(B).getTime()}const L=new Date().setHours(0,0,0,0),W=s(()=>g.value.filter(a=>c.value?a.title.includes(c.value)&&a.isSticky&&!a.params:a.isSticky&&!a.params)),q=s(()=>g.value.filter(a=>c.value?a.title.includes(c.value)&&!a.isSticky&&x(a.updatedAt)>=L&&!a.params:!a.isSticky&&x(a.updatedAt)>=L&&!a.params)),ee=s(()=>g.value.filter(a=>c.value?a.title.includes(c.value)&&!a.isSticky&&x(a.updatedAt)<L&&!a.params:!a.isSticky&&x(a.updatedAt)<L&&!a.params));async function Q(a){if(d.value){j.info("AI回复中，请稍后再试");return}const{uuid:v}=a;te(v)||(await b.setActiveGroup(v),A.name!=="Chat"&&r.replace("/chat"),l.value&&$.setSiderCollapsed(!0))}const oe=_(0);async function ge(a){oe.value=a,S.queryMineApps(),z(a)}async function F(a){event==null||event.stopPropagation(),await b.deleteGroup(a),await b.queryMyGroup(),l.value&&$.setSiderCollapsed(!0)}Se();function te(a){return b.active===a}async function R(){await b.setGroup(),l.value&&$.setSiderCollapsed(!0),r.push("/discover")}s(()=>[u.value,f.value,i.value].filter(a=>a).length);const X=a=>{a==="istoday"?u.value=!u.value:a==="isbefore"?f.value=!f.value:a==="iscollect"&&(i.value=!i.value)},le=ce("createNewChatGroup",()=>Promise.resolve());return O(()=>N.isLogin,(a,v)=>{a===!0&&(S.queryMineApps(),b.queryMyGroup())},{immediate:!0}),(a,v)=>(n(),D(o(Ge),{class:"px-4"},{default:T(()=>[e("div",bt,[g.value.length?(n(),h(Z,{key:1},[e("div",{onClick:v[0]||(v[0]=B=>o(le)()),class:"mt-4 border cursor-pointer border-[#c2d6f8] hover:border-[#bad2f8] font-semibold mb-1 h-10 bg-[#e5ebf7] text-[#0057ff] p-2 hover:bg-[#dae4f7] flex justify-between rounded-xl"},[e("div",_t,[C(o(H),{icon:"icon-park-outline:plus",class:"w-4 h-4 mr-2"}),v[7]||(v[7]=e("span",{class:""}," 新对话 ",-1))]),v[8]||(v[8]=e("div",{class:"flex items-center"},null,-1))]),v[9]||(v[9]=e("div",{class:"w-full h-[0.5px] bg-[#d5d6d8] my-2"},null,-1)),w("",!0),w("",!0),q.value.length?(n(),D(ie,{key:3e3+y.value,title:o(M)("chat.todayConversations"),"data-sources":q.value,stype:1,onSelect:Q,onDelete:F,isIntelligent:u.value,onSubassembly:v[3]||(v[3]=B=>X("istoday"))},null,8,["title","data-sources","isIntelligent"])):w("",!0),ee.value.length?(n(),D(ie,{stype:2,key:4e3+y.value,title:o(M)("chat.historyConversations"),"data-sources":ee.value,onSelect:Q,onDelete:F,onSubassembly:v[4]||(v[4]=B=>X("isbefore")),isIntelligent:f.value},null,8,["title","data-sources","isIntelligent"])):w("",!0),v[10]||(v[10]=e("div",{class:"w-full h-[0.5px] bg-[#d5d6d8] my-2"},null,-1)),e("div",{onClick:v[5]||(v[5]=B=>E.value=!E.value),class:"mt-1.5 p-2 hover:bg-[#e9eaec] flex justify-between rounded-xl"},[e("div",Ct,[C(o(H),{icon:"mingcute:ai-fill",class:"w-4 h-4 mr-2"}),e("div",null,I(o(M)("chat.myApps")),1)]),e("div",St,[E.value?(n(),D(o(H),{key:0,icon:"icon-park-outline:down",class:"w-4 h-4 mr-2"})):(n(),D(o(H),{key:1,icon:"icon-park-outline:right",class:"w-4 h-4 mr-2"}))])]),E.value?(n(),h("div",Nt,[e("div",{onClick:R,class:"mt-1.5 p-2 hover:bg-[#e9eaec] flex items-center rounded-xl"},[C(o(Ye),{class:"bg-[#f5f5f5] mr-2",theme:"outline",size:"20"}),e("div",null,I(o(M)("chat.appSquare")),1)]),(n(!0),h(Z,null,pe(U.value?m.value:m.value.slice(0,4),B=>(n(),h("div",{key:B.appId,onClick:me=>ge(B.appId),class:K([oe.value==B.appId?["bg-[#ffffff]","font-semibold","text-[#000000D9]","dark:bg-gray-800","dark:text-white"]:["text-[#00000080] "],"relative text-[13px] flex items-center break-all rounded-xl cursor-pointer hover:bg-[#e9eaec] group dark:hover:bg-gray-800 font-medium 'text-gray-700', 'dark:bg-gray-900', 'dark:text-gray-400' mt-0.5 p-2"])},[e("div",$t,[B.coverImg?(n(),h("img",{key:0,src:B.coverImg,alt:"app cover",class:"w-5 h-5 object-cover"},null,8,Vt)):(n(),h("span",Mt,I(B.appName.charAt(0)),1))]),e("button",null,I(B.appName),1)],10,Bt))),128))])):w("",!0),W.value.length?(n(),D(ie,{stype:3,isIntelligent:i.value,onSubassembly:v[6]||(v[6]=B=>X("iscollect")),key:`stickyList-${G.value}-${W.value}`,title:o(M)("chat.favorites"),"data-sources":G.value?W.value:W.value.slice(0,5),onSelect:Q,onDelete:F},null,8,["isIntelligent","title","data-sources"])):w("",!0),w("",!0)],64)):(n(),h("div",wt,[C(o(H),{icon:"ri:inbox-line",class:"mb-2 text-3xl"}),e("span",null,I(a.$t("common.noData")),1)]))])]),_:1}))}}),Lt={class:"flex flex-col gap-3 px-4 py-1 overflow-y-auto max-h-full noScrollbar",style:{"-ms-overflow-style":"none","scrollbar-width":"none"}},Tt={class:"flex items-center justify-between w-full my-1"},Dt={class:"flex items-center space-x-2"},jt={class:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-500 flex items-center justify-center overflow-hidden shadow-sm border border-gray-300"},zt=["src"],At={key:1,class:"text-sm font-medium"},Pt={class:"line-clamp-1 overflow-hidden text-ellipsis w-32 block whitespace-nowrap font-medium text-base text-gray-700 dark:text-gray-100"},Gt={class:"min-h-[2rem] text-xs line-clamp-2 text-gray-600 dark:text-gray-400 mb-2"},Et=J({__name:"Plugin",setup(t){const u=ae(),f=_(100),i=s(()=>u.groupList),l=s(()=>u.groupKeyWord),r=[],A=s(()=>{var N;return(N=u.pluginList)!=null&&N.length?u.pluginList:r});O(i,()=>f.value=f.value+1),O(l,()=>f.value=f.value+1);const $=s(()=>u.currentPlugin);i.value.filter(N=>l.value?N.title.includes(l.value)&&N.isSticky:N.isSticky);function b(N){var j;((j=$.value)==null?void 0:j.parameters)===N.parameters?u.setUsingPlugin(null):u.setUsingPlugin(N)}return fe(()=>{u.queryPlugins()}),(N,j)=>(n(),h("div",Lt,[(n(!0),h(Z,null,pe(A.value,y=>(n(),h("div",{key:y.parameters,class:"select-none relative h-26 bg-white shadow flex flex-col items-start gap-3 px-3 py-1 break-all rounded-lg cursor-pointer group font-medium dark:bg-gray-800"},[e("div",Tt,[e("div",Dt,[e("div",jt,[y.pluginImg?(n(),h("img",{key:0,src:y.pluginImg,alt:"App cover",class:"w-full h-full object-cover"},null,8,zt)):(n(),h("span",At,I(y.pluginName.charAt(0)),1))]),e("span",Pt,I(y.pluginName),1)]),C(o(lt),{class:K(["group relative inline-flex h-5 w-10 flex-shrink-0 cursor-pointer items-center justify-center rounded-full focus:outline-none"]),onClick:je(S=>b(y),["prevent"])},{default:T(()=>{var S,G;return[j[0]||(j[0]=e("span",{"aria-hidden":"true",class:"pointer-events-none absolute h-full w-full rounded-full bg-white dark:bg-transparent"},null,-1)),e("span",{"aria-hidden":"true",class:K([((S=$.value)==null?void 0:S.parameters)===y.parameters?"bg-indigo-600":"bg-gray-200 dark:bg-gray-700","pointer-events-none absolute mx-auto h-4 w-9 rounded-full transition-colors duration-200 ease-in-out"])},null,2),e("span",{"aria-hidden":"true",class:K([((G=$.value)==null?void 0:G.parameters)===y.parameters?"translate-x-5":"translate-x-0","pointer-events-none absolute left-0 inline-block h-5 w-5 transform rounded-full border border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-500 shadow ring-0 transition-transform duration-200 ease-in-out"])},null,2)]}),_:2},1032,["onClick"])]),e("div",null,[e("span",Gt,I(y.description),1)])]))),128))]))}}),Ot={class:"flex flex-col h-full flex-1"};const Ut={key:1,class:"flex bg-opacity w-full justify-between items-center px-4 dark:bg-gray-900 h-14"},Kt={class:"w-full py-1 text-lg font-bold flex items-center"},Ht=["src"],Wt={class:"ml-2 flex-1 flex text-base"},Ft={class:"h-7 w-7 flex justify-center items-center hover:bg-[#e9ebec] rounded-[10px]"},qt={class:"flex-1 min-h-0 overflow-hidden"},Rt={class:"p-4 pb-1 pt-1 border-t-gray-100 dark:border-t-gray-800 flex items-center justify-between text-left w-full"};const Zt={type:"button",style:{"border-width":"0px"},class:"inline-flex h-[50px] justify-start bg-[#f4f4f4] relative mb-2 items-center rounded-2xl dark:bg-gray-900 p-3 text-sm hover:bg-opacity dark:hover:bg-gray-800 w-full"},Jt={style:{"border-width":"2px"},class:"p-1 rounded-3xl flex mr-4 items-center justify-center border-[#929292] border"},Qt={class:"flex flex-col items-start"},Xt={class:"text-[#C0C0C0]"},Yt={key:2,class:"w-full flex justify-center items-center pb-3 text-xs text-gray-500"},ea={class:"ml-2 transition-all text-gray-500 hover:text-gray-600 dark:hover:text-gray-400",href:"https://beian.miit.gov.cn",target:"_blank"},va=J({__name:"index",setup(t){var he;const u=Se(),f=we(),i=_e(),l=ae(),r=Ce(),A=_(null),$=_(null),b=_(null),N=s(()=>{var k;return Number((k=r.globalConfig)==null?void 0:k.signInStatus)===1}),j=s(()=>i.theme==="dark"),y=s(()=>r.userBalance),S=s(()=>l.currentPlugin),G=Ee(),U=_(0),E=_(0),g=_(0),c=_(0),d=_(0),z=_(0),{isMobile:m}=Ne(),x=s(()=>r.isLogin),L=s(()=>r.globalConfig.clientLogoPath||Ae);s(()=>r.globalConfig.clientHomePath||"/");const W=((he=r.globalConfig)==null?void 0:he.siteName)||"MeChat",q=s(()=>r.globalConfig.model3Name||M("chat.ordinaryPoints")),ee=s(()=>r.globalConfig.model4Name)||M("chat.advancedPoints"),Q=s(()=>r.globalConfig.drawMjName)||M("chat.drawingPoints"),oe=s(()=>Number(r.globalConfig.pluginFirst)===1);s(()=>Number(r.globalConfig.isHidePlugin)===1);const ge=s(()=>r.userInfo.avatar),F=s(()=>i.siderCollapsed),te=_("chat"),R=s(()=>r.globalConfig),X=s(()=>{var k,p;return((k=R.value)==null?void 0:k.companyName)&&((p=R.value)==null?void 0:p.filingNumber)}),le=s(()=>l.groupList.find(p=>p.uuid===l.active)),a=s(()=>{var k;try{return JSON.parse(((k=le.value)==null?void 0:k.config)||"{}")}catch{return{}}}),v=s(()=>l==null?void 0:l.activeModelDeductType),B=s(()=>{var Y;const k=((Y=S==null?void 0:S.value)==null?void 0:Y.deductType)||a.value.deductType||v.value;let p,V;switch(k){case 1:p=y.value.sumModel3Count||0,V=q.value;break;case 2:p=y.value.sumModel4Count||0,V=ee.value;break;case 3:p=y.value.sumDrawMjCount||0,V=Q.value;break;default:p=0,V=M("chat.points")}return p>99999&&(p="不限",V="次数"),{remainingPoints:p,buttonText:V}});async function me(){await Ve(),f.replace({path:"user-center"})}async function Ve(){return new Promise(k=>{setTimeout(()=>{r.isLogin||f.replace({path:"login"}),k()},100)})}function ta(){const k=j.value?"light":"dark";i.setTheme(k)}async function aa(){G.warning({title:M("chat.clearConversation"),content:M("chat.clearAllNonFavoriteConversations"),positiveText:M("common.confirm"),negativeText:M("common.cancel"),onPositiveClick:async()=>{await l.delAllGroup(),await l.addNewChatGroup()}})}function se(){i.setSiderCollapsed(!F.value)}function oa(){x.value?r.logOut():r.setLoginDialog(!0)}function la(){if(!x.value){r.setLoginDialog(!0);return}u.updateSignInDialog(!0)}function sa(){r.logOut(),f.replace("/")}const Me=s(()=>m.value?{position:"fixed",zIndex:50}:{}),Ie=s(()=>m.value?{paddingBottom:"env(safe-area-inset-bottom)"}:{});return O(m,k=>{i.setSiderCollapsed(k)},{immediate:!0,flush:"post"}),O(()=>r.userBalance.useModel3Token,(k,p)=>{var V;U.value=p||0,E.value=k||0,(V=A.value)==null||V.play()},{immediate:!0,flush:"post"}),O(()=>r.userBalance.useModel4Token,(k,p)=>{var V;g.value=p||0,c.value=k||0,(V=$.value)==null||V.play()},{immediate:!0,flush:"post"}),O(()=>r.userBalance.useDrawMjToken,(k,p)=>{var V;d.value=p||0,z.value=k||0,(V=b.value)==null||V.play()},{immediate:!0,flush:"post"}),fe(()=>{l.queryPlugins(),l.queryMyGroup()}),(k,p)=>(n(),h("div",null,[C(o(Ue),{collapsed:F.value,"collapsed-width":0,width:260,"collapse-mode":"transform",position:"absolute",bordered:"",style:ye(Me.value),onUpdateCollapsed:se},{default:T(()=>{var V,Y;return[e("div",{class:"flex flex-col h-full bg-opacity dark:bg-gray-900 select-none",style:ye(Ie.value)},[e("main",Ot,[(n(),h("div",Ut,[e("button",Kt,[e("img",{src:L.value,alt:"Logo",class:"h-9 w-9"},null,8,Ht),e("span",Wt,I(o(W)),1),e("span",Ft,[C(o(Oe),{placement:"right",trigger:"hover"},{trigger:T(()=>[C(o(de),{class:"text-[#a3a4a5]",onClick:se,size:"23"},{default:T(()=>p[10]||(p[10]=[e("svg",{t:"1735279906826",class:"icon",viewBox:"0 0 1088 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1466",width:"200",height:"200"},[e("path",{d:"M854.592 160c58.24 0 105.408 47.168 105.408 105.408v493.184c0 58.24-47.168 105.408-105.408 105.408H233.408C175.168 864 128 816.832 128 758.592V265.408c0-58.24 47.168-105.408 105.408-105.408h621.184z m-378.368 64H271.04C227.392 224 192 259.392 192 303.04v417.92c0 43.648 35.392 79.04 79.04 79.04h205.184v-576z m340.736 0H535.68v576h281.216c43.648 0 79.04-35.392 79.04-79.04v-417.92c0-43.648-35.392-79.04-79.04-79.04zM423.552 443.456v54.848h-158.08v-54.848h158.08z m0-146.304V352h-158.08v-54.848h158.08z","p-id":"1467"})],-1)])),_:1})]),default:T(()=>[p[11]||(p[11]=ue(" 收起侧栏 "))]),_:1})])])])),e("div",qt,[te.value==="chat"?(n(),D(It,{key:0})):w("",!0),te.value==="plugin"?(n(),D(Et,{key:1})):w("",!0)]),e("div",Rt,[w("",!0),w("",!0),x.value?(n(),h("div",{key:2,onClick:p[9]||(p[9]=P=>o(u).updateGoodsDialog(!0)),class:"flex flex-1 items-center justify-center cursor-pointer"},[e("button",Zt,[e("div",Jt,[C(o(de),{size:"18"},{default:T(()=>p[15]||(p[15]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"icon-sm shrink-0"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12.5001 3.44338C12.1907 3.26474 11.8095 3.26474 11.5001 3.44338L4.83984 7.28868C4.53044 7.46731 4.33984 7.79744 4.33984 8.1547V15.8453C4.33984 16.2026 4.53044 16.5327 4.83984 16.7113L11.5001 20.5566C11.8095 20.7353 12.1907 20.7353 12.5001 20.5566L19.1604 16.7113C19.4698 16.5327 19.6604 16.2026 19.6604 15.8453V8.1547C19.6604 7.79744 19.4698 7.46731 19.1604 7.28868L12.5001 3.44338ZM10.5001 1.71133C11.4283 1.17543 12.5719 1.17543 13.5001 1.71133L20.1604 5.55663C21.0886 6.09252 21.6604 7.0829 21.6604 8.1547V15.8453C21.6604 16.9171 21.0886 17.9075 20.1604 18.4434L13.5001 22.2887C12.5719 22.8246 11.4283 22.8246 10.5001 22.2887L3.83984 18.4434C2.91164 17.9075 2.33984 16.9171 2.33984 15.8453V8.1547C2.33984 7.0829 2.91164 6.09252 3.83984 5.55663L10.5001 1.71133Z",fill:"currentColor"}),e("path",{d:"M9.44133 11.4454L9.92944 9.98105C10.0321 9.67299 10.4679 9.67299 10.5706 9.98105L11.0587 11.4454C11.2941 12.1517 11.8483 12.7059 12.5546 12.9413L14.019 13.4294C14.327 13.5321 14.327 13.9679 14.019 14.0706L12.5546 14.5587C11.8483 14.7941 11.2941 15.3483 11.0587 16.0546L10.5706 17.519C10.4679 17.827 10.0321 17.827 9.92944 17.519L9.44133 16.0546C9.2059 15.3483 8.65167 14.7941 7.94537 14.5587L6.48105 14.0706C6.17298 13.9679 6.17298 13.5321 6.48105 13.4294L7.94537 12.9413C8.65167 12.7059 9.2059 12.1517 9.44133 11.4454Z",fill:"currentColor"}),e("path",{d:"M14.4946 8.05961L14.7996 7.14441C14.8638 6.95187 15.1362 6.95187 15.2004 7.14441L15.5054 8.05961C15.6526 8.50104 15.999 8.84744 16.4404 8.99458L17.3556 9.29965C17.5481 9.36383 17.5481 9.63617 17.3556 9.70035L16.4404 10.0054C15.999 10.1526 15.6526 10.499 15.5054 10.9404L15.2004 11.8556C15.1362 12.0481 14.8638 12.0481 14.7996 11.8556L14.4946 10.9404C14.3474 10.499 14.001 10.1526 13.5596 10.0054L12.6444 9.70035C12.4519 9.63617 12.4519 9.36383 12.6444 9.29965L13.5596 8.99458C14.001 8.84744 14.3474 8.50104 14.4946 8.05961Z",fill:"currentColor"})],-1)])),_:1})]),e("span",Qt,[e("span",{onClick:p[7]||(p[7]=P=>o(u).updateGoodsDialog(!0)),class:"hover:text-[#0057ff]"},"购买套餐"),e("span",Xt,I(o(M)("chat.remaining")+`${B.value.remainingPoints}${B.value.buttonText}`),1)]),w("",!0)])])):w("",!0)]),X.value&&o(m)?(n(),h("div",Yt,[ue(" 版权所有 © "+I((V=R.value)==null?void 0:V.companyName)+" ",1),e("a",ea,I((Y=R.value)==null?void 0:Y.filingNumber),1)])):w("",!0)])],4)]}),_:1},8,["collapsed","style"]),o(m)?xe((n(),h("div",{key:0,class:"fixed inset-0 z-40 bg-black/40",onClick:se},null,512)),[[ze,!F.value]]):w("",!0)]))}});export{va as default};
