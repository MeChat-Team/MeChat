import{k as J,r as g,c,w as Q,i as A,o as K,R as o,S as d,a2 as a,K as l,W as m,V as u,U as y,a6 as h,j as T,a8 as _,a4 as C,z as W,F as X,a7 as Y}from"./vue-3af3b332.js";import{d as Z}from"./appStore-c2d454ab.js";import{d as ee,e as te,j as se,D as ae,F as le}from"./index-0db41f00.js";import{u as oe}from"./useBasicLayout-2b2b4d99.js";import{_ as re}from"./relative.vue_vue_type_script_setup_true_lang-1ec16f42.js";import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang-4f92ac7d.js";import{s as I}from"./naive-ui-5201514a.js";import{S,g as B,M as ne,b as ce}from"./menu-9d7b0f63.js";import{R as de}from"./Right-e4aa9d5c.js";import{C as ue}from"./CheckOne-a3b77e50.js";import"./vueuse-motion-b8c5571c.js";import"./logo-7b70ca99.js";import"./index-3d816091.js";const fe={class:"sticky top-0 left-0 right-0 z-30 dark:border-neutral-800 h-14 select-none"},me={class:"relative flex items-center justify-center min-w-0 h-full"},ve={class:"flex w-full h-full items-center px-4"},pe={key:0,class:"flex items-center pr-2"},ye={key:0,class:"flex items-center justify-center"},he={class:"flex justify-between items-center h-full w-full"},xe={class:"py-1"},ge={class:"flex items-center"},_e={class:"py-1"},we=["onClick"],ke={class:"w-7 h-7 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden select-none"},be=["src"],Ce={key:1,class:"text-sm font-medium select-none"},Me={class:"flex flex-col flex-1 select-none"},ze={href:"#",class:"text-sm select-none"},Ne={key:0,class:"text-xs text-gray-400 line-clamp-1 max-w-60 mr-2 select-none"},je={class:"ml-auto"},Ae={key:1,class:"w-4 h-4"},Te={class:"flex items-center h-full font-semibold"},Je=J({__name:"index",emits:["export","toggleUsingContext","clear","scrollBtn"],setup(Ie,{emit:Se}){const M=ee(),f=te(),z=g([]),N=g(null);c(()=>f.groupList);const k=c(()=>M.siderCollapsed),V=c(()=>f.active),x=c(()=>f.currentPlugin),{isMobile:v}=oe(),b=g(!1),n=c(()=>f.getChatByGroupInfo());c(()=>f.chatList);const p=c(()=>{var e;const t=(e=n.value)==null?void 0:e.config;if(!t)return{};try{return JSON.parse(t)}catch{return{}}}),F=c(()=>{var t,e;return String(((e=(t=p==null?void 0:p.value)==null?void 0:t.modelInfo)==null?void 0:e.model)??"")}),D=c(()=>{var t;return((t=n==null?void 0:n.value)==null?void 0:t.appId)||0});let H=g({}),L=g([]);Q(D,t=>{t?U(t):N.value=null},{immediate:!0});async function U(t){const e=await Z({id:t});N.value=e.data}const P=c(()=>{var t,e,s,r;return((t=n==null?void 0:n.value)==null?void 0:t.appId)&&(((e=p.value.modelInfo)==null?void 0:e.isFixedModel)===1||((s=p.value.modelInfo)==null?void 0:s.isGPTs)===1)||x.value&&((r=x==null?void 0:x.value)==null?void 0:r.deductType)!==0});A("createNewChatGroup",()=>Promise.resolve());function $(){M.setSiderCollapsed(!k.value)}function Be(){se.push("/ModelMenu")}async function O(t){var j;const{modelInfo:e,fileInfo:s}=f.activeConfig,{isGPTs:r,isFixedModel:w,modelName:i}=e,R={modelInfo:{keyType:t.keyType,modelName:((j=n==null?void 0:n.value)!=null&&j.appId?i:t.label)||"",model:t.value,deductType:t.deductType,deduct:t.deduct,isFileUpload:t.isFileUpload,modelAvatar:t.modelAvatar||"",isGPTs:r,isFixedModel:w},fileInfo:s||{}},E={groupId:V.value,config:JSON.stringify(R)};await ae(E),await f.queryMyGroup()}async function G(){try{const t=await le();if(!t.success)return;const{modelMaps:e,modelTypeList:s}=t.data;H.value=e,L.value=s;const w=Object.values(e).flat().filter(i=>i.keyType===1);z.value=w.map(i=>({label:i.modelName,value:i.model,deductType:i.deductType,keyType:i.keyType,deduct:i.deduct,isFileUpload:i.isFileUpload,modelAvatar:i.modelAvatar,modelDescription:i.modelDescription}))}catch{}}const q=A("createNewChatGroup",()=>Promise.resolve());return K(()=>{G()}),(t,e)=>(o(),d("header",fe,[a("div",me,[a("div",ve,[k.value?(o(),d("div",pe,[a("button",{class:"flex items-center justify-center w-5 h-full dark:text-gray-400 text-gray-500",onClick:$},[l(v)?(o(),y(l(I),{key:1,class:"text-[#262626]",size:"24"},{default:u(()=>e[5]||(e[5]=[a("svg",{t:"1735279906826",class:"icon",viewBox:"0 0 1088 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1466",width:"200",height:"200"},[a("path",{d:"M854.592 160c58.24 0 105.408 47.168 105.408 105.408v493.184c0 58.24-47.168 105.408-105.408 105.408H233.408C175.168 864 128 816.832 128 758.592V265.408c0-58.24 47.168-105.408 105.408-105.408h621.184z m-378.368 64H271.04C227.392 224 192 259.392 192 303.04v417.92c0 43.648 35.392 79.04 79.04 79.04h205.184v-576z m340.736 0H535.68v576h281.216c43.648 0 79.04-35.392 79.04-79.04v-417.92c0-43.648-35.392-79.04-79.04-79.04zM423.552 443.456v54.848h-158.08v-54.848h158.08z m0-146.304V352h-158.08v-54.848h158.08z","p-id":"1467"})],-1)])),_:1})):(o(),d("div",ye,[m(l(I),{class:"text-[#262626]",size:"23"},{default:u(()=>e[4]||(e[4]=[a("svg",{t:"1735279906826",class:"icon",viewBox:"0 0 1088 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1466",width:"200",height:"200"},[a("path",{d:"M854.592 160c58.24 0 105.408 47.168 105.408 105.408v493.184c0 58.24-47.168 105.408-105.408 105.408H233.408C175.168 864 128 816.832 128 758.592V265.408c0-58.24 47.168-105.408 105.408-105.408h621.184z m-378.368 64H271.04C227.392 224 192 259.392 192 303.04v417.92c0 43.648 35.392 79.04 79.04 79.04h205.184v-576z m340.736 0H535.68v576h281.216c43.648 0 79.04-35.392 79.04-79.04v-417.92c0-43.648-35.392-79.04-79.04-79.04zM423.552 443.456v54.848h-158.08v-54.848h158.08z m0-146.304V352h-158.08v-54.848h158.08z","p-id":"1467"})],-1)])),_:1})]))])])):h("",!0),a("div",he,[P.value?(o(),y(l(B),{key:0,as:"div",class:"relative flex-1 flex ele-drag items-center justify-between h-full"},{default:u(()=>[a("div",null,[a("div",xe,[m(l(S),{class:"inline-flex w-full justify-center gap-x-1.5 rounded-md px-3 py-2 text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-800 dark:text-gray-400 text-gray-700"},{default:u(()=>{var s,r;return[T(_(((s=x.value)==null?void 0:s.pluginName)||((r=n.value)==null?void 0:r.title)||"新对话"),1)]}),_:1})])])]),_:1})):(o(),y(l(B),{key:1,as:"div",class:"relative flex-1 flex ele-drag items-center h-full justify-between"},{default:u(()=>[a("div",null,[a("div",{class:C([[l(v)?"w-56":"w-60"],"py-1 flex items-center"])},[m(l(S),{class:C([[l(v)?"text-xs px-1 py-2":"text-sm px-3 py-2"],"inline-flex justify-center gap-x-1.5 rounded-md font-semibold hover:bg-gray-50 dark:hover:bg-gray-750 dark:text-gray-400 text-gray-500"]),onMouseover:e[0]||(e[0]=s=>b.value=!0),onMouseleave:e[1]||(e[1]=s=>b.value=!1)},{default:u(()=>{var s,r;return[T(_(((r=(s=p.value)==null?void 0:s.modelInfo)==null?void 0:r.modelName)||"新对话")+" ",1),b.value||l(v)?(o(),y(l(de),{key:0,size:"20",class:C(["justify-center items-center",{"text-base font-bold":l(v),"text-sm":!l(v)}])},null,8,["class"])):h("",!0)]}),_:1},8,["class"]),k.value?(o(),d("div",{key:0,onClick:e[2]||(e[2]=s=>l(q)()),class:"ml-1 h-8 w-20 border border-[#c2d6f8] hover:border-[#bad2f8] hover:text-[#ffffff] text-xs text-[#0057ff] py-1.5 pl-2 pr-2.5 hover:bg-[#5a91fc] flex justify-between rounded-2xl"},[a("div",ge,[m(l(ie),{icon:"icon-park-outline:plus",class:"w-4 h-4 mr-1"}),e[6]||(e[6]=a("span",{class:""}," 新对话 ",-1))]),e[7]||(e[7]=a("div",{class:"flex items-center"},null,-1))])):h("",!0)],2)]),m(W,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:u(()=>[m(l(ne),{class:"absolute top-full z-10 origin-top-left divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 dark:bg-gray-750 dark:text-gray-400 text-gray-900 overflow-y-auto",style:{maxHeight:"60vh"}},{default:u(()=>[a("div",_e,[(o(!0),d(X,null,Y(z.value,(s,r)=>(o(),y(l(ce),{key:r},{default:u(()=>[a("div",{class:"flex items-center space-x-4 mx-2 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-md select-none",onClick:w=>O(s)},[a("div",ke,[s.modelAvatar?(o(),d("img",{key:0,src:s.modelAvatar,alt:"app cover",class:"w-full h-full object-cover"},null,8,be)):(o(),d("span",Ce,_(s.label.charAt(0)),1))]),a("div",Me,[a("a",ze,_(s.label),1),s.modelDescription?(o(),d("div",Ne,_(s.modelDescription),1)):h("",!0)]),a("div",je,[F.value===s.value?(o(),y(l(ue),{key:0,theme:"filled",size:"16",class:"dark:text-gray-500"})):(o(),d("div",Ae))])],8,we)]),_:2},1024))),128)),h("",!0)])]),_:1})]),_:1})]),_:1})),a("div",Te,[m(re)]),h("",!0)])])])]))}});export{Je as default};
