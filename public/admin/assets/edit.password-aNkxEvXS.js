
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{d as h,r as i,a as q,T as z,g as v,c as x,U as B,V as M,i as n,l as R,P as $,f as L,N,p as a,b as o,w as t,h as g,L as A,G as F,k as b}from"./index-TOhlAu5k.js";import{_ as G}from"./index.vue_vue_type_script_setup_true_lang-Ddax1S58.js";import{_ as I}from"./index.vue_vue_type_script_setup_true_lang-FDL5yZdU.js";import{u as j}from"./useMainPage-BBnl-433.js";const D=h({name:"FixedActionBar",__name:"index",setup(y){const c=i(!1);q(()=>{d(),window.addEventListener("scroll",d)}),z(()=>{window.removeEventListener("scroll",d)});function d(){const u=document.documentElement.scrollTop||document.body.scrollTop,r=document.documentElement.clientHeight||document.body.clientHeight,s=document.documentElement.scrollHeight||document.body.scrollHeight;c.value=Math.ceil(u+r)>=s}return(u,r)=>(v(),x("div",{class:M(["fixed-action-bar bottom-0 z-4 bg-[var(--g-container-bg)] p-5 text-center transition",{shadow:!n(c)}]),"data-fixed-calc-width":""},[B(u.$slots,"default",{},void 0,!0)],2))}}),J=R(D,[["__scopeId","data-v-9af45002"]]),K=h({__name:"edit.password",setup(y){const c=$(),d=L(),u=N(),r=i(),s=i({password:"",newpassword:"",checkpassword:""}),V=j(),k=i({password:[{required:!0,message:"请输入原密码",trigger:"blur"}],newpassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:18,trigger:"blur",message:"密码长度为6到18位"}],checkpassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{validator:(m,e,l)=>{e!==s.value.newpassword?l(new Error("两次密码不一致！")):l()}}]});function E(){r.value&&r.value.validate(m=>{if(m){const{password:e,newpassword:l}=s.value;A.passwordEdit({oldPassword:e,password:l}).then(()=>{F({type:"success",message:"修改密码成功，请重新登录"}),u.logout().then(()=>{d.push({name:"login",query:{redirect:c.fullPath}})})})}})}function U(){V.reload()}return(m,e)=>{const l=I,_=a("el-input"),w=a("el-form-item"),C=a("el-form"),H=a("el-col"),P=a("el-row"),S=G,f=a("el-button"),T=J;return v(),x("div",null,[o(l,{title:"修改密码",content:"定期修改密码可以提高帐号安全性噢~"}),o(S,null,{default:t(()=>[o(P,null,{default:t(()=>[o(H,{md:24,lg:12},{default:t(()=>[o(C,{ref_key:"formRef",ref:r,model:n(s),rules:n(k),"label-width":"120px"},{default:t(()=>[o(w,{label:"原密码",prop:"password"},{default:t(()=>[o(_,{modelValue:n(s).password,"onUpdate:modelValue":e[0]||(e[0]=p=>n(s).password=p),type:"password",placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1}),o(w,{label:"新密码",prop:"newpassword"},{default:t(()=>[o(_,{modelValue:n(s).newpassword,"onUpdate:modelValue":e[1]||(e[1]=p=>n(s).newpassword=p),type:"password",placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1}),o(w,{label:"确认新密码",prop:"checkpassword"},{default:t(()=>[o(_,{modelValue:n(s).checkpassword,"onUpdate:modelValue":e[2]||(e[2]=p=>n(s).checkpassword=p),type:"password",placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1}),o(T,null,{default:t(()=>[o(f,{type:"primary",size:"large",onClick:E},{default:t(()=>e[3]||(e[3]=[g(" 提交 ")])),_:1}),o(f,{type:"default",size:"large",onClick:U},{default:t(()=>e[4]||(e[4]=[g(" 取消 ")])),_:1})]),_:1})])}}});typeof b=="function"&&b(K);export{K as default};
