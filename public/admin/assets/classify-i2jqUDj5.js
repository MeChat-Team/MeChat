
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{_ as ae}from"./index.vue_vue_type_script_setup_true_lang-Ddax1S58.js";import{_ as oe}from"./index.vue_vue_type_script_setup_true_lang-FDL5yZdU.js";import{d as ne,r as p,m as D,n as q,a as se,p as n,q as re,g as w,c as B,b as t,w as a,e as k,h as i,v as ue,x as ie,F as de,s as pe,i as s,y as me,z as M,t as I,D as fe,E as ce,G as S,j as _e,_ as ge,k as N}from"./index-TOhlAu5k.js";import{A as C}from"./app-D0kRaQvA.js";import{u as ve}from"./utcformatTime-Bq4gDWNx.js";import{E as be,Q as ye}from"./index-BE-LteFu.js";const we={class:"mr-5 flex justify-end"},ke=ne({__name:"classify",setup(Ce){const U=p(),$=p(0),m=p(!1),y=p(!1);p("/api/upload/file");const r=D({name:"",status:"",page:1,size:10}),V=p(),f=p(0),u=D({name:"",des:"",coverImg:"",order:100,status:0}),R=D({name:[{required:!0,message:"请填写分类名称",trigger:"blur"}],des:[{required:!1,message:"请填写分类描述",trigger:"blur"}],coverImg:[{required:!1,message:"请填写分类封面图片地址",trigger:"blur"}],order:[{required:!1,message:"请填写排序ID",trigger:"blur"}],status:[{required:!0,message:"请选择分类状态",trigger:"change"}]}),T=p([]),j=q(()=>f.value?"更新分类":"新增分类"),F=q(()=>f.value?"确认更新":"确认新增");async function d(){try{y.value=!0;const o=await C.queryCats(r),{rows:e,count:v}=o.data;y.value=!1,$.value=v,T.value=e}catch{y.value=!1}}function O(o){f.value=o.id;const{name:e,status:v,des:x,order:z,coverImg:b}=o;ce(()=>{Object.assign(u,{name:e,status:v,des:x,order:z,coverImg:b})}),m.value=!0}function Y(o){f.value=0,o==null||o.resetFields()}async function K(o){await C.deleteCats({id:o.id}),S.success("删除分类成功"),d()}function L(o){o==null||o.resetFields(),d()}function H(o){o==null||o.validate(async e=>{e&&(f.value?(await C.updateCats({id:f.value,...u}),S({type:"success",message:"更新分类成功！"})):(await C.createCats(u),S({type:"success",message:"创建新的分类成功！"})),m.value=!1,d())})}return se(()=>{d()}),(o,e)=>{const v=_e,x=ge,z=oe,b=n("el-input"),c=n("el-form-item"),Q=n("el-option"),G=n("el-select"),_=n("el-button"),A=n("el-form"),P=ae,g=n("el-table-column"),J=n("el-tag"),W=n("el-popconfirm"),X=n("el-table"),Z=n("el-pagination"),E=n("el-row"),h=n("el-switch"),ee=n("el-dialog"),te=re("loading");return w(),B("div",null,[t(z,null,{title:a(()=>e[13]||(e[13]=[k("div",{class:"flex items-center gap-4"},"应用分类配置",-1)])),content:a(()=>e[14]||(e[14]=[k("div",{class:"text-sm/6"},[k("div",null,"应用分类可能会被多个用户收藏，一旦创建，不建议删除。")],-1)])),default:a(()=>[t(x,{outline:"",onClick:e[0]||(e[0]=l=>m.value=!0)},{default:a(()=>[t(v,{name:"ic:baseline-plus"}),e[15]||(e[15]=i(" 新增分类 "))]),_:1})]),_:1}),t(P,null,{default:a(()=>[t(A,{ref_key:"formRef",ref:U,inline:!0,model:r},{default:a(()=>[t(c,{label:"分类名称",prop:"name"},{default:a(()=>[t(b,{modelValue:r.name,"onUpdate:modelValue":e[1]||(e[1]=l=>r.name=l),placeholder:"分类名称[模糊搜索]",onKeydown:ue(ie(d,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])]),_:1}),t(c,{label:"分类状态",prop:"status"},{default:a(()=>[t(G,{modelValue:r.status,"onUpdate:modelValue":e[2]||(e[2]=l=>r.status=l),placeholder:"请选择分类状态",clearable:"",style:{width:"160px"}},{default:a(()=>[(w(!0),B(de,null,pe(s(be),l=>(w(),M(Q,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,null,{default:a(()=>[t(_,{type:"primary",onClick:d},{default:a(()=>e[16]||(e[16]=[i(" 查询 ")])),_:1}),t(_,{onClick:e[3]||(e[3]=l=>L(s(U)))},{default:a(()=>e[17]||(e[17]=[i(" 重置 ")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(P,{style:{width:"100%"}},{default:a(()=>[me((w(),M(X,{border:"",data:s(T),style:{width:"100%"},size:"large"},{default:a(()=>[t(g,{prop:"name",label:"分类名称"}),t(g,{prop:"appCount",label:"应用数量"}),t(g,{prop:"order",label:"排序ID"}),t(g,{prop:"status",label:"分类状态"},{default:a(l=>[t(J,{type:l.row.status===1?"success":"danger"},{default:a(()=>[i(I(s(ye)[l.row.status]),1)]),_:2},1032,["type"])]),_:1}),t(g,{prop:"createdAt",label:"创建时间",width:"200"},{default:a(l=>[i(I(s(ve)(l.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),t(g,{label:"操作",width:"200"},{default:a(l=>[t(_,{link:"",type:"primary",size:"small",onClick:le=>O(l.row)},{default:a(()=>e[18]||(e[18]=[i(" 编辑 ")])),_:2},1032,["onClick"]),t(W,{title:"确认删除此分类么?",width:"200","icon-color":"red",onConfirm:le=>K(l.row)},{reference:a(()=>[t(_,{link:"",type:"danger",size:"small"},{default:a(()=>e[19]||(e[19]=[i(" 删除分类 ")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[te,s(y)]]),t(E,{class:"mt-5 flex justify-end"},{default:a(()=>[t(Z,{"current-page":r.page,"onUpdate:currentPage":e[4]||(e[4]=l=>r.page=l),"page-size":r.size,"onUpdate:pageSize":e[5]||(e[5]=l=>r.size=l),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:s($),onSizeChange:d,onCurrentChange:d},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),t(ee,{modelValue:s(m),"onUpdate:modelValue":e[11]||(e[11]=l=>fe(m)?m.value=l:null),"close-on-click-modal":!1,title:s(j),width:"570",onClose:e[12]||(e[12]=l=>Y(s(V)))},{footer:a(()=>[k("span",we,[t(_,{onClick:e[9]||(e[9]=l=>m.value=!1)},{default:a(()=>e[20]||(e[20]=[i("取消")])),_:1}),t(_,{type:"primary",onClick:e[10]||(e[10]=l=>H(s(V)))},{default:a(()=>[i(I(s(F)),1)]),_:1})])]),default:a(()=>[t(A,{ref_key:"formPackageRef",ref:V,"label-position":"right","label-width":"100px",model:u,rules:R},{default:a(()=>[t(c,{label:"分类名称",prop:"name"},{default:a(()=>[t(b,{modelValue:u.name,"onUpdate:modelValue":e[6]||(e[6]=l=>u.name=l),placeholder:"请填写分类名称"},null,8,["modelValue"])]),_:1}),t(c,{label:"分类状态",prop:"status"},{default:a(()=>[t(h,{modelValue:u.status,"onUpdate:modelValue":e[7]||(e[7]=l=>u.status=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),t(c,{label:"排序ID",prop:"order"},{default:a(()=>[t(b,{modelValue:u.order,"onUpdate:modelValue":e[8]||(e[8]=l=>u.order=l),modelModifiers:{number:!0},placeholder:"请填写排序ID[数字越大越靠前]"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});typeof N=="function"&&N(ke);export{ke as default};
