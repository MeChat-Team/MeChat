
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-FDL5yZdU.js";import{d as Q,m as X,r as F,a as Y,p,g as s,c as h,b as e,w as a,e as V,h as Z,z as _,i as g,B as P,C as U,A as k,G as I,j as ee,_ as ae,H as R,k as S}from"./index-TOhlAu5k.js";import{a as B}from"./config-CFeX2CT3.js";const te=["src"],le=["src"],oe=["src"],ne=["src"],se=Q({__name:"baseConfiguration",setup(re){const t=X({siteName:"",robotAvatar:"",userDefautlAvatar:"",filingNumber:"",companyName:"",buyCramiAddress:"",siteUrl:"",isShowAppCatIcon:"",clientFavoIconPath:"",clientLogoPath:""}),G=F({siteName:[{required:!0,trigger:"blur",message:"请填写网站名称"}]}),N=F(),y=F(`/api/upload/file?dir=${encodeURIComponent("system/others")}`);async function L(){const o=await B.queryConfig({keys:["siteName","robotAvatar","userDefautlAvatar","filingNumber","companyName","isShowAppCatIcon","clientLogoPath","clientFavoIconPath","siteUrl"]});Object.assign(t,o.data)}function T(){var o;(o=N.value)==null||o.validate(async l=>{if(l){try{await B.setConfig({settings:K(t)}),I.success("变更配置信息成功")}catch{}L()}else I.error("请填写完整信息")})}async function b(o){const l=await R.get(o,{responseType:"blob"});let r="downloaded_file";const i=l.headers["content-disposition"];if(i){const v=/filename="([^"]+)"/.exec(i);v!=null&&v[1]&&(r=v[1])}else r=$(o);return new File([l.data],r,{type:l.data.type})}function $(o){const r=new URL(o).pathname;return r.substring(r.lastIndexOf("/")+1)}function x(o,l){const r=new FormData;r.append("file",o),R.post(y.value,r,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{l(i.data)}).catch(i=>{console.error("上传失败",i)})}const C=(o,l)=>{console.log("response: ",o.data),t.clientLogoPath=o.data};async function q(){if(t.clientLogoPath){const o=await b(t.clientLogoPath);x(o,C)}}async function E(){if(t.clientFavoIconPath){const o=await b(t.clientFavoIconPath);x(o,D)}}async function H(){if(t.robotAvatar){const o=await b(t.robotAvatar);x(o,j)}}async function z(){if(t.userDefautlAvatar){const o=await b(t.userDefautlAvatar);x(o,O)}}const D=(o,l)=>{console.log("response: ",o.data),t.clientFavoIconPath=o.data},j=(o,l)=>{console.log("response: ",o.data),t.robotAvatar=o.data},O=(o,l)=>{console.log("response: ",o.data),t.userDefautlAvatar=o.data},w=o=>{if(["image/png","image/jpeg","image/gif","image/webp"].includes(o.type)){if(o.size/1024>300)return I.error("当前限制文件最大不超过 300KB!"),!1}else return I.error("当前系统仅支持 PNG、JPEG、GIF、和 WebP 格式的图片!"),!1};function K(o){return Object.keys(o).map(l=>({configKey:l,configVal:o[l]}))}return Y(()=>{L()}),(o,l)=>{const r=ee,i=ae,v=W,u=p("el-input"),c=p("el-form-item"),d=p("el-col"),f=p("el-row"),m=p("el-icon"),A=p("el-upload"),M=p("el-form"),J=p("el-card");return s(),h("div",null,[e(v,null,{title:a(()=>l[8]||(l[8]=[V("div",{class:"flex items-center gap-4"},"网站基础配置",-1)])),content:a(()=>l[9]||(l[9]=[V("div",{class:"text-sm/6"},[V("div",null," 网站基础配置支持即时更新网站的主要视觉与功能元素。配置内容包括网站名称、备案号、版权信息、LOGO与ICO、默认AI头像与用户头像，以及首页设置等。 "),V("div",null,"请认真填写各项配置，确保提供给用户的信息准确无误。")],-1)])),default:a(()=>[e(i,{outline:"",onClick:T},{default:a(()=>[e(r,{name:"i-ri:file-text-line"}),l[10]||(l[10]=Z(" 保存设置 "))]),_:1})]),_:1}),e(J,{style:{margin:"20px"}},{default:a(()=>[e(M,{ref_key:"formRef",ref:N,rules:G.value,model:t,"label-width":"150px"},{default:a(()=>[e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(c,{label:"网站名称",prop:"siteName"},{default:a(()=>[e(u,{modelValue:t.siteName,"onUpdate:modelValue":l[0]||(l[0]=n=>t.siteName=n),placeholder:"网站名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(c,{label:"网站地址",prop:"siteUrl"},{default:a(()=>[e(u,{modelValue:t.siteUrl,"onUpdate:modelValue":l[1]||(l[1]=n=>t.siteUrl=n),placeholder:"网站地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(c,{label:"公司/组织名称",prop:"companyName"},{default:a(()=>[e(u,{modelValue:t.companyName,"onUpdate:modelValue":l[2]||(l[2]=n=>t.companyName=n),placeholder:"填入具体的公司或组织名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(c,{label:"网站备案号",prop:"filingNumber"},{default:a(()=>[e(u,{modelValue:t.filingNumber,"onUpdate:modelValue":l[3]||(l[3]=n=>t.filingNumber=n),placeholder:"填写网站备案信息的备案号",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(c,{label:"用户端LOGO",prop:"clientLogoPath"},{default:a(()=>[e(u,{modelValue:t.clientLogoPath,"onUpdate:modelValue":l[4]||(l[4]=n=>t.clientLogoPath=n),placeholder:"请填写或上传网站 LOGO 图片 URL",clearable:""},{append:a(()=>[e(A,{class:"avatar-uploader",action:y.value,"show-file-list":!1,"on-success":C,"before-upload":w,style:{display:"flex","align-items":"center","justify-content":"center"}},{default:a(()=>[t.clientLogoPath?(s(),h("img",{key:0,src:t.clientLogoPath,style:{"max-width":"1.5rem","max-height":"1.5rem",margin:"5px 0","object-fit":"contain"}},null,8,te)):(s(),_(m,{key:1,style:{width:"1rem"}},{default:a(()=>[e(g(P))]),_:1}))]),_:1},8,["action"]),t.clientLogoPath?(s(),_(m,{key:0,onClick:q,style:{"margin-left":"35px",width:"1rem"}},{default:a(()=>[e(g(U))]),_:1})):k("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(c,{label:"网站 ico",prop:"clientFavoIconPath"},{default:a(()=>[e(u,{modelValue:t.clientFavoIconPath,"onUpdate:modelValue":l[5]||(l[5]=n=>t.clientFavoIconPath=n),placeholder:"请填写或上传网站 ico URL",clearable:""},{append:a(()=>[e(A,{class:"avatar-uploader",action:y.value,"show-file-list":!1,"on-success":D,"before-upload":w,style:{display:"flex","align-items":"center","justify-content":"center"}},{default:a(()=>[t.clientFavoIconPath?(s(),h("img",{key:0,src:t.clientFavoIconPath,style:{"max-width":"1.5rem","max-height":"1.5rem",margin:"5px 0","object-fit":"contain"}},null,8,le)):(s(),_(m,{key:1,style:{width:"1rem"}},{default:a(()=>[e(g(P))]),_:1}))]),_:1},8,["action"]),t.clientFavoIconPath?(s(),_(m,{key:0,onClick:E,style:{"margin-left":"35px",width:"1rem"}},{default:a(()=>[e(g(U))]),_:1})):k("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(c,{label:"AI头像",prop:"robotAvatar"},{default:a(()=>[e(u,{modelValue:t.robotAvatar,"onUpdate:modelValue":l[6]||(l[6]=n=>t.robotAvatar=n),placeholder:"请填写或上传网站 AI 头像 URL、为空将根据模型自动显示",clearable:""},{append:a(()=>[e(A,{class:"avatar-uploader",action:y.value,"show-file-list":!1,"on-success":j,"before-upload":w,style:{display:"flex","align-items":"center","justify-content":"center"}},{default:a(()=>[t.robotAvatar?(s(),h("img",{key:0,src:t.robotAvatar,style:{"max-width":"1.5rem","max-height":"1.5rem",margin:"5px 0","object-fit":"contain"}},null,8,oe)):(s(),_(m,{key:1,style:{width:"1rem"}},{default:a(()=>[e(g(P))]),_:1}))]),_:1},8,["action"]),t.robotAvatar?(s(),_(m,{key:0,onClick:H,style:{"margin-left":"35px",width:"1rem"}},{default:a(()=>[e(g(U))]),_:1})):k("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:a(()=>[e(d,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(c,{label:"用户默认头像",prop:"userDefautlAvatar"},{default:a(()=>[e(u,{modelValue:t.userDefautlAvatar,"onUpdate:modelValue":l[7]||(l[7]=n=>t.userDefautlAvatar=n),placeholder:"请填写或上传网站新用户默认的头像 URL",clearable:""},{append:a(()=>[e(A,{class:"avatar-uploader",action:y.value,"show-file-list":!1,"on-success":O,"before-upload":w,style:{display:"flex","align-items":"center","justify-content":"center"}},{default:a(()=>[t.userDefautlAvatar?(s(),h("img",{key:0,src:t.userDefautlAvatar,style:{"max-width":"1.5rem","max-height":"1.5rem",margin:"5px 0","object-fit":"contain"}},null,8,ne)):(s(),_(m,{key:1,style:{width:"1rem"}},{default:a(()=>[e(g(P))]),_:1}))]),_:1},8,["action"]),t.userDefautlAvatar?(s(),_(m,{key:0,onClick:z,style:{"margin-left":"35px",width:"1rem"}},{default:a(()=>[e(g(U))]),_:1})):k("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1})])}}});typeof S=="function"&&S(se);export{se as default};
